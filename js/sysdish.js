// koffee 1.3.0

/*
 0000000  000   000   0000000  0000000    000   0000000  000   000  
000        000 000   000       000   000  000  000       000   000  
0000000     00000    0000000   000   000  000  0000000   000000000  
     000     000          000  000   000  000       000  000   000  
0000000      000     0000000   0000000    000  0000000   000   000
 */
var Kachel, Sysdish, _, elem, post, ref, utils,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

ref = require('kxk'), post = ref.post, elem = ref.elem, _ = ref._;

utils = require('./utils');

Kachel = require('./kachel');

Sysdish = (function(superClass) {
    extend(Sysdish, superClass);

    function Sysdish(arg) {
        var ref1;
        this.kachelId = (ref1 = arg.kachelId) != null ? ref1 : 'sysdish';
        this.onData = bind(this.onData, this);
        this.rx_max = 0;
        this.tx_max = 0;
        this.r_max = 0;
        this.w_max = 0;
        arguments[0] = _.defaults({kachelId:this.kachelId}, arguments[0]); Sysdish.__super__.constructor.apply(this, arguments);
        post.toMain('requestData', 'sysdata', this.id);
        post.on('data', this.onData);
    }

    Sysdish.prototype.onData = function(data) {
        var pie, r_sec, rx_sec, svg, tx_sec, w_sec;
        this.main.innerHTML = '';
        svg = utils.svg({
            clss: 'clock'
        });
        this.main.appendChild(svg);
        if (data.disksIO != null) {
            r_sec = data.disksIO.rIO_sec;
            w_sec = data.disksIO.wIO_sec;
            this.r_max = Math.max(this.r_max, r_sec);
            this.w_max = Math.max(this.w_max, w_sec);
            pie = utils.circle({
                clss: 'sysinfo_disk_bgr',
                svg: svg
            });
            utils.pie({
                svg: pie,
                clss: 'sysinfo_disk_read',
                angle: 180 * r_sec / this.r_max
            });
            utils.pie({
                svg: pie,
                clss: 'sysinfo_disk_write',
                angle: 180 * w_sec / this.w_max,
                start: 180
            });
        }
        rx_sec = data.networkStats[0].rx_sec;
        tx_sec = data.networkStats[0].tx_sec;
        this.rx_max = Math.max(this.rx_max, rx_sec);
        this.tx_max = Math.max(this.tx_max, tx_sec);
        pie = utils.circle({
            radius: 47,
            clss: 'sysinfo_net_bgr',
            svg: svg
        });
        utils.pie({
            svg: pie,
            radius: 47,
            clss: 'sysinfo_net_recv',
            angle: 180 * rx_sec / this.rx_max
        });
        utils.pie({
            svg: pie,
            radius: 47,
            clss: 'sysinfo_net_send',
            angle: 180 * tx_sec / this.tx_max,
            start: 180
        });
        pie = utils.circle({
            radius: 44,
            clss: 'sysinfo_load_bgr',
            svg: svg
        });
        utils.pie({
            svg: pie,
            radius: 44,
            clss: 'sysinfo_load_sys',
            angle: 360 * data.currentLoad.currentload / 100
        });
        utils.pie({
            svg: pie,
            radius: 44,
            clss: 'sysinfo_load_usr',
            angle: 360 * data.currentLoad.currentload_user / 100
        });
        pie = utils.circle({
            radius: 18,
            clss: 'sysinfo_mem_bgr',
            svg: svg
        });
        utils.pie({
            svg: pie,
            radius: 18,
            clss: 'sysinfo_mem_used',
            angle: 360 * data.mem.used / data.mem.total
        });
        return utils.pie({
            svg: pie,
            radius: 18,
            clss: 'sysinfo_mem_active',
            angle: 360 * data.mem.active / data.mem.total
        });
    };

    return Sysdish;

})(Kachel);

module.exports = Sysdish;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzZGlzaC5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsMENBQUE7SUFBQTs7OztBQVFBLE1BQW9CLE9BQUEsQ0FBUSxLQUFSLENBQXBCLEVBQUUsZUFBRixFQUFRLGVBQVIsRUFBYzs7QUFFZCxLQUFBLEdBQVUsT0FBQSxDQUFRLFNBQVI7O0FBQ1YsTUFBQSxHQUFVLE9BQUEsQ0FBUSxVQUFSOztBQUVKOzs7SUFFQyxpQkFBQyxHQUFEO0FBRUMsWUFBQTtRQUZBLElBQUMsQ0FBQSxrREFBUzs7UUFFVixJQUFDLENBQUEsTUFBRCxHQUFVO1FBQ1YsSUFBQyxDQUFBLE1BQUQsR0FBVTtRQUVWLElBQUMsQ0FBQSxLQUFELEdBQVM7UUFDVCxJQUFDLENBQUEsS0FBRCxHQUFTO1FBRVQsNkdBQUEsU0FBQTtRQUVBLElBQUksQ0FBQyxNQUFMLENBQVksYUFBWixFQUEwQixTQUExQixFQUFvQyxJQUFDLENBQUEsRUFBckM7UUFDQSxJQUFJLENBQUMsRUFBTCxDQUFRLE1BQVIsRUFBZSxJQUFDLENBQUEsTUFBaEI7SUFYRDs7c0JBYUgsTUFBQSxHQUFRLFNBQUMsSUFBRDtBQUVKLFlBQUE7UUFBQSxJQUFDLENBQUEsSUFBSSxDQUFDLFNBQU4sR0FBa0I7UUFDbEIsR0FBQSxHQUFNLEtBQUssQ0FBQyxHQUFOLENBQVU7WUFBQSxJQUFBLEVBQUssT0FBTDtTQUFWO1FBQ04sSUFBQyxDQUFBLElBQUksQ0FBQyxXQUFOLENBQWtCLEdBQWxCO1FBUUEsSUFBRyxvQkFBSDtZQUVJLEtBQUEsR0FBUSxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ3JCLEtBQUEsR0FBUSxJQUFJLENBQUMsT0FBTyxDQUFDO1lBRXJCLElBQUMsQ0FBQSxLQUFELEdBQVMsSUFBSSxDQUFDLEdBQUwsQ0FBUyxJQUFDLENBQUEsS0FBVixFQUFpQixLQUFqQjtZQUNULElBQUMsQ0FBQSxLQUFELEdBQVMsSUFBSSxDQUFDLEdBQUwsQ0FBUyxJQUFDLENBQUEsS0FBVixFQUFpQixLQUFqQjtZQUVULEdBQUEsR0FBTSxLQUFLLENBQUMsTUFBTixDQUFhO2dCQUFBLElBQUEsRUFBSyxrQkFBTDtnQkFBd0IsR0FBQSxFQUFJLEdBQTVCO2FBQWI7WUFDTixLQUFLLENBQUMsR0FBTixDQUFVO2dCQUFBLEdBQUEsRUFBSSxHQUFKO2dCQUFTLElBQUEsRUFBSyxtQkFBZDtnQkFBbUMsS0FBQSxFQUFNLEdBQUEsR0FBSSxLQUFKLEdBQVUsSUFBQyxDQUFBLEtBQXBEO2FBQVY7WUFDQSxLQUFLLENBQUMsR0FBTixDQUFVO2dCQUFBLEdBQUEsRUFBSSxHQUFKO2dCQUFTLElBQUEsRUFBSyxvQkFBZDtnQkFBbUMsS0FBQSxFQUFNLEdBQUEsR0FBSSxLQUFKLEdBQVUsSUFBQyxDQUFBLEtBQXBEO2dCQUEyRCxLQUFBLEVBQU0sR0FBakU7YUFBVixFQVZKOztRQWtCQSxNQUFBLEdBQVMsSUFBSSxDQUFDLFlBQWEsQ0FBQSxDQUFBLENBQUUsQ0FBQztRQUM5QixNQUFBLEdBQVMsSUFBSSxDQUFDLFlBQWEsQ0FBQSxDQUFBLENBQUUsQ0FBQztRQUU5QixJQUFDLENBQUEsTUFBRCxHQUFVLElBQUksQ0FBQyxHQUFMLENBQVMsSUFBQyxDQUFBLE1BQVYsRUFBa0IsTUFBbEI7UUFDVixJQUFDLENBQUEsTUFBRCxHQUFVLElBQUksQ0FBQyxHQUFMLENBQVMsSUFBQyxDQUFBLE1BQVYsRUFBa0IsTUFBbEI7UUFFVixHQUFBLEdBQU0sS0FBSyxDQUFDLE1BQU4sQ0FBYTtZQUFBLE1BQUEsRUFBTyxFQUFQO1lBQVUsSUFBQSxFQUFLLGlCQUFmO1lBQWlDLEdBQUEsRUFBSSxHQUFyQztTQUFiO1FBQ04sS0FBSyxDQUFDLEdBQU4sQ0FBVTtZQUFBLEdBQUEsRUFBSSxHQUFKO1lBQVMsTUFBQSxFQUFPLEVBQWhCO1lBQW1CLElBQUEsRUFBSyxrQkFBeEI7WUFBMkMsS0FBQSxFQUFNLEdBQUEsR0FBSSxNQUFKLEdBQVcsSUFBQyxDQUFBLE1BQTdEO1NBQVY7UUFDQSxLQUFLLENBQUMsR0FBTixDQUFVO1lBQUEsR0FBQSxFQUFJLEdBQUo7WUFBUyxNQUFBLEVBQU8sRUFBaEI7WUFBbUIsSUFBQSxFQUFLLGtCQUF4QjtZQUEyQyxLQUFBLEVBQU0sR0FBQSxHQUFJLE1BQUosR0FBVyxJQUFDLENBQUEsTUFBN0Q7WUFBcUUsS0FBQSxFQUFNLEdBQTNFO1NBQVY7UUFRQSxHQUFBLEdBQU0sS0FBSyxDQUFDLE1BQU4sQ0FBYTtZQUFBLE1BQUEsRUFBTyxFQUFQO1lBQVUsSUFBQSxFQUFLLGtCQUFmO1lBQWtDLEdBQUEsRUFBSSxHQUF0QztTQUFiO1FBQ04sS0FBSyxDQUFDLEdBQU4sQ0FBVTtZQUFBLEdBQUEsRUFBSSxHQUFKO1lBQVMsTUFBQSxFQUFPLEVBQWhCO1lBQW1CLElBQUEsRUFBSyxrQkFBeEI7WUFBMkMsS0FBQSxFQUFNLEdBQUEsR0FBSSxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQXJCLEdBQWlDLEdBQWxGO1NBQVY7UUFDQSxLQUFLLENBQUMsR0FBTixDQUFVO1lBQUEsR0FBQSxFQUFJLEdBQUo7WUFBUyxNQUFBLEVBQU8sRUFBaEI7WUFBbUIsSUFBQSxFQUFLLGtCQUF4QjtZQUEyQyxLQUFBLEVBQU0sR0FBQSxHQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQXJCLEdBQXNDLEdBQXZGO1NBQVY7UUFRQSxHQUFBLEdBQU0sS0FBSyxDQUFDLE1BQU4sQ0FBYTtZQUFBLE1BQUEsRUFBTyxFQUFQO1lBQVUsSUFBQSxFQUFLLGlCQUFmO1lBQWlDLEdBQUEsRUFBSSxHQUFyQztTQUFiO1FBQ04sS0FBSyxDQUFDLEdBQU4sQ0FBVTtZQUFBLEdBQUEsRUFBSSxHQUFKO1lBQVMsTUFBQSxFQUFPLEVBQWhCO1lBQW1CLElBQUEsRUFBSyxrQkFBeEI7WUFBNkMsS0FBQSxFQUFNLEdBQUEsR0FBSSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQWIsR0FBa0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUE5RTtTQUFWO2VBQ0EsS0FBSyxDQUFDLEdBQU4sQ0FBVTtZQUFBLEdBQUEsRUFBSSxHQUFKO1lBQVMsTUFBQSxFQUFPLEVBQWhCO1lBQW1CLElBQUEsRUFBSyxvQkFBeEI7WUFBNkMsS0FBQSxFQUFNLEdBQUEsR0FBSSxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQWIsR0FBb0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFoRjtTQUFWO0lBMURJOzs7O0dBZlU7O0FBMkV0QixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbjAwMCAgICAgICAgMDAwIDAwMCAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4wMDAwMDAwICAgICAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIFxuICAgICAwMDAgICAgIDAwMCAgICAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICBcbjAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMCAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgXG4jIyNcblxueyBwb3N0LCBlbGVtLCBfIH0gPSByZXF1aXJlICdreGsnXG5cbnV0aWxzICAgPSByZXF1aXJlICcuL3V0aWxzJ1xuS2FjaGVsICA9IHJlcXVpcmUgJy4va2FjaGVsJ1xuXG5jbGFzcyBTeXNkaXNoIGV4dGVuZHMgS2FjaGVsXG4gICAgICAgIFxuICAgIEA6IChAa2FjaGVsSWQ6J3N5c2Rpc2gnKSAtPiBcbiAgICAgICAgXG4gICAgICAgIEByeF9tYXggPSAwXG4gICAgICAgIEB0eF9tYXggPSAwXG5cbiAgICAgICAgQHJfbWF4ID0gMFxuICAgICAgICBAd19tYXggPSAwXG4gICAgICAgIFxuICAgICAgICBzdXBlclxuICAgICAgICBcbiAgICAgICAgcG9zdC50b01haW4gJ3JlcXVlc3REYXRhJyAnc3lzZGF0YScgQGlkXG4gICAgICAgIHBvc3Qub24gJ2RhdGEnIEBvbkRhdGFcbiAgICBcbiAgICBvbkRhdGE6IChkYXRhKSA9PlxuICAgICAgICBcbiAgICAgICAgQG1haW4uaW5uZXJIVE1MID0gJydcbiAgICAgICAgc3ZnID0gdXRpbHMuc3ZnIGNsc3M6J2Nsb2NrJ1xuICAgICAgICBAbWFpbi5hcHBlbmRDaGlsZCBzdmdcbiAgICAgICAgXG4gICAgICAgICMgMDAwICAgMDAwMDAwMCAgIFxuICAgICAgICAjIDAwMCAgMDAwICAgMDAwICBcbiAgICAgICAgIyAwMDAgIDAwMCAgIDAwMCAgXG4gICAgICAgICMgMDAwICAwMDAgICAwMDAgIFxuICAgICAgICAjIDAwMCAgIDAwMDAwMDAgICBcbiAgICAgICAgXG4gICAgICAgIGlmIGRhdGEuZGlza3NJTz9cbiAgICAgICAgXG4gICAgICAgICAgICByX3NlYyA9IGRhdGEuZGlza3NJTy5ySU9fc2VjXG4gICAgICAgICAgICB3X3NlYyA9IGRhdGEuZGlza3NJTy53SU9fc2VjXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIEByX21heCA9IE1hdGgubWF4IEByX21heCwgcl9zZWNcbiAgICAgICAgICAgIEB3X21heCA9IE1hdGgubWF4IEB3X21heCwgd19zZWNcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcGllID0gdXRpbHMuY2lyY2xlIGNsc3M6J3N5c2luZm9fZGlza19iZ3InIHN2ZzpzdmdcbiAgICAgICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCBjbHNzOidzeXNpbmZvX2Rpc2tfcmVhZCcgIGFuZ2xlOjE4MCpyX3NlYy9Acl9tYXhcbiAgICAgICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCBjbHNzOidzeXNpbmZvX2Rpc2tfd3JpdGUnIGFuZ2xlOjE4MCp3X3NlYy9Ad19tYXgsIHN0YXJ0OjE4MFxuICAgICAgICBcbiAgICAgICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIFxuICAgICAgICAjIDAwMDAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgXG4gICAgICAgICMgMDAwIDAgMDAwICAwMDAwMDAwICAgICAgMDAwICAgICBcbiAgICAgICAgIyAwMDAgIDAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIFxuICAgICAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAgIDAwMCAgICAgXG4gICAgICAgIFxuICAgICAgICByeF9zZWMgPSBkYXRhLm5ldHdvcmtTdGF0c1swXS5yeF9zZWNcbiAgICAgICAgdHhfc2VjID0gZGF0YS5uZXR3b3JrU3RhdHNbMF0udHhfc2VjXG4gICAgICAgIFxuICAgICAgICBAcnhfbWF4ID0gTWF0aC5tYXggQHJ4X21heCwgcnhfc2VjXG4gICAgICAgIEB0eF9tYXggPSBNYXRoLm1heCBAdHhfbWF4LCB0eF9zZWNcbiAgICAgICAgXG4gICAgICAgIHBpZSA9IHV0aWxzLmNpcmNsZSByYWRpdXM6NDcgY2xzczonc3lzaW5mb19uZXRfYmdyJyBzdmc6c3ZnXG4gICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCByYWRpdXM6NDcgY2xzczonc3lzaW5mb19uZXRfcmVjdicgYW5nbGU6MTgwKnJ4X3NlYy9AcnhfbWF4XG4gICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCByYWRpdXM6NDcgY2xzczonc3lzaW5mb19uZXRfc2VuZCcgYW5nbGU6MTgwKnR4X3NlYy9AdHhfbWF4LCBzdGFydDoxODBcbiAgICAgICAgICAgIFxuICAgICAgICAjIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgIFxuICAgICAgICAjIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICAgICAjIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAgICAwMDAgIFxuICAgICAgICAjIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgIFxuICAgICAgICBcbiAgICAgICAgcGllID0gdXRpbHMuY2lyY2xlIHJhZGl1czo0NCBjbHNzOidzeXNpbmZvX2xvYWRfYmdyJyBzdmc6c3ZnXG4gICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCByYWRpdXM6NDQgY2xzczonc3lzaW5mb19sb2FkX3N5cycgYW5nbGU6MzYwKmRhdGEuY3VycmVudExvYWQuY3VycmVudGxvYWQvMTAwXG4gICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCByYWRpdXM6NDQgY2xzczonc3lzaW5mb19sb2FkX3VzcicgYW5nbGU6MzYwKmRhdGEuY3VycmVudExvYWQuY3VycmVudGxvYWRfdXNlci8xMDBcbiAgICAgICAgICAgIFxuICAgICAgICAjIDAwICAgICAwMCAgMDAwMDAwMDAgIDAwICAgICAwMCAgXG4gICAgICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbiAgICAgICAgIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIFxuICAgICAgICAjIDAwMCAwIDAwMCAgMDAwICAgICAgIDAwMCAwIDAwMCAgXG4gICAgICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICBcbiAgICAgICAgXG4gICAgICAgIHBpZSA9IHV0aWxzLmNpcmNsZSByYWRpdXM6MTggY2xzczonc3lzaW5mb19tZW1fYmdyJyBzdmc6c3ZnXG4gICAgICAgIHV0aWxzLnBpZSBzdmc6cGllLCByYWRpdXM6MTggY2xzczonc3lzaW5mb19tZW1fdXNlZCcgICBhbmdsZTozNjAqZGF0YS5tZW0udXNlZC9kYXRhLm1lbS50b3RhbFxuICAgICAgICB1dGlscy5waWUgc3ZnOnBpZSwgcmFkaXVzOjE4IGNsc3M6J3N5c2luZm9fbWVtX2FjdGl2ZScgYW5nbGU6MzYwKmRhdGEubWVtLmFjdGl2ZS9kYXRhLm1lbS50b3RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gU3lzZGlzaFxuIl19
//# sourceURL=../coffee/sysdish.coffee