// koffee 1.4.0

/*
 0000000  000   000  000  000000000   0000000  000   000  
000       000 0 000  000     000     000       000   000  
0000000   000000000  000     000     000       000000000  
     000  000   000  000     000     000       000   000  
0000000   00     00  000     000      0000000  000   000
 */
var $, activate, activeApp, appIcon, apps, childp, clamp, done, drag, electron, elem, empty, getApps, highlight, initWin, karg, kerror, keyinfo, klog, kpos, last, loadApps, nextApp, onKeyDown, onKeyUp, onMouseDown, onMouseMove, onNextApp, os, pngPath, post, prefs, prevApp, quitApp, ref, slash, start, stopEvent, valid, winRect, wxw,
    indexOf = [].indexOf;

ref = require('kxk'), childp = ref.childp, post = ref.post, stopEvent = ref.stopEvent, karg = ref.karg, slash = ref.slash, drag = ref.drag, elem = ref.elem, prefs = ref.prefs, clamp = ref.clamp, kpos = ref.kpos, empty = ref.empty, valid = ref.valid, last = ref.last, klog = ref.klog, kerror = ref.kerror, keyinfo = ref.keyinfo, os = ref.os, $ = ref.$;

wxw = require('wxw');

electron = require('electron');

appIcon = require('./icon');

apps = [];

getApps = function() {
    var base, file, i, info, infos, j, len, len1, name, proc, ref1, ref2, ref3, ref4;
    infos = wxw('info');
    apps = [];
    if (os.platform() === 'darwin') {
        infos.sort(function(a, b) {
            var ai, bi;
            ai = a.index;
            if (ai < 0) {
                ai = 9999;
            }
            bi = b.index;
            if (bi < 0) {
                bi = 9999;
            }
            return ai - bi;
        });
    }
    for (i = 0, len = infos.length; i < len; i++) {
        info = infos[i];
        if (info.title === 'wxw-switch') {
            continue;
        }
        file = slash.file(info.path);
        if (file === 'ApplicationFrameHost.exe') {
            name = last(info.title.split(' ?- '));
            if (name === 'Calendar' || name === 'Mail') {
                if (indexOf.call(apps, name) < 0) {
                    apps.push(name);
                }
            } else if ((ref1 = info.title) === 'Settings' || ref1 === 'Calculator' || ref1 === 'Microsoft Store') {
                apps.push(info.title);
            }
        } else {
            if (ref2 = info.path, indexOf.call(apps, ref2) < 0) {
                apps.push(info.path);
            }
        }
    }
    ref3 = wxw('proc');
    for (j = 0, len1 = ref3.length; j < len1; j++) {
        proc = ref3[j];
        if (ref4 = proc.path, indexOf.call(apps, ref4) < 0) {
            base = slash.base(proc.path);
            if (base === 'kappo' || base === 'cmd') {
                continue;
            }
            if (slash.fileExists(pngPath(proc.path))) {
                apps.push(proc.path);
            }
        }
    }
    return apps;
};

pngPath = function(appPath) {
    return slash.resolve(slash.join(slash.userData(), 'icons', slash.base(appPath) + ".png"));
};

winRect = function(numApps) {
    var as, border, height, screen, ss, width;
    screen = (electron.remote != null) && electron.remote.screen || electron.screen;
    ss = screen.getPrimaryDisplay().workAreaSize;
    as = 128;
    border = 20;
    width = (as + border) * apps.length + border;
    height = as + border * 2;
    return {
        x: parseInt((ss.width - width) / 2),
        y: parseInt((ss.height - height) / 2),
        width: width,
        height: height
    };
};

start = function(opt) {
    var data, html, win, wr;
    if (opt == null) {
        opt = {};
    }
    apps = getApps();
    wr = winRect(apps.length);
    win = new electron.BrowserWindow({
        backgroundColor: '#00000000',
        transparent: true,
        preloadWindow: true,
        x: wr.x,
        y: wr.y,
        width: wr.width,
        height: wr.height,
        show: false,
        hasShadow: false,
        resizable: false,
        frame: false,
        thickFrame: false,
        fullscreen: false,
        webPreferences: {
            nodeIntegration: true,
            webSecurity: false
        }
    });
    html = "<head>\n<title>wxw-switch</title>\n<style type=\"text/css\">\n    * {\n        outline-width:  0;\n    }\n    \n    body {\n        overflow:       hidden;\n        margin:         0;\n    }\n    .apps {\n        opacity:        1;\n        white-space:    nowrap;\n        position:       absolute;\n        left:           0px;\n        top:            0px;\n        bottom:         0px;\n        right:          0px;\n        overflow:       hidden;\n        background:     rgb(16,16,16);\n        border-radius:  6px;\n        padding:        10px;\n    }\n    .app {\n        display:        inline-block;\n        width:          128px;\n        height:         128px;\n        padding:        10px;\n    }            \n    .app:hover {\n        background:     rgb(20,20,20);\n    }\n    .app.highlight {\n        background:     rgb(24,24,24);\n    }\n</style>\n</head>\n<body>\n<div class=\"apps\" tabindex=0></div>\n<script>\n    var pth = process.resourcesPath + \"/app/js/switch.js\";\n    if (process.resourcesPath.indexOf(\"node_modules\\\\electron\\\\dist\\\\resources\")>=0) { pth = process.cwd() + \"/js/switch.js\"; }\n    if (process.resourcesPath.indexOf(\"node_modules/electron/dist/Electron.app\")>=0) { pth = process.cwd() + \"/js/switch.js\"; }\n    console.log(pth, process.resourcesPath);\n    require(pth).initWin();\n</script>\n</body>";
    data = "data:text/html;charset=utf-8," + encodeURI(html);
    win.loadURL(data, {
        baseURLForDataURL: slash.fileUrl(__dirname + '/index.html')
    });
    win.debug = opt.debug;
    if (opt.debug) {
        win.webContents.openDevTools({
            mode: 'detach'
        });
    }
    return win;
};

done = function() {
    return electron.remote.getCurrentWindow().hide();
};

activeApp = null;

activate = function() {
    var i, info, infos, j, len, len1, ref1, ref2;
    done();
    if (activeApp.id) {
        if ((ref1 = activeApp.id) === 'Mail' || ref1 === 'Calendar') {
            infos = wxw('info', 'ApplicationFrameHost.exe');
            for (i = 0, len = infos.length; i < len; i++) {
                info = infos[i];
                if (info.title.endsWith(activeApp.id)) {
                    wxw('focus', info.id);
                    return;
                }
            }
            return childp.spawn('start', [
                {
                    Mail: 'outlookmail:',
                    Calendar: 'outlookcal:'
                }[activeApp.id]
            ], {
                encoding: 'utf8',
                shell: true,
                detached: true,
                stdio: 'inherit'
            });
        } else if ((ref2 = activeApp.id) === 'Calculator' || ref2 === 'Settings' || ref2 === 'Microsoft Store') {
            infos = wxw('info', 'ApplicationFrameHost.exe');
            for (j = 0, len1 = infos.length; j < len1; j++) {
                info = infos[j];
                if (info.title === activeApp.id) {
                    wxw('focus', info.id);
                    return;
                }
            }
            return childp.spawn('start', [
                {
                    Calculator: 'calculator:',
                    Settings: 'ms-settings:',
                    'Microsoft Store': 'ms-windows-store:'
                }[activeApp.id]
            ], {
                encoding: 'utf8',
                shell: true,
                detached: true,
                stdio: 'inherit'
            });
        } else {
            if (empty(wxw('info', activeApp.id))) {
                return wxw('launch', activeApp.id);
            } else {
                return wxw('focus', activeApp.id);
            }
        }
    }
};

highlight = function(e) {
    if (e.id) {
        if (activeApp != null) {
            activeApp.classList.remove('highlight');
        }
        e.classList.add('highlight');
        return activeApp = e;
    }
};

nextApp = function() {
    var ref1;
    return highlight((ref1 = activeApp.nextSibling) != null ? ref1 : $('.apps').firstChild);
};

prevApp = function() {
    var ref1;
    return highlight((ref1 = activeApp.previousSibling) != null ? ref1 : $('.apps').lastChild);
};

quitApp = function() {
    var oldActive, win, wr;
    klog('wxw quit', "\"" + activeApp.id + "\"");
    if (valid(wxw('quit', "\"" + activeApp.id + "\""))) {
        oldActive = activeApp;
        nextApp();
        oldActive.remove();
        apps = getApps();
        wr = winRect(apps.length);
        win = electron.remote.getCurrentWindow();
        return win.setBounds(wr);
    } else {
        return kerror("can't quit?");
    }
};

onMouseMove = function(event) {
    return highlight(event.target);
};

onMouseDown = function(event) {
    activeApp = event.target;
    return activate();
};

onKeyDown = function(event) {
    var char, combo, key, mod, ref1, win;
    ref1 = keyinfo.forEvent(event), mod = ref1.mod, key = ref1.key, char = ref1.char, combo = ref1.combo;
    win = electron.remote.getCurrentWindow();
    switch (key) {
        case 'esc':
            return done();
        case 'right':
            return nextApp();
        case 'left':
            return prevApp();
        case 'enter':
        case 'return':
        case 'space':
            return activate();
    }
    switch (combo) {
        case 'alt+ctrl+i':
            return win.webContents.openDevTools();
        case 'ctrl+shift+tab':
            return prevApp();
        case 'ctrl+q':
            return stopEvent(event, quitApp());
        case 'command+q':
            return stopEvent(event, quitApp());
        case 'alt+ctrl+q':
            return electron.remote.app.quit();
        case 'alt+ctrl+/':
            return post.toMain('showAbout');
    }
};

onKeyUp = function(event) {
    var char, combo, key, mod, ref1;
    ref1 = keyinfo.forEvent(event), mod = ref1.mod, key = ref1.key, char = ref1.char, combo = ref1.combo;
    if (empty(combo) && empty(wxw('key').trim())) {
        return activate();
    }
};

onNextApp = function() {
    var a, restore, win, wr;
    win = electron.remote.getCurrentWindow();
    if (win.isVisible()) {
        return nextApp();
    } else {
        a = $('.apps');
        a.innerHTML = '';
        if (os.platform() === 'win32') {
            win.setPosition(-10000, -10000);
            win.show();
            restore = function() {
                var wr;
                wr = winRect(apps.length);
                win.setBounds(wr);
                return win.focus();
            };
            setTimeout(restore, 30);
            return loadApps();
        } else {
            loadApps();
            if (empty(wxw('key').trim())) {
                return activate();
            } else {
                wr = winRect(apps.length);
                win.setBounds(wr);
                win.show();
                return win.focus();
            }
        }
    }
};

initWin = function() {
    var a, win;
    a = $('.apps');
    a.onmousedown = onMouseDown;
    a.onkeydown = onKeyDown;
    a.onkeyup = onKeyUp;
    win = electron.remote.getCurrentWindow();
    win.on('blur', function() {
        return done();
    });
    post.on('nextApp', onNextApp);
    return loadApps();
};

loadApps = function() {
    var a, app, i, len, png, ref1, ref2;
    a = $('.apps');
    a.innerHTML = '';
    ref1 = getApps();
    for (i = 0, len = ref1.length; i < len; i++) {
        app = ref1[i];
        if (app === 'Mail' || app === 'Calendar' || app === 'Calculator' || app === 'Settings' || app === 'Microsoft Store') {
            png = slash.join(__dirname, '..', 'icons', app + ".png");
        } else {
            png = pngPath(app);
            if (!slash.fileExists(png)) {
                appIcon(app, png);
                if (!slash.fileExists(png)) {
                    png = slash.join(__dirname, '..', 'icons', 'app.png');
                }
            }
        }
        a.appendChild(elem('img', {
            id: app,
            "class": 'app',
            src: slash.fileUrl(png)
        }));
    }
    a.focus();
    if (a.firstChild != null) {
        return highlight((ref2 = a.firstChild.nextSibling) != null ? ref2 : a.firstChild);
    }
};

module.exports = {
    start: start,
    initWin: initWin
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dpdGNoLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSx3VUFBQTtJQUFBOztBQVFBLE1BQTZILE9BQUEsQ0FBUSxLQUFSLENBQTdILEVBQUUsbUJBQUYsRUFBVSxlQUFWLEVBQWdCLHlCQUFoQixFQUEyQixlQUEzQixFQUFpQyxpQkFBakMsRUFBd0MsZUFBeEMsRUFBOEMsZUFBOUMsRUFBb0QsaUJBQXBELEVBQTJELGlCQUEzRCxFQUFrRSxlQUFsRSxFQUF3RSxpQkFBeEUsRUFBK0UsaUJBQS9FLEVBQXNGLGVBQXRGLEVBQTRGLGVBQTVGLEVBQWtHLG1CQUFsRyxFQUEwRyxxQkFBMUcsRUFBbUgsV0FBbkgsRUFBdUg7O0FBRXZILEdBQUEsR0FBVyxPQUFBLENBQVEsS0FBUjs7QUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBQ1gsT0FBQSxHQUFXLE9BQUEsQ0FBUSxRQUFSOztBQVFYLElBQUEsR0FBTzs7QUFDUCxPQUFBLEdBQVUsU0FBQTtBQUVOLFFBQUE7SUFBQSxLQUFBLEdBQVEsR0FBQSxDQUFJLE1BQUo7SUFDUixJQUFBLEdBQU87SUFFUCxJQUFHLEVBQUUsQ0FBQyxRQUFILENBQUEsQ0FBQSxLQUFpQixRQUFwQjtRQUNJLEtBQUssQ0FBQyxJQUFOLENBQVcsU0FBQyxDQUFELEVBQUcsQ0FBSDtBQUNQLGdCQUFBO1lBQUEsRUFBQSxHQUFLLENBQUMsQ0FBQztZQUNQLElBQUcsRUFBQSxHQUFLLENBQVI7Z0JBQWUsRUFBQSxHQUFLLEtBQXBCOztZQUNBLEVBQUEsR0FBSyxDQUFDLENBQUM7WUFDUCxJQUFHLEVBQUEsR0FBSyxDQUFSO2dCQUFlLEVBQUEsR0FBSyxLQUFwQjs7bUJBQ0EsRUFBQSxHQUFLO1FBTEUsQ0FBWCxFQURKOztBQVFBLFNBQUEsdUNBQUE7O1FBQ0ksSUFBWSxJQUFJLENBQUMsS0FBTCxLQUFjLFlBQTFCO0FBQUEscUJBQUE7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TixDQUFXLFNBQVgsRUFBc0IsSUFBdEIsRUFBMkIsT0FBM0IsRUFBbUMsU0FBbkMsRUFEVjtpQkFGSjthQUpKOztRQVNBLENBQUMsQ0FBQyxXQUFGLENBQWMsSUFBQSxDQUFLLEtBQUwsRUFDVjtZQUFBLEVBQUEsRUFBUSxHQUFSO1lBQ0EsQ0FBQSxLQUFBLENBQUEsRUFBUSxLQURSO1lBRUEsR0FBQSxFQUFRLEtBQUssQ0FBQyxPQUFOLENBQWMsR0FBZCxDQUZSO1NBRFUsQ0FBZDtBQVhKO0lBZ0JBLENBQUMsQ0FBQyxLQUFGLENBQUE7SUFFQSxJQUFHLG9CQUFIO2VBQ0ksU0FBQSxvREFBcUMsQ0FBQyxDQUFDLFVBQXZDLEVBREo7O0FBdkJPOztBQTBCWCxNQUFNLENBQUMsT0FBUCxHQUNJO0lBQUEsS0FBQSxFQUFNLEtBQU47SUFDQSxPQUFBLEVBQVEsT0FEUiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuMDAwICAgICAgIDAwMCAwIDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuMDAwMDAwMCAgIDAwICAgICAwMCAgMDAwICAgICAwMDAgICAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuIyMjXG5cbnsgY2hpbGRwLCBwb3N0LCBzdG9wRXZlbnQsIGthcmcsIHNsYXNoLCBkcmFnLCBlbGVtLCBwcmVmcywgY2xhbXAsIGtwb3MsIGVtcHR5LCB2YWxpZCwgbGFzdCwga2xvZywga2Vycm9yLCBrZXlpbmZvLCBvcywgJCB9ID0gcmVxdWlyZSAna3hrJ1xuXG53eHcgICAgICA9IHJlcXVpcmUgJ3d4dydcbmVsZWN0cm9uID0gcmVxdWlyZSAnZWxlY3Ryb24nXG5hcHBJY29uICA9IHJlcXVpcmUgJy4vaWNvbidcblxuIyAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwMDAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgIDAwMDAwMDAgIFxuIyAwMDAgICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAgIDAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIFxuIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICAgICAgICAwMDAgIFxuIyAgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICAgMDAwMDAwMCAgIFxuXG5hcHBzID0gW11cbmdldEFwcHMgPSAtPlxuXG4gICAgaW5mb3MgPSB3eHcgJ2luZm8nXG4gICAgYXBwcyA9IFtdXG4gICAgXG4gICAgaWYgb3MucGxhdGZvcm0oKSA9PSAnZGFyd2luJ1xuICAgICAgICBpbmZvcy5zb3J0IChhLGIpIC0+IFxuICAgICAgICAgICAgYWkgPSBhLmluZGV4IFxuICAgICAgICAgICAgaWYgYWkgPCAwIHRoZW4gYWkgPSA5OTk5XG4gICAgICAgICAgICBiaSA9IGIuaW5kZXhcbiAgICAgICAgICAgIGlmIGJpIDwgMCB0aGVuIGJpID0gOTk5OVxuICAgICAgICAgICAgYWkgLSBiaVxuICAgICAgICAgICAgICAgIFxuICAgIGZvciBpbmZvIGluIGluZm9zXG4gICAgICAgIGNvbnRpbnVlIGlmIGluZm8udGl0bGUgPT0gJ3d4dy1zd2l0Y2gnXG4gICAgICAgIGZpbGUgPSBzbGFzaC5maWxlIGluZm8ucGF0aFxuICAgICAgICBpZiBmaWxlID09ICdBcHBsaWNhdGlvbkZyYW1lSG9zdC5leGUnXG4gICAgICAgICAgICBuYW1lID0gbGFzdCBpbmZvLnRpdGxlLnNwbGl0ICcgPy0gJ1xuICAgICAgICAgICAgaWYgbmFtZSBpbiBbJ0NhbGVuZGFyJyAnTWFpbCddXG4gICAgICAgICAgICAgICAgYXBwcy5wdXNoIG5hbWUgaWYgbmFtZSBub3QgaW4gYXBwc1xuICAgICAgICAgICAgZWxzZSBpZiBpbmZvLnRpdGxlIGluIFsnU2V0dGluZ3MnICdDYWxjdWxhdG9yJyAnTWljcm9zb2Z0IFN0b3JlJ11cbiAgICAgICAgICAgICAgICBhcHBzLnB1c2ggaW5mby50aXRsZVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBhcHBzLnB1c2ggaW5mby5wYXRoIGlmIGluZm8ucGF0aCBub3QgaW4gYXBwc1xuICAgICAgICAgICAgXG4gICAgZm9yIHByb2MgaW4gd3h3ICdwcm9jJ1xuICAgICAgICBpZiBwcm9jLnBhdGggbm90IGluIGFwcHNcbiAgICAgICAgICAgIGJhc2UgPSBzbGFzaC5iYXNlIHByb2MucGF0aFxuICAgICAgICAgICAgY29udGludWUgaWYgYmFzZSBpbiBbJ2thcHBvJyAnY21kJ11cbiAgICAgICAgICAgIGlmIHNsYXNoLmZpbGVFeGlzdHMgcG5nUGF0aCBwcm9jLnBhdGhcbiAgICAgICAgICAgICAgICBhcHBzLnB1c2ggcHJvYy5wYXRoXG4gICAgICAgICAgICBcbiAgICAjIGtsb2cgJ2FwcHMnIGFwcHNcbiAgICBhcHBzXG4gICAgXG4jIDAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIFxuIyAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICBcbiMgMDAwMDAwMDAgICAwMDAgMCAwMDAgIDAwMCAgMDAwMCAgXG4jIDAwMCAgICAgICAgMDAwICAwMDAwICAwMDAgICAwMDAgIFxuIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICBcblxucG5nUGF0aCA9IChhcHBQYXRoKSAtPiBzbGFzaC5yZXNvbHZlIHNsYXNoLmpvaW4gc2xhc2gudXNlckRhdGEoKSwgJ2ljb25zJywgc2xhc2guYmFzZShhcHBQYXRoKSArIFwiLnBuZ1wiXG4gICAgXG4jICAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMDAgIFxuIyAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgICAgIDAwMCAgICAgXG4jICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcblxud2luUmVjdCA9IChudW1BcHBzKSAtPlxuICAgIFxuICAgIHNjcmVlbiA9IGVsZWN0cm9uLnJlbW90ZT8gYW5kIGVsZWN0cm9uLnJlbW90ZS5zY3JlZW4gb3IgZWxlY3Ryb24uc2NyZWVuXG4gICAgc3MgICAgID0gc2NyZWVuLmdldFByaW1hcnlEaXNwbGF5KCkud29ya0FyZWFTaXplXG4gICAgYXMgICAgID0gMTI4XG4gICAgYm9yZGVyID0gMjBcbiAgICB3aWR0aCAgPSAoYXMrYm9yZGVyKSphcHBzLmxlbmd0aCtib3JkZXJcbiAgICBoZWlnaHQgPSBhcytib3JkZXIqMlxuICAgIFxuICAgIHg6ICAgICAgcGFyc2VJbnQgKHNzLndpZHRoLXdpZHRoKS8yXG4gICAgeTogICAgICBwYXJzZUludCAoc3MuaGVpZ2h0LWhlaWdodCkvMlxuICAgIHdpZHRoOiAgd2lkdGhcbiAgICBoZWlnaHQ6IGhlaWdodFxuXG5zdGFydCA9IChvcHQ9e30pIC0+IFxuICAgIFxuICAgIGFwcHMgPSBnZXRBcHBzKClcbiAgICAgICAgICAgIFxuICAgIHdyID0gd2luUmVjdCBhcHBzLmxlbmd0aFxuICAgICAgICAgICAgXG4gICAgd2luID0gbmV3IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3dcblxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjMDAwMDAwMDAnXG4gICAgICAgIHRyYW5zcGFyZW50OiAgICAgdHJ1ZVxuICAgICAgICBwcmVsb2FkV2luZG93OiAgIHRydWVcbiAgICAgICAgeDogICAgICAgICAgICAgICB3ci54XG4gICAgICAgIHk6ICAgICAgICAgICAgICAgd3IueVxuICAgICAgICB3aWR0aDogICAgICAgICAgIHdyLndpZHRoXG4gICAgICAgIGhlaWdodDogICAgICAgICAgd3IuaGVpZ2h0XG4gICAgICAgIHNob3c6ICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgaGFzU2hhZG93OiAgICAgICBmYWxzZVxuICAgICAgICByZXNpemFibGU6ICAgICAgIGZhbHNlXG4gICAgICAgIGZyYW1lOiAgICAgICAgICAgZmFsc2VcbiAgICAgICAgdGhpY2tGcmFtZTogICAgICBmYWxzZVxuICAgICAgICBmdWxsc2NyZWVuOiAgICAgIGZhbHNlXG4gICAgICAgIHdlYlByZWZlcmVuY2VzOlxuICAgICAgICAgICAgbm9kZUludGVncmF0aW9uOiB0cnVlXG4gICAgICAgICAgICB3ZWJTZWN1cml0eTogICAgIGZhbHNlXG4gICAgICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMCAgICAgMDAgIDAwMCAgICAgIFxuICAgICMgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgXG4gICAgIyAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgMCAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgXG4gICAgXG4gICAgaHRtbCA9IFwiXCJcIlxuICAgICAgICA8aGVhZD5cbiAgICAgICAgPHRpdGxlPnd4dy1zd2l0Y2g8L3RpdGxlPlxuICAgICAgICA8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+XG4gICAgICAgICAgICAqIHtcbiAgICAgICAgICAgICAgICBvdXRsaW5lLXdpZHRoOiAgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYm9keSB7XG4gICAgICAgICAgICAgICAgb3ZlcmZsb3c6ICAgICAgIGhpZGRlbjtcbiAgICAgICAgICAgICAgICBtYXJnaW46ICAgICAgICAgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5hcHBzIHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAgICAgICAgMTtcbiAgICAgICAgICAgICAgICB3aGl0ZS1zcGFjZTogICAgbm93cmFwO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAgICAgICBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgICBsZWZ0OiAgICAgICAgICAgMHB4O1xuICAgICAgICAgICAgICAgIHRvcDogICAgICAgICAgICAwcHg7XG4gICAgICAgICAgICAgICAgYm90dG9tOiAgICAgICAgIDBweDtcbiAgICAgICAgICAgICAgICByaWdodDogICAgICAgICAgMHB4O1xuICAgICAgICAgICAgICAgIG92ZXJmbG93OiAgICAgICBoaWRkZW47XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogICAgIHJnYigxNiwxNiwxNik7XG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogIDZweDtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAgICAgICAgMTBweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5hcHAge1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6ICAgICAgICBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICAgICAgd2lkdGg6ICAgICAgICAgIDEyOHB4O1xuICAgICAgICAgICAgICAgIGhlaWdodDogICAgICAgICAxMjhweDtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAgICAgICAgMTBweDtcbiAgICAgICAgICAgIH0gICAgICAgICAgICBcbiAgICAgICAgICAgIC5hcHA6aG92ZXIge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICAgICByZ2IoMjAsMjAsMjApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLmFwcC5oaWdobGlnaHQge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICAgICByZ2IoMjQsMjQsMjQpO1xuICAgICAgICAgICAgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgICA8L2hlYWQ+XG4gICAgICAgIDxib2R5PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiYXBwc1wiIHRhYmluZGV4PTA+PC9kaXY+XG4gICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgICB2YXIgcHRoID0gcHJvY2Vzcy5yZXNvdXJjZXNQYXRoICsgXCIvYXBwL2pzL3N3aXRjaC5qc1wiO1xuICAgICAgICAgICAgaWYgKHByb2Nlc3MucmVzb3VyY2VzUGF0aC5pbmRleE9mKFwibm9kZV9tb2R1bGVzXFxcXFxcXFxlbGVjdHJvblxcXFxcXFxcZGlzdFxcXFxcXFxccmVzb3VyY2VzXCIpPj0wKSB7IHB0aCA9IHByb2Nlc3MuY3dkKCkgKyBcIi9qcy9zd2l0Y2guanNcIjsgfVxuICAgICAgICAgICAgaWYgKHByb2Nlc3MucmVzb3VyY2VzUGF0aC5pbmRleE9mKFwibm9kZV9tb2R1bGVzL2VsZWN0cm9uL2Rpc3QvRWxlY3Ryb24uYXBwXCIpPj0wKSB7IHB0aCA9IHByb2Nlc3MuY3dkKCkgKyBcIi9qcy9zd2l0Y2guanNcIjsgfVxuICAgICAgICAgICAgY29uc29sZS5sb2cocHRoLCBwcm9jZXNzLnJlc291cmNlc1BhdGgpO1xuICAgICAgICAgICAgcmVxdWlyZShwdGgpLmluaXRXaW4oKTtcbiAgICAgICAgPC9zY3JpcHQ+XG4gICAgICAgIDwvYm9keT5cbiAgICBcIlwiXCJcblxuICAgIGRhdGEgPSBcImRhdGE6dGV4dC9odG1sO2NoYXJzZXQ9dXRmLTgsXCIgKyBlbmNvZGVVUkkoaHRtbClcbiAgICB3aW4ubG9hZFVSTCBkYXRhLCBiYXNlVVJMRm9yRGF0YVVSTDpzbGFzaC5maWxlVXJsIF9fZGlybmFtZSArICcvaW5kZXguaHRtbCdcblxuICAgIHdpbi5kZWJ1ZyA9IG9wdC5kZWJ1Z1xuICAgIFxuICAgIGlmIG9wdC5kZWJ1ZyB0aGVuIHdpbi53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMgbW9kZTonZGV0YWNoJ1xuICAgICMgd2luLndlYkNvbnRlbnRzLm9wZW5EZXZUb29scyBtb2RlOidkZXRhY2gnXG4gICAgXG4gICAgd2luXG4gICAgICAgIFxuIyAwMDAwMDAwICAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAgICAgXG4jIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcblxuZG9uZSA9IC0+IGVsZWN0cm9uLnJlbW90ZS5nZXRDdXJyZW50V2luZG93KCkuaGlkZSgpXG5cbiMgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiMgMDAwMDAwMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgMDAwICAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAgICAgICAwICAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICBcblxuYWN0aXZlQXBwID0gbnVsbFxuXG5hY3RpdmF0ZSA9IC0+XG4gICAgXG4gICAgZG9uZSgpXG4gICAgICAgIFxuICAgIGlmIGFjdGl2ZUFwcC5pZFxuICAgICAgICBcbiAgICAgICAgaWYgYWN0aXZlQXBwLmlkIGluIFsnTWFpbCcgJ0NhbGVuZGFyJ11cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaW5mb3MgPSB3eHcgJ2luZm8nICdBcHBsaWNhdGlvbkZyYW1lSG9zdC5leGUnXG4gICAgICAgICAgICBmb3IgaW5mbyBpbiBpbmZvc1xuICAgICAgICAgICAgICAgIGlmIGluZm8udGl0bGUuZW5kc1dpdGggYWN0aXZlQXBwLmlkXG4gICAgICAgICAgICAgICAgICAgIHd4dyAnZm9jdXMnIGluZm8uaWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICBjaGlsZHAuc3Bhd24gJ3N0YXJ0JywgW3tNYWlsOidvdXRsb29rbWFpbDonIENhbGVuZGFyOidvdXRsb29rY2FsOid9W2FjdGl2ZUFwcC5pZF1dLCBlbmNvZGluZzondXRmOCcgc2hlbGw6dHJ1ZSBkZXRhY2hlZDp0cnVlIHN0ZGlvOidpbmhlcml0JyAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIGVsc2UgaWYgYWN0aXZlQXBwLmlkIGluIFsnQ2FsY3VsYXRvcicgJ1NldHRpbmdzJyAnTWljcm9zb2Z0IFN0b3JlJ11cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaW5mb3MgPSB3eHcgJ2luZm8nICdBcHBsaWNhdGlvbkZyYW1lSG9zdC5leGUnXG4gICAgICAgICAgICBmb3IgaW5mbyBpbiBpbmZvc1xuICAgICAgICAgICAgICAgIGlmIGluZm8udGl0bGUgPT0gYWN0aXZlQXBwLmlkXG4gICAgICAgICAgICAgICAgICAgIHd4dyAnZm9jdXMnIGluZm8uaWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICBjaGlsZHAuc3Bhd24gJ3N0YXJ0JywgW3tDYWxjdWxhdG9yOidjYWxjdWxhdG9yOicgU2V0dGluZ3M6J21zLXNldHRpbmdzOicgJ01pY3Jvc29mdCBTdG9yZSc6J21zLXdpbmRvd3Mtc3RvcmU6J31bYWN0aXZlQXBwLmlkXV0sIGVuY29kaW5nOid1dGY4JyBzaGVsbDp0cnVlIGRldGFjaGVkOnRydWUgc3RkaW86J2luaGVyaXQnXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGlmIGVtcHR5IHd4dygnaW5mbycsIGFjdGl2ZUFwcC5pZClcbiAgICAgICAgICAgICAgICB3eHcgJ2xhdW5jaCcgYWN0aXZlQXBwLmlkXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgd3h3ICdmb2N1cycgYWN0aXZlQXBwLmlkIFxuXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgIDAwMCAgICAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuXG5oaWdobGlnaHQgPSAoZSkgLT5cbiAgICBcbiAgICBpZiBlLmlkXG4gICAgICAgIGFjdGl2ZUFwcD8uY2xhc3NMaXN0LnJlbW92ZSAnaGlnaGxpZ2h0J1xuICAgICAgICBlLmNsYXNzTGlzdC5hZGQgJ2hpZ2hsaWdodCdcbiAgICAgICAgYWN0aXZlQXBwID0gZVxuXG5uZXh0QXBwID0gLT4gaGlnaGxpZ2h0IGFjdGl2ZUFwcC5uZXh0U2libGluZyA/ICQoJy5hcHBzJykuZmlyc3RDaGlsZFxucHJldkFwcCA9IC0+IGhpZ2hsaWdodCBhY3RpdmVBcHAucHJldmlvdXNTaWJsaW5nID8gJCgnLmFwcHMnKS5sYXN0Q2hpbGRcblxuIyAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgMDAgMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAgMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDAgICAgIFxuIyAgMDAwMDAgMDAgICAwMDAwMDAwICAgMDAwICAgICAwMDAgICAgIFxuXG5xdWl0QXBwID0gLT4gXG4gICAgXG4gICAga2xvZyAnd3h3IHF1aXQnIFwiXFxcIiN7YWN0aXZlQXBwLmlkfVxcXCJcIlxuICAgIGlmIHZhbGlkIHd4dyAncXVpdCcgXCJcXFwiI3thY3RpdmVBcHAuaWR9XFxcIlwiXG4gICAgICAgIG9sZEFjdGl2ZSA9IGFjdGl2ZUFwcFxuICAgICAgICBuZXh0QXBwKClcbiAgICAgICAgb2xkQWN0aXZlLnJlbW92ZSgpXG4gICAgICAgIGFwcHMgPSBnZXRBcHBzKClcbiAgICAgICAgd3IgID0gd2luUmVjdCBhcHBzLmxlbmd0aFxuICAgICAgICB3aW4gPSBlbGVjdHJvbi5yZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpXG4gICAgICAgIHdpbi5zZXRCb3VuZHMgd3JcbiAgICBlbHNlXG4gICAgICAgIGtlcnJvciBcImNhbid0IHF1aXQ/XCJcbiAgICBcbiMgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiMgMDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcblxub25Nb3VzZU1vdmUgPSAoZXZlbnQpIC0+IGhpZ2hsaWdodCBldmVudC50YXJnZXRcbm9uTW91c2VEb3duID0gKGV2ZW50KSAtPiBcbiAgICBcbiAgICBhY3RpdmVBcHAgPSBldmVudC50YXJnZXRcbiAgICBhY3RpdmF0ZSgpXG4gICAgICAgIFxuIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwIDAwMCAgIFxuIyAwMDAwMDAwICAgIDAwMDAwMDAgICAgIDAwMDAwICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgIFxuXG5vbktleURvd24gPSAoZXZlbnQpIC0+IFxuICAgIFxuICAgIHsgbW9kLCBrZXksIGNoYXIsIGNvbWJvIH0gPSBrZXlpbmZvLmZvckV2ZW50IGV2ZW50XG4gICAgXG4gICAgIyBrbG9nICdvbktleURvd24nIGNvbWJvXG4gICAgXG4gICAgd2luID0gZWxlY3Ryb24ucmVtb3RlLmdldEN1cnJlbnRXaW5kb3coKVxuICAgICBcbiAgICBzd2l0Y2gga2V5XG4gICAgICAgIHdoZW4gJ2VzYycgICB0aGVuIHJldHVybiBkb25lKClcbiAgICAgICAgd2hlbiAncmlnaHQnIHRoZW4gcmV0dXJuIG5leHRBcHAoKVxuICAgICAgICB3aGVuICdsZWZ0JyAgdGhlbiByZXR1cm4gcHJldkFwcCgpXG4gICAgICAgIHdoZW4gJ2VudGVyJyAncmV0dXJuJyAnc3BhY2UnIHRoZW4gcmV0dXJuIGFjdGl2YXRlKClcbiAgICAgICAgXG4gICAgc3dpdGNoIGNvbWJvXG4gICAgICAgIHdoZW4gJ2FsdCtjdHJsK2knICAgICB0aGVuIHJldHVybiB3aW4ud2ViQ29udGVudHMub3BlbkRldlRvb2xzKClcbiAgICAgICAgd2hlbiAnY3RybCtzaGlmdCt0YWInIHRoZW4gcmV0dXJuIHByZXZBcHAoKVxuICAgICAgICB3aGVuICdjdHJsK3EnICAgICAgICAgdGhlbiByZXR1cm4gc3RvcEV2ZW50IGV2ZW50LCBxdWl0QXBwKClcbiAgICAgICAgd2hlbiAnY29tbWFuZCtxJyAgICAgIHRoZW4gcmV0dXJuIHN0b3BFdmVudCBldmVudCwgcXVpdEFwcCgpXG4gICAgICAgIHdoZW4gJ2FsdCtjdHJsK3EnICAgICB0aGVuIHJldHVybiBlbGVjdHJvbi5yZW1vdGUuYXBwLnF1aXQoKVxuICAgICAgICB3aGVuICdhbHQrY3RybCsvJyAgICAgdGhlbiByZXR1cm4gcG9zdC50b01haW4gJ3Nob3dBYm91dCdcbiAgICAgICAgIyBlbHNlIGtsb2cgJ2NvbWJvJyBjb21ib1xuICAgICAgICBcbm9uS2V5VXAgPSAoZXZlbnQpIC0+ICAgICAgICBcbiAgICBcbiAgICB7IG1vZCwga2V5LCBjaGFyLCBjb21ibyB9ID0ga2V5aW5mby5mb3JFdmVudCBldmVudFxuICAgICAgICBcbiAgICAjIGtsb2cgJ29uS2V5VXAnIGNvbWJvLCAna2V5Jywga2V5LCAnd3h3Jywgd3h3KCdrZXknKS50cmltKClcbiAgICBcbiAgICBpZiBlbXB0eShjb21ibykgYW5kIGVtcHR5IHd4dygna2V5JykudHJpbSgpXG4gICAgICAgIGFjdGl2YXRlKClcblxuIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4jIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiMgMDAwIDAgMDAwICAwMDAwMDAwICAgICAwMDAwMCAgICAgICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuIyAwMDAgIDAwMDAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICAgXG4jIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgICBcblxub25OZXh0QXBwID0gLT5cbiAgICBcbiAgICB3aW4gPSBlbGVjdHJvbi5yZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpXG4gICAgICAgIFxuICAgIGlmIHdpbi5pc1Zpc2libGUoKVxuICAgICAgICBuZXh0QXBwKClcbiAgICBlbHNlXG4gICAgICAgIGEgPSQgJy5hcHBzJ1xuICAgICAgICBhLmlubmVySFRNTCA9ICcnXG4gICAgICAgIFxuICAgICAgICBpZiBvcy5wbGF0Zm9ybSgpID09ICd3aW4zMidcbiAgICAgICAgICAgIHdpbi5zZXRQb3NpdGlvbiAtMTAwMDAsLTEwMDAwICMgbW92ZSB3aW5kb3cgb2Zmc2NyZWVuIGJlZm9yZSBzaG93XG4gICAgICAgICAgICB3aW4uc2hvdygpXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlc3RvcmUgPSAtPiBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB3ciA9IHdpblJlY3QgYXBwcy5sZW5ndGhcbiAgICAgICAgICAgICAgICB3aW4uc2V0Qm91bmRzIHdyXG4gICAgICAgICAgICAgICAgd2luLmZvY3VzKClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXRUaW1lb3V0IHJlc3RvcmUsIDMwICMgZ2l2ZSB3aW5kb3dzIHNvbWUgdGltZSB0byBkbyBpdCdzIGZsaWNrZXJpbmdcbiAgICAgICAgICAgIGxvYWRBcHBzKClcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgbG9hZEFwcHMoKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBlbXB0eSB3eHcoJ2tleScpLnRyaW0oKVxuICAgICAgICAgICAgICAgIGFjdGl2YXRlKClcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB3ciA9IHdpblJlY3QgYXBwcy5sZW5ndGhcbiAgICAgICAgICAgICAgICB3aW4uc2V0Qm91bmRzIHdyXG4gICAgICAgICAgICAgICAgd2luLnNob3coKVxuICAgICAgICAgICAgICAgIHdpbi5mb2N1cygpXG4gICAgICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIDAwMCAgICAgICAwMDAgMCAwMDAgIDAwMCAgMDAwMCAgMDAwICBcbiMgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwICAgICAgIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIFxuIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgXG4jIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgICAgICAwMCAgICAgMDAgIDAwMCAgMDAwICAgMDAwICBcblxuaW5pdFdpbiA9IC0+XG4gICAgXG4gICAgYSA9JCAnLmFwcHMnXG4gICAgXG4gICAgYS5vbm1vdXNlZG93biA9IG9uTW91c2VEb3duXG4gICAgYS5vbmtleWRvd24gICA9IG9uS2V5RG93blxuICAgIGEub25rZXl1cCAgICAgPSBvbktleVVwXG5cbiAgICB3aW4gPSBlbGVjdHJvbi5yZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpXG4gICAgXG4gICAgd2luLm9uICdibHVyJyAtPiBkb25lKClcbiAgICBcbiAgICBwb3N0Lm9uICduZXh0QXBwJyBvbk5leHRBcHBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgbG9hZEFwcHMoKVxuICAgIFxuIyAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgIDAwMDAwMDAgIFxuIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIFxuIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICAgICAgICAwMDAgIFxuIyAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICAgMDAwMDAwMCAgIFxuXG5sb2FkQXBwcyA9IC0+XG4gICAgXG4gICAgYSA9JCAnLmFwcHMnXG4gICAgYS5pbm5lckhUTUwgPSAnJ1xuICAgIFxuICAgIGZvciBhcHAgaW4gZ2V0QXBwcygpXG4gICAgICAgIFxuICAgICAgICBpZiBhcHAgaW4gWydNYWlsJyAnQ2FsZW5kYXInICdDYWxjdWxhdG9yJyAnU2V0dGluZ3MnICdNaWNyb3NvZnQgU3RvcmUnXVxuICAgICAgICAgICAgcG5nID0gc2xhc2guam9pbiBfX2Rpcm5hbWUsICcuLicgJ2ljb25zJyBcIiN7YXBwfS5wbmdcIlxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBwbmcgPSBwbmdQYXRoIGFwcFxuICAgICAgICAgICAgaWYgbm90IHNsYXNoLmZpbGVFeGlzdHMgcG5nXG4gICAgICAgICAgICAgICAgYXBwSWNvbiBhcHAsIHBuZ1xuICAgICAgICAgICAgICAgIGlmIG5vdCBzbGFzaC5maWxlRXhpc3RzIHBuZ1xuICAgICAgICAgICAgICAgICAgICBwbmcgPSBzbGFzaC5qb2luIF9fZGlybmFtZSwgJy4uJyAnaWNvbnMnICdhcHAucG5nJ1xuICAgICAgICBcbiAgICAgICAgYS5hcHBlbmRDaGlsZCBlbGVtICdpbWcnLFxuICAgICAgICAgICAgaWQ6ICAgICBhcHBcbiAgICAgICAgICAgIGNsYXNzOiAgJ2FwcCcgXG4gICAgICAgICAgICBzcmM6ICAgIHNsYXNoLmZpbGVVcmwgcG5nXG4gICAgICAgIFxuICAgIGEuZm9jdXMoKVxuICAgIFxuICAgIGlmIGEuZmlyc3RDaGlsZD9cbiAgICAgICAgaGlnaGxpZ2h0IGEuZmlyc3RDaGlsZC5uZXh0U2libGluZyA/IGEuZmlyc3RDaGlsZFxuICAgICAgICAgICAgXG5tb2R1bGUuZXhwb3J0cyA9IFxuICAgIHN0YXJ0OnN0YXJ0XG4gICAgaW5pdFdpbjppbml0V2luXG4gICAgXG4gICAgXG4gICAgIl19
//# sourceURL=../coffee/switch.coffee