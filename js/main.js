// koffee 1.3.0

/*
00     00   0000000   000  000   000
000   000  000   000  000  0000  000
000000000  000000000  000  000 0 000
000 0 000  000   000  000  000  0000
000   000  000   000  000  000   000
 */
var BrowserWindow, KachelApp, activeWin, app, clamp, electron, hide, kachelSize, kacheln, klog, loadKacheln, mainWin, onArrange, onFocusKachel, onHideKacheln, onKachelSize, onNewKachel, onRaiseKacheln, onWinBlur, onWinFocus, post, prefs, raise, raised, raising, ref, relWin, shortcut, slash, winEvents, winWithId, wins;

ref = require('kxk'), post = ref.post, prefs = ref.prefs, slash = ref.slash, clamp = ref.clamp, klog = ref.klog, app = ref.app;

electron = require('electron');

BrowserWindow = electron.BrowserWindow;

kachelSize = 160;

mainWin = null;

winEvents = function(win) {
    win.on('focus', onWinFocus);
    win.on('blur', onWinBlur);
    return win.setHasShadow(false);
};

shortcut = slash.win() && 'ctrl+alt+k' || 'command+alt+k';

KachelApp = new app({
    dir: __dirname,
    pkg: require('../package.json'),
    shortcut: shortcut,
    index: 'mainwin.html',
    icon: '../img/app.ico',
    tray: '../img/menu.png',
    about: '../img/about.png',
    minWidth: 50,
    minHeight: 50,
    maxWidth: 50,
    maxHeight: 50,
    width: 50,
    height: 50,
    resizable: false,
    maximizable: false,
    saveBounds: false,
    onWinReady: function(win) {
        mainWin = win;
        winEvents(win);
        return loadKacheln();
    }
});

loadKacheln = function() {
    var kachelData, kachelId, ref1, results;
    ref1 = prefs.get('kacheln', {});
    results = [];
    for (kachelId in ref1) {
        kachelData = ref1[kachelId];
        if (kachelId !== 'appl') {
            results.push(onNewKachel(kachelData));
        } else {
            results.push(void 0);
        }
    }
    return results;
};

onNewKachel = function(arg) {
    var data, html, ref1, ref2, win;
    html = (ref1 = arg.html) != null ? ref1 : 'default', data = (ref2 = arg.data) != null ? ref2 : null;
    win = new electron.BrowserWindow({
        movable: true,
        transparent: true,
        autoHideMenuBar: true,
        frame: false,
        resizable: false,
        maximizable: false,
        minimizable: false,
        fullscreen: false,
        show: false,
        transparent: false,
        fullscreenenable: false,
        backgroundColor: '#181818',
        width: kachelSize,
        height: kachelSize,
        minWidth: kachelSize,
        minHeight: kachelSize,
        maxWidth: kachelSize,
        maxHeight: kachelSize,
        webPreferences: {
            nodeIntegration: true
        }
    });
    win.loadURL("file://" + __dirname + "/../js/" + html + ".html");
    win.webContents.on('dom-ready', function(event) {
        if (data != null) {
            post.toWin(win.id, 'initData', data);
        }
        return win.show();
    });
    winEvents(win);
    return win;
};

post.on('newKachel', onNewKachel);

onArrange = function() {
    var b, changed, d, i, id, j, len, len1, ref1, ref2, results, sh, snap, sw, w, wa;
    snap = kachelSize / 2;
    wa = electron.screen.getPrimaryDisplay().workAreaSize;
    ref1 = [wa.width, wa.height], sw = ref1[0], sh = ref1[1];
    changed = [];
    ref2 = kacheln();
    for (i = 0, len = ref2.length; i < len; i++) {
        w = ref2[i];
        b = w.getBounds();
        if (Math.abs(b.x) < snap) {
            d = b.x;
            b.x -= d;
            w.setBounds(b);
            changed.push(w.id);
        } else if (Math.abs(b.x + b.width - sw) < snap) {
            d = Math.abs(b.x + b.width - sw);
            b.x += d;
            w.setBounds(b);
            changed.push(w.id);
        }
        if (Math.abs(b.y) < snap) {
            d = b.y;
            b.y -= d;
            w.setBounds(b);
            changed.push(w.id);
        } else if (Math.abs(b.y + b.height - sh) < snap) {
            d = Math.abs(b.y + b.height - sh);
            b.y += d;
            w.setBounds(b);
            changed.push(w.id);
        }
    }
    results = [];
    for (j = 0, len1 = changed.length; j < len1; j++) {
        id = changed[j];
        results.push(post.toWin(id, 'saveBounds'));
    }
    return results;
};

post.on('arrange', onArrange);

onKachelSize = function(action) {
    var b, i, len, ref1, w;
    switch (action) {
        case 'increase':
            kachelSize += 32;
            break;
        case 'decrease':
            kachelSize -= 32;
            break;
        case 'reset':
            kachelSize = 160;
    }
    kachelSize = clamp(32, 320, kachelSize);
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        w = ref1[i];
        b = w.getBounds();
        b.width = kachelSize;
        b.height = kachelSize;
        w.setBounds(b);
    }
    return onArrange();
};

post.on('kachelSize', onKachelSize);

raised = false;

raising = false;

raise = function(win) {
    win.showInactive();
    return win.focus();
};

hide = function(win) {
    return win.hide();
};

onWinBlur = function(event) {
    if (event.sender === mainWin) {
        return raised = false;
    }
};

onWinFocus = function(event) {
    if (event.sender === mainWin) {
        if (!raised && !raising) {
            return onRaiseKacheln();
        } else if (raising) {
            raised = true;
            return raising = false;
        }
    }
};

onHideKacheln = function() {
    var i, len, ref1, win;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        win = ref1[i];
        hide(win);
    }
    return raised = false;
};

onRaiseKacheln = function() {
    var i, len, ref1, win;
    if (raised) {
        onHideKacheln();
        return;
    }
    raising = true;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        win = ref1[i];
        raise(win);
    }
    raised = true;
    return raise(mainWin);
};

post.on('raiseKacheln', onRaiseKacheln);

post.on('quit', KachelApp.quitApp);

onFocusKachel = function(winId, direction) {
    switch (direction) {
        case 'left':
        case 'up':
            return raise(relWin(winId, -1));
        case 'right':
        case 'down':
            return raise(relWin(winId, 1));
    }
};

post.on('focusKachel', onFocusKachel);

wins = function() {
    return BrowserWindow.getAllWindows().sort(function(a, b) {
        return a.id - b.id;
    });
};

activeWin = function() {
    return BrowserWindow.getFocusedWindow();
};

kacheln = function() {
    return wins().filter(function(w) {
        return w !== mainWin;
    });
};

winWithId = function(id) {
    return BrowserWindow.fromId(id);
};

relWin = function(winId, delta) {
    var w, wi, wl;
    wl = wins();
    w = BrowserWindow.fromId(winId);
    wi = wl.indexOf(w);
    return wl[(wl.length + wi + delta) % wl.length];
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBMkMsT0FBQSxDQUFRLEtBQVIsQ0FBM0MsRUFBRSxlQUFGLEVBQVEsaUJBQVIsRUFBZSxpQkFBZixFQUFzQixpQkFBdEIsRUFBNkIsZUFBN0IsRUFBbUM7O0FBRW5DLFFBQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxhQUFBLEdBQWdCLFFBQVEsQ0FBQzs7QUFFekIsVUFBQSxHQUFhOztBQUNiLE9BQUEsR0FBVTs7QUFFVixTQUFBLEdBQVksU0FBQyxHQUFEO0lBQ1IsR0FBRyxDQUFDLEVBQUosQ0FBTyxPQUFQLEVBQWdCLFVBQWhCO0lBQ0EsR0FBRyxDQUFDLEVBQUosQ0FBTyxNQUFQLEVBQWdCLFNBQWhCO1dBQ0EsR0FBRyxDQUFDLFlBQUosQ0FBaUIsS0FBakI7QUFIUTs7QUFLWixRQUFBLEdBQVcsS0FBSyxDQUFDLEdBQU4sQ0FBQSxDQUFBLElBQWdCLFlBQWhCLElBQWdDOztBQUUzQyxTQUFBLEdBQVksSUFBSSxHQUFKLENBQ1I7SUFBQSxHQUFBLEVBQWdCLFNBQWhCO0lBQ0EsR0FBQSxFQUFnQixPQUFBLENBQVEsaUJBQVIsQ0FEaEI7SUFFQSxRQUFBLEVBQWdCLFFBRmhCO0lBR0EsS0FBQSxFQUFnQixjQUhoQjtJQUlBLElBQUEsRUFBZ0IsZ0JBSmhCO0lBS0EsSUFBQSxFQUFnQixpQkFMaEI7SUFNQSxLQUFBLEVBQWdCLGtCQU5oQjtJQU9BLFFBQUEsRUFBZ0IsRUFQaEI7SUFRQSxTQUFBLEVBQWdCLEVBUmhCO0lBU0EsUUFBQSxFQUFnQixFQVRoQjtJQVVBLFNBQUEsRUFBZ0IsRUFWaEI7SUFXQSxLQUFBLEVBQWdCLEVBWGhCO0lBWUEsTUFBQSxFQUFnQixFQVpoQjtJQWFBLFNBQUEsRUFBZ0IsS0FiaEI7SUFjQSxXQUFBLEVBQWdCLEtBZGhCO0lBZUEsVUFBQSxFQUFnQixLQWZoQjtJQWdCQSxVQUFBLEVBQWdCLFNBQUMsR0FBRDtRQUNaLE9BQUEsR0FBVTtRQUNWLFNBQUEsQ0FBVSxHQUFWO2VBQ0EsV0FBQSxDQUFBO0lBSFksQ0FoQmhCO0NBRFE7O0FBc0JaLFdBQUEsR0FBYyxTQUFBO0FBRVYsUUFBQTtBQUFBO0FBQUE7U0FBQSxnQkFBQTs7UUFDSSxJQUFHLFFBQUEsS0FBWSxNQUFmO3lCQUNJLFdBQUEsQ0FBWSxVQUFaLEdBREo7U0FBQSxNQUFBO2lDQUFBOztBQURKOztBQUZVOztBQVlkLFdBQUEsR0FBYyxTQUFDLEdBQUQ7QUFFVixRQUFBO0lBRlcsMENBQUssV0FBVywwQ0FBRztJQUU5QixHQUFBLEdBQU0sSUFBSSxRQUFRLENBQUMsYUFBYixDQUVGO1FBQUEsT0FBQSxFQUFpQixJQUFqQjtRQUNBLFdBQUEsRUFBaUIsSUFEakI7UUFFQSxlQUFBLEVBQWlCLElBRmpCO1FBR0EsS0FBQSxFQUFpQixLQUhqQjtRQUlBLFNBQUEsRUFBaUIsS0FKakI7UUFLQSxXQUFBLEVBQWlCLEtBTGpCO1FBTUEsV0FBQSxFQUFpQixLQU5qQjtRQU9BLFVBQUEsRUFBaUIsS0FQakI7UUFRQSxJQUFBLEVBQWlCLEtBUmpCO1FBU0EsV0FBQSxFQUFpQixLQVRqQjtRQVVBLGdCQUFBLEVBQWtCLEtBVmxCO1FBV0EsZUFBQSxFQUFpQixTQVhqQjtRQVlBLEtBQUEsRUFBaUIsVUFaakI7UUFhQSxNQUFBLEVBQWlCLFVBYmpCO1FBY0EsUUFBQSxFQUFpQixVQWRqQjtRQWVBLFNBQUEsRUFBaUIsVUFmakI7UUFnQkEsUUFBQSxFQUFpQixVQWhCakI7UUFpQkEsU0FBQSxFQUFpQixVQWpCakI7UUFrQkEsY0FBQSxFQUNJO1lBQUEsZUFBQSxFQUFpQixJQUFqQjtTQW5CSjtLQUZFO0lBdUJOLEdBQUcsQ0FBQyxPQUFKLENBQVksU0FBQSxHQUFVLFNBQVYsR0FBb0IsU0FBcEIsR0FBNkIsSUFBN0IsR0FBa0MsT0FBOUM7SUFFQSxHQUFHLENBQUMsV0FBVyxDQUFDLEVBQWhCLENBQW1CLFdBQW5CLEVBQStCLFNBQUMsS0FBRDtRQUUzQixJQUFzQyxZQUF0QztZQUFBLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBRyxDQUFDLEVBQWYsRUFBbUIsVUFBbkIsRUFBOEIsSUFBOUIsRUFBQTs7ZUFDQSxHQUFHLENBQUMsSUFBSixDQUFBO0lBSDJCLENBQS9CO0lBS0EsU0FBQSxDQUFVLEdBQVY7V0FDQTtBQWpDVTs7QUFtQ2QsSUFBSSxDQUFDLEVBQUwsQ0FBUSxXQUFSLEVBQW9CLFdBQXBCOztBQVFBLFNBQUEsR0FBWSxTQUFBO0FBRVIsUUFBQTtJQUFBLElBQUEsR0FBTyxVQUFBLEdBQVc7SUFDbEIsRUFBQSxHQUFLLFFBQVEsQ0FBQyxNQUFNLENBQUMsaUJBQWhCLENBQUEsQ0FBbUMsQ0FBQztJQUN6QyxPQUFXLENBQUMsRUFBRSxDQUFDLEtBQUosRUFBVyxFQUFFLENBQUMsTUFBZCxDQUFYLEVBQUMsWUFBRCxFQUFLO0lBQ0wsT0FBQSxHQUFVO0FBRVY7QUFBQSxTQUFBLHNDQUFBOztRQUVJLENBQUEsR0FBSSxDQUFDLENBQUMsU0FBRixDQUFBO1FBRUosSUFBRyxJQUFJLENBQUMsR0FBTCxDQUFTLENBQUMsQ0FBQyxDQUFYLENBQUEsR0FBZ0IsSUFBbkI7WUFDSSxDQUFBLEdBQUksQ0FBQyxDQUFDO1lBQ04sQ0FBQyxDQUFDLENBQUYsSUFBTztZQUNQLENBQUMsQ0FBQyxTQUFGLENBQVksQ0FBWjtZQUNBLE9BQU8sQ0FBQyxJQUFSLENBQWEsQ0FBQyxDQUFDLEVBQWYsRUFKSjtTQUFBLE1BS0ssSUFBRyxJQUFJLENBQUMsR0FBTCxDQUFTLENBQUMsQ0FBQyxDQUFGLEdBQU0sQ0FBQyxDQUFDLEtBQVIsR0FBZ0IsRUFBekIsQ0FBQSxHQUErQixJQUFsQztZQUNELENBQUEsR0FBSSxJQUFJLENBQUMsR0FBTCxDQUFTLENBQUMsQ0FBQyxDQUFGLEdBQU0sQ0FBQyxDQUFDLEtBQVIsR0FBZ0IsRUFBekI7WUFDSixDQUFDLENBQUMsQ0FBRixJQUFPO1lBQ1AsQ0FBQyxDQUFDLFNBQUYsQ0FBWSxDQUFaO1lBQ0EsT0FBTyxDQUFDLElBQVIsQ0FBYSxDQUFDLENBQUMsRUFBZixFQUpDOztRQU1MLElBQUcsSUFBSSxDQUFDLEdBQUwsQ0FBUyxDQUFDLENBQUMsQ0FBWCxDQUFBLEdBQWdCLElBQW5CO1lBQ0ksQ0FBQSxHQUFJLENBQUMsQ0FBQztZQUNOLENBQUMsQ0FBQyxDQUFGLElBQU87WUFDUCxDQUFDLENBQUMsU0FBRixDQUFZLENBQVo7WUFDQSxPQUFPLENBQUMsSUFBUixDQUFhLENBQUMsQ0FBQyxFQUFmLEVBSko7U0FBQSxNQUtLLElBQUcsSUFBSSxDQUFDLEdBQUwsQ0FBUyxDQUFDLENBQUMsQ0FBRixHQUFNLENBQUMsQ0FBQyxNQUFSLEdBQWlCLEVBQTFCLENBQUEsR0FBZ0MsSUFBbkM7WUFDRCxDQUFBLEdBQUksSUFBSSxDQUFDLEdBQUwsQ0FBUyxDQUFDLENBQUMsQ0FBRixHQUFNLENBQUMsQ0FBQyxNQUFSLEdBQWlCLEVBQTFCO1lBQ0osQ0FBQyxDQUFDLENBQUYsSUFBTztZQUNQLENBQUMsQ0FBQyxTQUFGLENBQVksQ0FBWjtZQUNBLE9BQU8sQ0FBQyxJQUFSLENBQWEsQ0FBQyxDQUFDLEVBQWYsRUFKQzs7QUFwQlQ7QUEwQkE7U0FBQSwyQ0FBQTs7cUJBQ0ksSUFBSSxDQUFDLEtBQUwsQ0FBVyxFQUFYLEVBQWUsWUFBZjtBQURKOztBQWpDUTs7QUFvQ1osSUFBSSxDQUFDLEVBQUwsQ0FBUSxTQUFSLEVBQWtCLFNBQWxCOztBQVFBLFlBQUEsR0FBZSxTQUFDLE1BQUQ7QUFFWCxRQUFBO0FBQUEsWUFBTyxNQUFQO0FBQUEsYUFDUyxVQURUO1lBQ3lCLFVBQUEsSUFBYztBQUE5QjtBQURULGFBRVMsVUFGVDtZQUV5QixVQUFBLElBQWM7QUFBOUI7QUFGVCxhQUdTLE9BSFQ7WUFHeUIsVUFBQSxHQUFhO0FBSHRDO0lBS0EsVUFBQSxHQUFhLEtBQUEsQ0FBTSxFQUFOLEVBQVMsR0FBVCxFQUFhLFVBQWI7QUFFYjtBQUFBLFNBQUEsc0NBQUE7O1FBQ0ksQ0FBQSxHQUFJLENBQUMsQ0FBQyxTQUFGLENBQUE7UUFDSixDQUFDLENBQUMsS0FBRixHQUFVO1FBQ1YsQ0FBQyxDQUFDLE1BQUYsR0FBVztRQUNYLENBQUMsQ0FBQyxTQUFGLENBQVksQ0FBWjtBQUpKO1dBTUEsU0FBQSxDQUFBO0FBZlc7O0FBaUJmLElBQUksQ0FBQyxFQUFMLENBQVEsWUFBUixFQUFxQixZQUFyQjs7QUFRQSxNQUFBLEdBQVU7O0FBQ1YsT0FBQSxHQUFVOztBQUVWLEtBQUEsR0FBUSxTQUFDLEdBQUQ7SUFDSixHQUFHLENBQUMsWUFBSixDQUFBO1dBQ0EsR0FBRyxDQUFDLEtBQUosQ0FBQTtBQUZJOztBQUlSLElBQUEsR0FBTyxTQUFDLEdBQUQ7V0FDSCxHQUFHLENBQUMsSUFBSixDQUFBO0FBREc7O0FBR1AsU0FBQSxHQUFZLFNBQUMsS0FBRDtJQUNSLElBQUcsS0FBSyxDQUFDLE1BQU4sS0FBZ0IsT0FBbkI7ZUFDSSxNQUFBLEdBQVMsTUFEYjs7QUFEUTs7QUFJWixVQUFBLEdBQWEsU0FBQyxLQUFEO0lBQ1QsSUFBRyxLQUFLLENBQUMsTUFBTixLQUFnQixPQUFuQjtRQUNJLElBQUcsQ0FBSSxNQUFKLElBQWUsQ0FBSSxPQUF0QjttQkFDSSxjQUFBLENBQUEsRUFESjtTQUFBLE1BRUssSUFBRyxPQUFIO1lBQ0QsTUFBQSxHQUFTO21CQUNULE9BQUEsR0FBVSxNQUZUO1NBSFQ7O0FBRFM7O0FBUWIsYUFBQSxHQUFnQixTQUFBO0FBRVosUUFBQTtBQUFBO0FBQUEsU0FBQSxzQ0FBQTs7UUFDSSxJQUFBLENBQUssR0FBTDtBQURKO1dBRUEsTUFBQSxHQUFTO0FBSkc7O0FBTWhCLGNBQUEsR0FBaUIsU0FBQTtBQUViLFFBQUE7SUFBQSxJQUFHLE1BQUg7UUFDSSxhQUFBLENBQUE7QUFDQSxlQUZKOztJQUdBLE9BQUEsR0FBVTtBQUNWO0FBQUEsU0FBQSxzQ0FBQTs7UUFDSSxLQUFBLENBQU0sR0FBTjtBQURKO0lBRUEsTUFBQSxHQUFTO1dBQ1QsS0FBQSxDQUFNLE9BQU47QUFUYTs7QUFXakIsSUFBSSxDQUFDLEVBQUwsQ0FBUSxjQUFSLEVBQXVCLGNBQXZCOztBQUVBLElBQUksQ0FBQyxFQUFMLENBQVEsTUFBUixFQUFlLFNBQVMsQ0FBQyxPQUF6Qjs7QUFRQSxhQUFBLEdBQWdCLFNBQUMsS0FBRCxFQUFRLFNBQVI7QUFDWixZQUFPLFNBQVA7QUFBQSxhQUNTLE1BRFQ7QUFBQSxhQUNlLElBRGY7bUJBQzRCLEtBQUEsQ0FBTSxNQUFBLENBQU8sS0FBUCxFQUFjLENBQUMsQ0FBZixDQUFOO0FBRDVCLGFBRVMsT0FGVDtBQUFBLGFBRWdCLE1BRmhCO21CQUU0QixLQUFBLENBQU0sTUFBQSxDQUFPLEtBQVAsRUFBZSxDQUFmLENBQU47QUFGNUI7QUFEWTs7QUFLaEIsSUFBSSxDQUFDLEVBQUwsQ0FBUSxhQUFSLEVBQXNCLGFBQXRCOztBQVVBLElBQUEsR0FBWSxTQUFBO1dBQUcsYUFBYSxDQUFDLGFBQWQsQ0FBQSxDQUE2QixDQUFDLElBQTlCLENBQW1DLFNBQUMsQ0FBRCxFQUFHLENBQUg7ZUFBUyxDQUFDLENBQUMsRUFBRixHQUFPLENBQUMsQ0FBQztJQUFsQixDQUFuQztBQUFIOztBQUNaLFNBQUEsR0FBWSxTQUFBO1dBQUcsYUFBYSxDQUFDLGdCQUFkLENBQUE7QUFBSDs7QUFDWixPQUFBLEdBQVksU0FBQTtXQUFHLElBQUEsQ0FBQSxDQUFNLENBQUMsTUFBUCxDQUFjLFNBQUMsQ0FBRDtlQUFPLENBQUEsS0FBSztJQUFaLENBQWQ7QUFBSDs7QUFDWixTQUFBLEdBQVksU0FBQyxFQUFEO1dBQVEsYUFBYSxDQUFDLE1BQWQsQ0FBcUIsRUFBckI7QUFBUjs7QUFFWixNQUFBLEdBQVMsU0FBQyxLQUFELEVBQVEsS0FBUjtBQUNMLFFBQUE7SUFBQSxFQUFBLEdBQUssSUFBQSxDQUFBO0lBQ0wsQ0FBQSxHQUFJLGFBQWEsQ0FBQyxNQUFkLENBQXFCLEtBQXJCO0lBQ0osRUFBQSxHQUFLLEVBQUUsQ0FBQyxPQUFILENBQVcsQ0FBWDtXQUNMLEVBQUcsQ0FBQSxDQUFDLEVBQUUsQ0FBQyxNQUFILEdBQVUsRUFBVixHQUFhLEtBQWQsQ0FBQSxHQUFxQixFQUFFLENBQUMsTUFBeEI7QUFKRSIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgMDAwICAgMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDBcbjAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMFxuMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDBcbiMjI1xuXG57IHBvc3QsIHByZWZzLCBzbGFzaCwgY2xhbXAsIGtsb2csIGFwcCB9ID0gcmVxdWlyZSAna3hrJ1xuXG5lbGVjdHJvbiA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xuQnJvd3NlcldpbmRvdyA9IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3dcblxua2FjaGVsU2l6ZSA9IDE2MFxubWFpbldpbiA9IG51bGxcblxud2luRXZlbnRzID0gKHdpbikgLT5cbiAgICB3aW4ub24gJ2ZvY3VzJyAgb25XaW5Gb2N1c1xuICAgIHdpbi5vbiAnYmx1cicgICBvbldpbkJsdXJcbiAgICB3aW4uc2V0SGFzU2hhZG93IGZhbHNlXG4gICAgXG5zaG9ydGN1dCA9IHNsYXNoLndpbigpIGFuZCAnY3RybCthbHQraycgb3IgJ2NvbW1hbmQrYWx0K2snXG5cbkthY2hlbEFwcCA9IG5ldyBhcHBcbiAgICBkaXI6ICAgICAgICAgICAgX19kaXJuYW1lXG4gICAgcGtnOiAgICAgICAgICAgIHJlcXVpcmUgJy4uL3BhY2thZ2UuanNvbidcbiAgICBzaG9ydGN1dDogICAgICAgc2hvcnRjdXRcbiAgICBpbmRleDogICAgICAgICAgJ21haW53aW4uaHRtbCdcbiAgICBpY29uOiAgICAgICAgICAgJy4uL2ltZy9hcHAuaWNvJ1xuICAgIHRyYXk6ICAgICAgICAgICAnLi4vaW1nL21lbnUucG5nJ1xuICAgIGFib3V0OiAgICAgICAgICAnLi4vaW1nL2Fib3V0LnBuZydcbiAgICBtaW5XaWR0aDogICAgICAgNTBcbiAgICBtaW5IZWlnaHQ6ICAgICAgNTBcbiAgICBtYXhXaWR0aDogICAgICAgNTBcbiAgICBtYXhIZWlnaHQ6ICAgICAgNTBcbiAgICB3aWR0aDogICAgICAgICAgNTBcbiAgICBoZWlnaHQ6ICAgICAgICAgNTBcbiAgICByZXNpemFibGU6ICAgICAgZmFsc2UgI3RydWVcbiAgICBtYXhpbWl6YWJsZTogICAgZmFsc2VcbiAgICBzYXZlQm91bmRzOiAgICAgZmFsc2VcbiAgICBvbldpblJlYWR5OiAgICAgKHdpbikgLT5cbiAgICAgICAgbWFpbldpbiA9IHdpblxuICAgICAgICB3aW5FdmVudHMgd2luXG4gICAgICAgIGxvYWRLYWNoZWxuKClcblxubG9hZEthY2hlbG4gPSAtPlxuICAgIFxuICAgIGZvciBrYWNoZWxJZCxrYWNoZWxEYXRhIG9mIHByZWZzLmdldCAna2FjaGVsbicge31cbiAgICAgICAgaWYga2FjaGVsSWQgIT0gJ2FwcGwnXG4gICAgICAgICAgICBvbk5ld0thY2hlbCBrYWNoZWxEYXRhXG5cbiMgMDAwICAgMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAgICBcbiMgMDAwICAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICBcbiMgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgICAgICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAgICAgICBcbiMgMDAwICAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICBcblxub25OZXdLYWNoZWwgPSAoaHRtbDonZGVmYXVsdCcsIGRhdGE6KSAtPlxuXG4gICAgd2luID0gbmV3IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3dcbiAgICAgICAgXG4gICAgICAgIG1vdmFibGU6ICAgICAgICAgdHJ1ZVxuICAgICAgICB0cmFuc3BhcmVudDogICAgIHRydWVcbiAgICAgICAgYXV0b0hpZGVNZW51QmFyOiB0cnVlXG4gICAgICAgIGZyYW1lOiAgICAgICAgICAgZmFsc2VcbiAgICAgICAgcmVzaXphYmxlOiAgICAgICBmYWxzZVxuICAgICAgICBtYXhpbWl6YWJsZTogICAgIGZhbHNlXG4gICAgICAgIG1pbmltaXphYmxlOiAgICAgZmFsc2VcbiAgICAgICAgZnVsbHNjcmVlbjogICAgICBmYWxzZVxuICAgICAgICBzaG93OiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgIHRyYW5zcGFyZW50OiAgICAgZmFsc2VcbiAgICAgICAgZnVsbHNjcmVlbmVuYWJsZTogZmFsc2VcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnIzE4MTgxOCdcbiAgICAgICAgd2lkdGg6ICAgICAgICAgICBrYWNoZWxTaXplXG4gICAgICAgIGhlaWdodDogICAgICAgICAga2FjaGVsU2l6ZVxuICAgICAgICBtaW5XaWR0aDogICAgICAgIGthY2hlbFNpemVcbiAgICAgICAgbWluSGVpZ2h0OiAgICAgICBrYWNoZWxTaXplXG4gICAgICAgIG1heFdpZHRoOiAgICAgICAga2FjaGVsU2l6ZVxuICAgICAgICBtYXhIZWlnaHQ6ICAgICAgIGthY2hlbFNpemVcbiAgICAgICAgd2ViUHJlZmVyZW5jZXM6XG4gICAgICAgICAgICBub2RlSW50ZWdyYXRpb246IHRydWVcbiAgICBcbiAgICB3aW4ubG9hZFVSTCBcImZpbGU6Ly8je19fZGlybmFtZX0vLi4vanMvI3todG1sfS5odG1sXCJcbiAgICBcbiAgICB3aW4ud2ViQ29udGVudHMub24gJ2RvbS1yZWFkeScgKGV2ZW50KSAtPlxuICAgICAgICAjIGtsb2cgJ3dpbi1yZWFkeScsIGV2ZW50LnNlbmRlci5pZCwgd2luLmlkLCBkYXRhXG4gICAgICAgIHBvc3QudG9XaW4gd2luLmlkLCAnaW5pdERhdGEnIGRhdGEgaWYgZGF0YT9cbiAgICAgICAgd2luLnNob3coKVxuICAgICAgICBcbiAgICB3aW5FdmVudHMgd2luXG4gICAgd2luXG4gICAgICAgIFxucG9zdC5vbiAnbmV3S2FjaGVsJyBvbk5ld0thY2hlbFxuXG4jICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuXG5vbkFycmFuZ2UgPSAtPlxuICAgIFxuICAgIHNuYXAgPSBrYWNoZWxTaXplLzJcbiAgICB3YSA9IGVsZWN0cm9uLnNjcmVlbi5nZXRQcmltYXJ5RGlzcGxheSgpLndvcmtBcmVhU2l6ZVxuICAgIFtzdywgc2hdID0gW3dhLndpZHRoLCB3YS5oZWlnaHRdXG4gICAgY2hhbmdlZCA9IFtdXG4gICAgXG4gICAgZm9yIHcgaW4ga2FjaGVsbigpXG4gICAgICAgIFxuICAgICAgICBiID0gdy5nZXRCb3VuZHMoKVxuICAgICAgICBcbiAgICAgICAgaWYgTWF0aC5hYnMoYi54KSA8IHNuYXAgXG4gICAgICAgICAgICBkID0gYi54XG4gICAgICAgICAgICBiLnggLT0gZFxuICAgICAgICAgICAgdy5zZXRCb3VuZHMgYlxuICAgICAgICAgICAgY2hhbmdlZC5wdXNoIHcuaWRcbiAgICAgICAgZWxzZSBpZiBNYXRoLmFicyhiLnggKyBiLndpZHRoIC0gc3cpIDwgc25hcCBcbiAgICAgICAgICAgIGQgPSBNYXRoLmFicyhiLnggKyBiLndpZHRoIC0gc3cpXG4gICAgICAgICAgICBiLnggKz0gZFxuICAgICAgICAgICAgdy5zZXRCb3VuZHMgYlxuICAgICAgICAgICAgY2hhbmdlZC5wdXNoIHcuaWRcblxuICAgICAgICBpZiBNYXRoLmFicyhiLnkpIDwgc25hcCBcbiAgICAgICAgICAgIGQgPSBiLnlcbiAgICAgICAgICAgIGIueSAtPSBkXG4gICAgICAgICAgICB3LnNldEJvdW5kcyBiXG4gICAgICAgICAgICBjaGFuZ2VkLnB1c2ggdy5pZFxuICAgICAgICBlbHNlIGlmIE1hdGguYWJzKGIueSArIGIuaGVpZ2h0IC0gc2gpIDwgc25hcCBcbiAgICAgICAgICAgIGQgPSBNYXRoLmFicyhiLnkgKyBiLmhlaWdodCAtIHNoKVxuICAgICAgICAgICAgYi55ICs9IGRcbiAgICAgICAgICAgIHcuc2V0Qm91bmRzIGJcbiAgICAgICAgICAgIGNoYW5nZWQucHVzaCB3LmlkXG4gICAgICAgICAgICBcbiAgICBmb3IgaWQgaW4gY2hhbmdlZFxuICAgICAgICBwb3N0LnRvV2luIGlkLCAnc2F2ZUJvdW5kcydcblxucG9zdC5vbiAnYXJyYW5nZScgb25BcnJhbmdlXG5cbiMgIDAwMDAwMDAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuIyAwMDAgICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgICAgXG4jIDAwMDAwMDAgICAwMDAgICAgMDAwICAgIDAwMDAwMDAgICBcbiMgICAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAgIFxuIyAwMDAwMDAwICAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgXG5cbm9uS2FjaGVsU2l6ZSA9IChhY3Rpb24pIC0+XG4gICAgXG4gICAgc3dpdGNoIGFjdGlvblxuICAgICAgICB3aGVuICdpbmNyZWFzZScgdGhlbiBrYWNoZWxTaXplICs9IDMyXG4gICAgICAgIHdoZW4gJ2RlY3JlYXNlJyB0aGVuIGthY2hlbFNpemUgLT0gMzJcbiAgICAgICAgd2hlbiAncmVzZXQnICAgIHRoZW4ga2FjaGVsU2l6ZSA9IDE2MFxuICAgICAgICBcbiAgICBrYWNoZWxTaXplID0gY2xhbXAgMzIgMzIwIGthY2hlbFNpemVcbiAgICBcbiAgICBmb3IgdyBpbiBrYWNoZWxuKClcbiAgICAgICAgYiA9IHcuZ2V0Qm91bmRzKClcbiAgICAgICAgYi53aWR0aCA9IGthY2hlbFNpemVcbiAgICAgICAgYi5oZWlnaHQgPSBrYWNoZWxTaXplXG4gICAgICAgIHcuc2V0Qm91bmRzIGJcbiAgICAgICAgXG4gICAgb25BcnJhbmdlKClcblxucG9zdC5vbiAna2FjaGVsU2l6ZScgb25LYWNoZWxTaXplXG5cbiMgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgIFxuIyAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMFxuXG5yYWlzZWQgID0gZmFsc2VcbnJhaXNpbmcgPSBmYWxzZVxuXG5yYWlzZSA9ICh3aW4pIC0+XG4gICAgd2luLnNob3dJbmFjdGl2ZSgpXG4gICAgd2luLmZvY3VzKClcbiAgICBcbmhpZGUgPSAod2luKSAtPlxuICAgIHdpbi5oaWRlKClcblxub25XaW5CbHVyID0gKGV2ZW50KSAtPiBcbiAgICBpZiBldmVudC5zZW5kZXIgPT0gbWFpbldpbiBcbiAgICAgICAgcmFpc2VkID0gZmFsc2Vcblxub25XaW5Gb2N1cyA9IChldmVudCkgLT4gXG4gICAgaWYgZXZlbnQuc2VuZGVyID09IG1haW5XaW5cbiAgICAgICAgaWYgbm90IHJhaXNlZCBhbmQgbm90IHJhaXNpbmdcbiAgICAgICAgICAgIG9uUmFpc2VLYWNoZWxuKClcbiAgICAgICAgZWxzZSBpZiByYWlzaW5nXG4gICAgICAgICAgICByYWlzZWQgPSB0cnVlXG4gICAgICAgICAgICByYWlzaW5nID0gZmFsc2VcbiAgICBcbm9uSGlkZUthY2hlbG4gPSAtPlxuICAgIFxuICAgIGZvciB3aW4gaW4ga2FjaGVsbigpXG4gICAgICAgIGhpZGUgd2luXG4gICAgcmFpc2VkID0gZmFsc2Vcblxub25SYWlzZUthY2hlbG4gPSAtPlxuICAgIFxuICAgIGlmIHJhaXNlZFxuICAgICAgICBvbkhpZGVLYWNoZWxuKClcbiAgICAgICAgcmV0dXJuXG4gICAgcmFpc2luZyA9IHRydWVcbiAgICBmb3Igd2luIGluIGthY2hlbG4oKVxuICAgICAgICByYWlzZSB3aW5cbiAgICByYWlzZWQgPSB0cnVlXG4gICAgcmFpc2UgbWFpbldpblxuXG5wb3N0Lm9uICdyYWlzZUthY2hlbG4nIG9uUmFpc2VLYWNoZWxuICAgICAgICBcblxucG9zdC5vbiAncXVpdCcgS2FjaGVsQXBwLnF1aXRBcHBcblxuIyAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgXG4jIDAwMCAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICBcblxub25Gb2N1c0thY2hlbCA9ICh3aW5JZCwgZGlyZWN0aW9uKSAtPlxuICAgIHN3aXRjaCBkaXJlY3Rpb25cbiAgICAgICAgd2hlbiAnbGVmdCcndXAnICAgIHRoZW4gcmFpc2UgcmVsV2luIHdpbklkLCAtMVxuICAgICAgICB3aGVuICdyaWdodCcnZG93bicgdGhlbiByYWlzZSByZWxXaW4gd2luSWQsICAxXG5cbnBvc3Qub24gJ2ZvY3VzS2FjaGVsJyBvbkZvY3VzS2FjaGVsXG4gICAgICAgIFxuIyBrYWNoZWxDbG9zZWQgPSAoZXZlbnQpIC0+ICMgbG9nICdrYWNoZWxDbG9zZWQnXG4gICAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICBcbiMgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDAgICAgICAgMDAwICBcbiMgMDAgICAgIDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuXG53aW5zICAgICAgPSAtPiBCcm93c2VyV2luZG93LmdldEFsbFdpbmRvd3MoKS5zb3J0IChhLGIpIC0+IGEuaWQgLSBiLmlkXG5hY3RpdmVXaW4gPSAtPiBCcm93c2VyV2luZG93LmdldEZvY3VzZWRXaW5kb3coKVxua2FjaGVsbiAgID0gLT4gd2lucygpLmZpbHRlciAodykgLT4gdyAhPSBtYWluV2luXG53aW5XaXRoSWQgPSAoaWQpIC0+IEJyb3dzZXJXaW5kb3cuZnJvbUlkIGlkXG4gICAgXG5yZWxXaW4gPSAod2luSWQsIGRlbHRhKSAtPlxuICAgIHdsID0gd2lucygpXG4gICAgdyA9IEJyb3dzZXJXaW5kb3cuZnJvbUlkIHdpbklkXG4gICAgd2kgPSB3bC5pbmRleE9mIHdcbiAgICB3bFsod2wubGVuZ3RoK3dpK2RlbHRhKSV3bC5sZW5ndGhdXG4iXX0=
//# sourceURL=../coffee/main.coffee