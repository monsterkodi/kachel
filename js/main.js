// koffee 1.3.0

/*
00     00   0000000   000  000   000
000   000  000   000  000  0000  000
000000000  000000000  000  000 0 000
000 0 000  000   000  000  000  0000
000   000  000   000  000  000   000
 */
var Bounds, BrowserWindow, KachelApp, activeWin, app, clamp, electron, hide, kachelSize, kachelSizes, kacheln, klog, loadKacheln, mainWin, onArrange, onFocusKachel, onHideKacheln, onKachelSize, onNewKachel, onRaiseKacheln, onWinBlur, onWinFocus, post, prefs, raise, raised, raising, ref, relWin, shortcut, slash, winEvents, winWithId, wins;

ref = require('kxk'), post = ref.post, prefs = ref.prefs, slash = ref.slash, clamp = ref.clamp, klog = ref.klog, app = ref.app;

Bounds = require('./bounds');

electron = require('electron');

BrowserWindow = electron.BrowserWindow;

kachelSizes = [72, 108, 144, 216];

kachelSize = 1;

mainWin = null;

winEvents = function(win) {
    win.on('focus', onWinFocus);
    win.on('blur', onWinBlur);
    return win.setHasShadow(false);
};

shortcut = slash.win() && 'ctrl+alt+k' || 'command+alt+k';

KachelApp = new app({
    dir: __dirname,
    pkg: require('../package.json'),
    shortcut: shortcut,
    index: 'mainwin.html',
    icon: '../img/app.ico',
    tray: '../img/menu.png',
    about: '../img/about.png',
    minWidth: 50,
    minHeight: 50,
    maxWidth: 50,
    maxHeight: 50,
    width: 50,
    height: 50,
    acceptFirstMouse: true,
    resizable: false,
    maximizable: false,
    saveBounds: false,
    onWinReady: function(win) {
        mainWin = win;
        winEvents(win);
        return loadKacheln();
    }
});

loadKacheln = function() {
    var kachelData, kachelId, ref1, results;
    ref1 = prefs.get('kacheln', {});
    results = [];
    for (kachelId in ref1) {
        kachelData = ref1[kachelId];
        if (kachelId !== 'appl' && kachelId !== 'folder') {
            results.push(onNewKachel(kachelData));
        } else {
            results.push(void 0);
        }
    }
    return results;
};

onNewKachel = function(arg) {
    var data, html, ref1, ref2, win;
    html = (ref1 = arg.html) != null ? ref1 : 'default', data = (ref2 = arg.data) != null ? ref2 : null;
    win = new electron.BrowserWindow({
        movable: true,
        transparent: true,
        autoHideMenuBar: true,
        acceptFirstMouse: true,
        hasShadow: false,
        frame: false,
        resizable: false,
        maximizable: false,
        minimizable: false,
        fullscreen: false,
        show: false,
        transparent: false,
        fullscreenenable: false,
        backgroundColor: '#181818',
        width: kachelSizes[kachelSize],
        height: kachelSizes[kachelSize],
        webPreferences: {
            nodeIntegration: true
        }
    });
    win.loadURL("file://" + __dirname + "/../js/" + html + ".html");
    win.webContents.on('dom-ready', function(event) {
        if (data != null) {
            post.toWin(win.id, 'initData', data);
        }
        return win.show();
    });
    winEvents(win);
    return win;
};

post.on('newKachel', onNewKachel);

onArrange = function() {
    return Bounds.arrange(kacheln());
};

post.on('arrange', onArrange);

post.on('snapKachel', function(wid) {
    return Bounds.snap(kacheln(), winWithId(wid));
});

onKachelSize = function(action, wid) {
    var b, i, k, len, results, size, w;
    if (wid) {
        size = 0;
        while (kachelSizes[size] < winWithId(wid).getBounds().width) {
            size++;
        }
    } else {
        size = kachelSize;
    }
    switch (action) {
        case 'increase':
            size += 1;
            break;
        case 'decrease':
            size -= 1;
            break;
        case 'reset':
            size = 1;
    }
    size = clamp(0, kachelSizes.length - 1, size);
    if (wid) {
        k = [winWithId(wid)];
    } else {
        k = kacheln();
        kachelSize = size;
    }
    results = [];
    for (i = 0, len = k.length; i < len; i++) {
        w = k[i];
        b = w.getBounds();
        b.width = kachelSizes[size];
        b.height = kachelSizes[size];
        w.setBounds(b);
        results.push(Bounds.snap(kacheln(), w));
    }
    return results;
};

post.on('kachelSize', onKachelSize);

raised = false;

raising = false;

raise = function(win) {
    win.showInactive();
    return win.focus();
};

hide = function(win) {
    return win.hide();
};

onWinBlur = function(event) {
    if (event.sender === mainWin) {
        return raised = false;
    }
};

onWinFocus = function(event) {
    if (event.sender === mainWin) {
        if (!raised && !raising) {
            return onRaiseKacheln();
        } else if (raising) {
            raised = true;
            return raising = false;
        }
    }
};

onHideKacheln = function() {
    var i, len, ref1, win;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        win = ref1[i];
        hide(win);
    }
    return raised = false;
};

onRaiseKacheln = function() {
    var i, len, ref1, win;
    if (raised) {
        onHideKacheln();
        return;
    }
    raising = true;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        win = ref1[i];
        raise(win);
    }
    raised = true;
    return raise(mainWin);
};

post.on('raiseKacheln', onRaiseKacheln);

post.on('quit', KachelApp.quitApp);

onFocusKachel = function(winId, direction) {
    switch (direction) {
        case 'left':
        case 'up':
            return raise(relWin(winId, -1));
        case 'right':
        case 'down':
            return raise(relWin(winId, 1));
    }
};

post.on('focusKachel', onFocusKachel);

wins = function() {
    return BrowserWindow.getAllWindows().sort(function(a, b) {
        return a.id - b.id;
    });
};

activeWin = function() {
    return BrowserWindow.getFocusedWindow();
};

kacheln = function() {
    return wins().filter(function(w) {
        return w !== mainWin;
    });
};

winWithId = function(id) {
    return BrowserWindow.fromId(id);
};

relWin = function(winId, delta) {
    var w, wi, wl;
    wl = wins();
    w = BrowserWindow.fromId(winId);
    wi = wl.indexOf(w);
    return wl[(wl.length + wi + delta) % wl.length];
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBMkMsT0FBQSxDQUFRLEtBQVIsQ0FBM0MsRUFBRSxlQUFGLEVBQVEsaUJBQVIsRUFBZSxpQkFBZixFQUFzQixpQkFBdEIsRUFBNkIsZUFBN0IsRUFBbUM7O0FBRW5DLE1BQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBQ1gsYUFBQSxHQUFnQixRQUFRLENBQUM7O0FBRXpCLFdBQUEsR0FBYyxDQUFDLEVBQUQsRUFBSSxHQUFKLEVBQVEsR0FBUixFQUFZLEdBQVo7O0FBQ2QsVUFBQSxHQUFjOztBQUNkLE9BQUEsR0FBVTs7QUFFVixTQUFBLEdBQVksU0FBQyxHQUFEO0lBQ1IsR0FBRyxDQUFDLEVBQUosQ0FBTyxPQUFQLEVBQWdCLFVBQWhCO0lBQ0EsR0FBRyxDQUFDLEVBQUosQ0FBTyxNQUFQLEVBQWdCLFNBQWhCO1dBQ0EsR0FBRyxDQUFDLFlBQUosQ0FBaUIsS0FBakI7QUFIUTs7QUFLWixRQUFBLEdBQVcsS0FBSyxDQUFDLEdBQU4sQ0FBQSxDQUFBLElBQWdCLFlBQWhCLElBQWdDOztBQUUzQyxTQUFBLEdBQVksSUFBSSxHQUFKLENBQ1I7SUFBQSxHQUFBLEVBQW9CLFNBQXBCO0lBQ0EsR0FBQSxFQUFvQixPQUFBLENBQVEsaUJBQVIsQ0FEcEI7SUFFQSxRQUFBLEVBQW9CLFFBRnBCO0lBR0EsS0FBQSxFQUFvQixjQUhwQjtJQUlBLElBQUEsRUFBb0IsZ0JBSnBCO0lBS0EsSUFBQSxFQUFvQixpQkFMcEI7SUFNQSxLQUFBLEVBQW9CLGtCQU5wQjtJQU9BLFFBQUEsRUFBb0IsRUFQcEI7SUFRQSxTQUFBLEVBQW9CLEVBUnBCO0lBU0EsUUFBQSxFQUFvQixFQVRwQjtJQVVBLFNBQUEsRUFBb0IsRUFWcEI7SUFXQSxLQUFBLEVBQW9CLEVB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QUFQLENBQWMsU0FBQyxDQUFEO2VBQU8sQ0FBQSxLQUFLO0lBQVosQ0FBZDtBQUFIOztBQUNaLFNBQUEsR0FBWSxTQUFDLEVBQUQ7V0FBUSxhQUFhLENBQUMsTUFBZCxDQUFxQixFQUFyQjtBQUFSOztBQUVaLE1BQUEsR0FBUyxTQUFDLEtBQUQsRUFBUSxLQUFSO0FBQ0wsUUFBQTtJQUFBLEVBQUEsR0FBSyxJQUFBLENBQUE7SUFDTCxDQUFBLEdBQUksYUFBYSxDQUFDLE1BQWQsQ0FBcUIsS0FBckI7SUFDSixFQUFBLEdBQUssRUFBRSxDQUFDLE9BQUgsQ0FBVyxDQUFYO1dBQ0wsRUFBRyxDQUFBLENBQUMsRUFBRSxDQUFDLE1BQUgsR0FBVSxFQUFWLEdBQWEsS0FBZCxDQUFBLEdBQXFCLEVBQUUsQ0FBQyxNQUF4QjtBQUpFIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAwMDAgICAwMDBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMFxuMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwXG4wMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMFxuIyMjXG5cbnsgcG9zdCwgcHJlZnMsIHNsYXNoLCBjbGFtcCwga2xvZywgYXBwIH0gPSByZXF1aXJlICdreGsnXG5cbkJvdW5kcyAgID0gcmVxdWlyZSAnLi9ib3VuZHMnXG5lbGVjdHJvbiA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xuQnJvd3NlcldpbmRvdyA9IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3dcblxua2FjaGVsU2l6ZXMgPSBbNzIsMTA4LDE0NCwyMTZdXG5rYWNoZWxTaXplICA9IDFcbm1haW5XaW4gPSBudWxsXG5cbndpbkV2ZW50cyA9ICh3aW4pIC0+XG4gICAgd2luLm9uICdmb2N1cycgIG9uV2luRm9jdXNcbiAgICB3aW4ub24gJ2JsdXInICAgb25XaW5CbHVyXG4gICAgd2luLnNldEhhc1NoYWRvdyBmYWxzZVxuICAgIFxuc2hvcnRjdXQgPSBzbGFzaC53aW4oKSBhbmQgJ2N0cmwrYWx0K2snIG9yICdjb21tYW5kK2FsdCtrJ1xuXG5LYWNoZWxBcHAgPSBuZXcgYXBwXG4gICAgZGlyOiAgICAgICAgICAgICAgICBfX2Rpcm5hbWVcbiAgICBwa2c6ICAgICAgICAgICAgICAgIHJlcXVpcmUgJy4uL3BhY2thZ2UuanNvbidcbiAgICBzaG9ydGN1dDogICAgICAgICAgIHNob3J0Y3V0XG4gICAgaW5kZXg6ICAgICAgICAgICAgICAnbWFpbndpbi5odG1sJ1xuICAgIGljb246ICAgICAgICAgICAgICAgJy4uL2ltZy9hcHAuaWNvJ1xuICAgIHRyYXk6ICAgICAgICAgICAgICAgJy4uL2ltZy9tZW51LnBuZydcbiAgICBhYm91dDogICAgICAgICAgICAgICcuLi9pbWcvYWJvdXQucG5nJ1xuICAgIG1pbldpZHRoOiAgICAgICAgICAgNTBcbiAgICBtaW5IZWlnaHQ6ICAgICAgICAgIDUwXG4gICAgbWF4V2lkdGg6ICAgICAgICAgICA1MFxuICAgIG1heEhlaWdodDogICAgICAgICAgNTBcbiAgICB3aWR0aDogICAgICAgICAgICAgIDUwXG4gICAgaGVpZ2h0OiAgICAgICAgICAgICA1MFxuICAgIGFjY2VwdEZpcnN0TW91c2U6ICAgdHJ1ZVxuICAgIHJlc2l6YWJsZTogICAgICAgICAgZmFsc2UgI3RydWVcbiAgICBtYXhpbWl6YWJsZTogICAgICAgIGZhbHNlXG4gICAgc2F2ZUJvdW5kczogICAgICAgICBmYWxzZVxuICAgIG9uV2luUmVhZHk6ICAgICAod2luKSAtPlxuICAgICAgICBtYWluV2luID0gd2luXG4gICAgICAgIHdpbkV2ZW50cyB3aW5cbiAgICAgICAgbG9hZEthY2hlbG4oKVxuXG5sb2FkS2FjaGVsbiA9IC0+XG4gICAgXG4gICAgZm9yIGthY2hlbElkLGthY2hlbERhdGEgb2YgcHJlZnMuZ2V0ICdrYWNoZWxuJyB7fVxuICAgICAgICBpZiBrYWNoZWxJZCBub3QgaW4gWydhcHBsJyAnZm9sZGVyJ11cbiAgICAgICAgICAgIG9uTmV3S2FjaGVsIGthY2hlbERhdGFcblxuIyAwMDAgICAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuIyAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMCAgICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgIFxuXG5vbk5ld0thY2hlbCA9IChodG1sOidkZWZhdWx0JywgZGF0YTopIC0+XG5cbiAgICB3aW4gPSBuZXcgZWxlY3Ryb24uQnJvd3NlcldpbmRvd1xuICAgICAgICBcbiAgICAgICAgbW92YWJsZTogICAgICAgICAgICB0cnVlXG4gICAgICAgIHRyYW5zcGFyZW50OiAgICAgICAgdHJ1ZVxuICAgICAgICBhdXRvSGlkZU1lbnVCYXI6ICAgIHRydWVcbiAgICAgICAgYWNjZXB0Rmlyc3RNb3VzZTogICB0cnVlXG4gICAgICAgIGhhc1NoYWRvdzogICAgICAgICAgZmFsc2VcbiAgICAgICAgZnJhbWU6ICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICByZXNpemFibGU6ICAgICAgICAgIGZhbHNlXG4gICAgICAgIG1heGltaXphYmxlOiAgICAgICAgZmFsc2VcbiAgICAgICAgbWluaW1pemFibGU6ICAgICAgICBmYWxzZVxuICAgICAgICBmdWxsc2NyZWVuOiAgICAgICAgIGZhbHNlXG4gICAgICAgIHNob3c6ICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgdHJhbnNwYXJlbnQ6ICAgICAgICBmYWxzZVxuICAgICAgICBmdWxsc2NyZWVuZW5hYmxlOiAgIGZhbHNlXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogICAgJyMxODE4MTgnXG4gICAgICAgIHdpZHRoOiAgICAgICAgICAgICAga2FjaGVsU2l6ZXNba2FjaGVsU2l6ZV1cbiAgICAgICAgaGVpZ2h0OiAgICAgICAgICAgICBrYWNoZWxTaXplc1trYWNoZWxTaXplXVxuICAgICAgICB3ZWJQcmVmZXJlbmNlczogICBcbiAgICAgICAgICAgIG5vZGVJbnRlZ3JhdGlvbjogdHJ1ZVxuICAgIFxuICAgIHdpbi5sb2FkVVJMIFwiZmlsZTovLyN7X19kaXJuYW1lfS8uLi9qcy8je2h0bWx9Lmh0bWxcIlxuICAgIFxuICAgIHdpbi53ZWJDb250ZW50cy5vbiAnZG9tLXJlYWR5JyAoZXZlbnQpIC0+XG4gICAgICAgIHBvc3QudG9XaW4gd2luLmlkLCAnaW5pdERhdGEnIGRhdGEgaWYgZGF0YT9cbiAgICAgICAgd2luLnNob3coKVxuICAgICAgICBcbiAgICB3aW5FdmVudHMgd2luXG4gICAgd2luXG4gICAgICAgIFxucG9zdC5vbiAnbmV3S2FjaGVsJyBvbk5ld0thY2hlbFxuXG4jICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuXG5vbkFycmFuZ2UgPSAtPiBCb3VuZHMuYXJyYW5nZSBrYWNoZWxuKClcbiAgICBcbnBvc3Qub24gJ2FycmFuZ2UnIG9uQXJyYW5nZVxuXG5wb3N0Lm9uICdzbmFwS2FjaGVsJyAod2lkKSAtPiBCb3VuZHMuc25hcCBrYWNoZWxuKCksIHdpbldpdGhJZCB3aWRcblxuIyAgMDAwMDAwMCAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgXG4jIDAwMCAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICBcbiMgMDAwMDAwMCAgIDAwMCAgICAwMDAgICAgMDAwMDAwMCAgIFxuIyAgICAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgXG4jIDAwMDAwMDAgICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICBcblxub25LYWNoZWxTaXplID0gKGFjdGlvbiwgd2lkKSAtPlxuICAgIFxuICAgIGlmIHdpZFxuICAgICAgICBzaXplID0gMFxuICAgICAgICB3aGlsZSBrYWNoZWxTaXplc1tzaXplXSA8IHdpbldpdGhJZCh3aWQpLmdldEJvdW5kcygpLndpZHRoXG4gICAgICAgICAgICBzaXplKytcbiAgICBlbHNlXG4gICAgICAgIHNpemUgPSBrYWNoZWxTaXplXG4gICAgXG4gICAgc3dpdGNoIGFjdGlvblxuICAgICAgICB3aGVuICdpbmNyZWFzZScgdGhlbiBzaXplICs9IDFcbiAgICAgICAgd2hlbiAnZGVjcmVhc2UnIHRoZW4gc2l6ZSAtPSAxXG4gICAgICAgIHdoZW4gJ3Jlc2V0JyAgICB0aGVuIHNpemUgID0gMVxuICAgXG4gICAgc2l6ZSA9IGNsYW1wIDAga2FjaGVsU2l6ZXMubGVuZ3RoLTEgc2l6ZVxuICAgICAgICBcbiAgICBpZiB3aWRcbiAgICAgICAgayA9IFt3aW5XaXRoSWQgd2lkXVxuICAgIGVsc2VcbiAgICAgICAgayA9IGthY2hlbG4oKVxuICAgICAgICBrYWNoZWxTaXplID0gc2l6ZVxuICAgIFxuICAgIGZvciB3IGluIGtcbiAgICAgICAgYiA9IHcuZ2V0Qm91bmRzKClcbiAgICAgICAgYi53aWR0aCAgPSBrYWNoZWxTaXplc1tzaXplXVxuICAgICAgICBiLmhlaWdodCA9IGthY2hlbFNpemVzW3NpemVdXG4gICAgICAgIHcuc2V0Qm91bmRzIGJcbiAgICAgICAgQm91bmRzLnNuYXAga2FjaGVsbigpLCB3XG4gICAgICAgIFxuICAgICMgb25BcnJhbmdlKClcblxucG9zdC5vbiAna2FjaGVsU2l6ZScgb25LYWNoZWxTaXplXG5cbiMgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgIFxuIyAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMFxuXG5yYWlzZWQgID0gZmFsc2VcbnJhaXNpbmcgPSBmYWxzZVxuXG5yYWlzZSA9ICh3aW4pIC0+XG4gICAgd2luLnNob3dJbmFjdGl2ZSgpXG4gICAgd2luLmZvY3VzKClcbiAgICBcbmhpZGUgPSAod2luKSAtPlxuICAgIHdpbi5oaWRlKClcblxub25XaW5CbHVyID0gKGV2ZW50KSAtPiBcbiAgICBpZiBldmVudC5zZW5kZXIgPT0gbWFpbldpbiBcbiAgICAgICAgcmFpc2VkID0gZmFsc2Vcblxub25XaW5Gb2N1cyA9IChldmVudCkgLT4gXG4gICAgaWYgZXZlbnQuc2VuZGVyID09IG1haW5XaW5cbiAgICAgICAgaWYgbm90IHJhaXNlZCBhbmQgbm90IHJhaXNpbmdcbiAgICAgICAgICAgIG9uUmFpc2VLYWNoZWxuKClcbiAgICAgICAgZWxzZSBpZiByYWlzaW5nXG4gICAgICAgICAgICByYWlzZWQgPSB0cnVlXG4gICAgICAgICAgICByYWlzaW5nID0gZmFsc2VcbiAgICBcbm9uSGlkZUthY2hlbG4gPSAtPlxuICAgIFxuICAgIGZvciB3aW4gaW4ga2FjaGVsbigpXG4gICAgICAgIGhpZGUgd2luXG4gICAgcmFpc2VkID0gZmFsc2Vcblxub25SYWlzZUthY2hlbG4gPSAtPlxuICAgIFxuICAgIGlmIHJhaXNlZFxuICAgICAgICBvbkhpZGVLYWNoZWxuKClcbiAgICAgICAgcmV0dXJuXG4gICAgcmFpc2luZyA9IHRydWVcbiAgICBmb3Igd2luIGluIGthY2hlbG4oKVxuICAgICAgICByYWlzZSB3aW5cbiAgICByYWlzZWQgPSB0cnVlXG4gICAgcmFpc2UgbWFpbldpblxuXG5wb3N0Lm9uICdyYWlzZUthY2hlbG4nIG9uUmFpc2VLYWNoZWxuICAgICAgICBcblxucG9zdC5vbiAncXVpdCcgS2FjaGVsQXBwLnF1aXRBcHBcblxuIyAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgXG4jIDAwMCAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICBcblxub25Gb2N1c0thY2hlbCA9ICh3aW5JZCwgZGlyZWN0aW9uKSAtPlxuICAgIHN3aXRjaCBkaXJlY3Rpb25cbiAgICAgICAgd2hlbiAnbGVmdCcndXAnICAgIHRoZW4gcmFpc2UgcmVsV2luIHdpbklkLCAtMVxuICAgICAgICB3aGVuICdyaWdodCcnZG93bicgdGhlbiByYWlzZSByZWxXaW4gd2luSWQsICAxXG5cbnBvc3Qub24gJ2ZvY3VzS2FjaGVsJyBvbkZvY3VzS2FjaGVsXG4gICAgICAgIFxuIyBrYWNoZWxDbG9zZWQgPSAoZXZlbnQpIC0+ICMgbG9nICdrYWNoZWxDbG9zZWQnXG4gICAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICBcbiMgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDAgICAgICAgMDAwICBcbiMgMDAgICAgIDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuXG53aW5zICAgICAgPSAtPiBCcm93c2VyV2luZG93LmdldEFsbFdpbmRvd3MoKS5zb3J0IChhLGIpIC0+IGEuaWQgLSBiLmlkXG5hY3RpdmVXaW4gPSAtPiBCcm93c2VyV2luZG93LmdldEZvY3VzZWRXaW5kb3coKVxua2FjaGVsbiAgID0gLT4gd2lucygpLmZpbHRlciAodykgLT4gdyAhPSBtYWluV2luXG53aW5XaXRoSWQgPSAoaWQpIC0+IEJyb3dzZXJXaW5kb3cuZnJvbUlkIGlkXG4gICAgXG5yZWxXaW4gPSAod2luSWQsIGRlbHRhKSAtPlxuICAgIHdsID0gd2lucygpXG4gICAgdyA9IEJyb3dzZXJXaW5kb3cuZnJvbUlkIHdpbklkXG4gICAgd2kgPSB3bC5pbmRleE9mIHdcbiAgICB3bFsod2wubGVuZ3RoK3dpK2RlbHRhKSV3bC5sZW5ndGhdXG4iXX0=
//# sourceURL=../coffee/main.coffee