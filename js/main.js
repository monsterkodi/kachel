// koffee 1.3.0

/*
00     00   0000000   000  000   000
000   000  000   000  000  0000  000
000000000  000000000  000  000 0 000
000 0 000  000   000  000  000  0000
000   000  000   000  000  000   000
 */
var Bounds, BrowserWindow, KachelApp, activeWin, app, clamp, electron, hide, kachelSize, kacheln, klog, loadKacheln, mainWin, onArrange, onFocusKachel, onHideKacheln, onKachelSize, onNewKachel, onRaiseKacheln, onWinBlur, onWinFocus, post, prefs, raise, raised, raising, ref, relWin, shortcut, slash, winEvents, winWithId, wins;

ref = require('kxk'), post = ref.post, prefs = ref.prefs, slash = ref.slash, clamp = ref.clamp, klog = ref.klog, app = ref.app;

Bounds = require('./bounds');

electron = require('electron');

BrowserWindow = electron.BrowserWindow;

kachelSize = 160;

mainWin = null;

winEvents = function(win) {
    win.on('focus', onWinFocus);
    win.on('blur', onWinBlur);
    return win.setHasShadow(false);
};

shortcut = slash.win() && 'ctrl+alt+k' || 'command+alt+k';

KachelApp = new app({
    dir: __dirname,
    pkg: require('../package.json'),
    shortcut: shortcut,
    index: 'mainwin.html',
    icon: '../img/app.ico',
    tray: '../img/menu.png',
    about: '../img/about.png',
    minWidth: 50,
    minHeight: 50,
    maxWidth: 50,
    maxHeight: 50,
    width: 50,
    height: 50,
    resizable: false,
    maximizable: false,
    saveBounds: false,
    onWinReady: function(win) {
        mainWin = win;
        winEvents(win);
        return loadKacheln();
    }
});

loadKacheln = function() {
    var kachelData, kachelId, ref1, results;
    ref1 = prefs.get('kacheln', {});
    results = [];
    for (kachelId in ref1) {
        kachelData = ref1[kachelId];
        if (kachelId !== 'appl') {
            results.push(onNewKachel(kachelData));
        } else {
            results.push(void 0);
        }
    }
    return results;
};

onNewKachel = function(arg) {
    var data, html, ref1, ref2, win;
    html = (ref1 = arg.html) != null ? ref1 : 'default', data = (ref2 = arg.data) != null ? ref2 : null;
    win = new electron.BrowserWindow({
        movable: true,
        transparent: true,
        autoHideMenuBar: true,
        frame: false,
        resizable: false,
        maximizable: false,
        minimizable: false,
        fullscreen: false,
        show: false,
        transparent: false,
        fullscreenenable: false,
        backgroundColor: '#181818',
        width: kachelSize,
        height: kachelSize,
        webPreferences: {
            nodeIntegration: true
        }
    });
    win.loadURL("file://" + __dirname + "/../js/" + html + ".html");
    win.webContents.on('dom-ready', function(event) {
        if (data != null) {
            post.toWin(win.id, 'initData', data);
        }
        return win.show();
    });
    winEvents(win);
    return win;
};

post.on('newKachel', onNewKachel);

onArrange = function() {
    var b, i, j, len, len1, ref1, ref2, results, snap, w;
    snap = kachelSize / 2;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        w = ref1[i];
        b = w.getBounds();
        b = Bounds.onScreen(b);
        b = Bounds.onGrid(b);
        w.setBounds(b);
    }
    ref2 = kacheln();
    results = [];
    for (j = 0, len1 = ref2.length; j < len1; j++) {
        w = ref2[j];
        results.push(post.toWin(w.id, 'saveBounds'));
    }
    return results;
};

post.on('arrange', onArrange);

onKachelSize = function(action) {
    var b, i, len, ref1, w;
    switch (action) {
        case 'increase':
            kachelSize += 32;
            break;
        case 'decrease':
            kachelSize -= 32;
            break;
        case 'reset':
            kachelSize = 128;
    }
    kachelSize = clamp(64, 160, kachelSize);
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        w = ref1[i];
        b = w.getBounds();
        b.width = kachelSize;
        b.height = kachelSize;
        w.setBounds(b);
    }
    return onArrange();
};

post.on('kachelSize', onKachelSize);

raised = false;

raising = false;

raise = function(win) {
    win.showInactive();
    return win.focus();
};

hide = function(win) {
    return win.hide();
};

onWinBlur = function(event) {
    if (event.sender === mainWin) {
        return raised = false;
    }
};

onWinFocus = function(event) {
    if (event.sender === mainWin) {
        if (!raised && !raising) {
            return onRaiseKacheln();
        } else if (raising) {
            raised = true;
            return raising = false;
        }
    }
};

onHideKacheln = function() {
    var i, len, ref1, win;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        win = ref1[i];
        hide(win);
    }
    return raised = false;
};

onRaiseKacheln = function() {
    var i, len, ref1, win;
    if (raised) {
        onHideKacheln();
        return;
    }
    raising = true;
    ref1 = kacheln();
    for (i = 0, len = ref1.length; i < len; i++) {
        win = ref1[i];
        raise(win);
    }
    raised = true;
    return raise(mainWin);
};

post.on('raiseKacheln', onRaiseKacheln);

post.on('quit', KachelApp.quitApp);

onFocusKachel = function(winId, direction) {
    switch (direction) {
        case 'left':
        case 'up':
            return raise(relWin(winId, -1));
        case 'right':
        case 'down':
            return raise(relWin(winId, 1));
    }
};

post.on('focusKachel', onFocusKachel);

wins = function() {
    return BrowserWindow.getAllWindows().sort(function(a, b) {
        return a.id - b.id;
    });
};

activeWin = function() {
    return BrowserWindow.getFocusedWindow();
};

kacheln = function() {
    return wins().filter(function(w) {
        return w !== mainWin;
    });
};

winWithId = function(id) {
    return BrowserWindow.fromId(id);
};

relWin = function(winId, delta) {
    var w, wi, wl;
    wl = wins();
    w = BrowserWindow.fromId(winId);
    wi = wl.indexOf(w);
    return wl[(wl.length + wi + delta) % wl.length];
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUE7O0FBUUEsTUFBMkMsT0FBQSxDQUFRLEtBQVIsQ0FBM0MsRUFBRSxlQUFGLEVBQVEsaUJBQVIsRUFBZSxpQkFBZixFQUFzQixpQkFBdEIsRUFBNkIsZUFBN0IsRUFBbUM7O0FBRW5DLE1BQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBQ1gsYUFBQSxHQUFnQixRQUFRLENBQUM7O0FBRXpCLFVBQUEsR0FBYTs7QUFDYixPQUFBLEdBQVU7O0FBRVYsU0FBQSxHQUFZLFNBQUMsR0FBRDtJQUNSLEdBQUcsQ0FBQyxFQUFKLENBQU8sT0FBUCxFQUFnQixVQUFoQjtJQUNBLEdBQUcsQ0FBQyxFQUFKLENBQU8sTUFBUCxFQUFnQixTQUFoQjtXQUNBLEdBQUcsQ0FBQyxZQUFKLENBQWlCLEtBQWpCO0FBSFE7O0FBS1osUUFBQSxHQUFXLEtBQUssQ0FBQyxHQUFOLENBQUEsQ0FBQSxJQUFnQixZQUFoQixJQUFnQzs7QUFFM0MsU0FBQSxHQUFZLElBQUksR0FBSixDQUNSO0lBQUEsR0FBQSxFQUFnQixTQUFoQjtJQUNBLEdBQUEsRUFBZ0IsT0FBQSxDQUFRLGlCQUFSLENBRGhCO0lBRUEsUUFBQSxFQUFnQixRQUZoQjtJQUdBLEtBQUEsRUFBZ0IsY0FIaEI7SUFJQSxJQUFBLEVBQWdCLGdCQUpoQjtJQUtBLElBQUEsRUFBZ0IsaUJBTGhCO0lBTUEsS0FBQSxFQUFnQixrQkFOaEI7SUFPQSxRQUFBLEVBQWdCLEVBUGhCO0lBUUEsU0FBQSxFQUFnQixFQVJoQjtJQVNBLFFBQUEsRUFBZ0IsRUFUaEI7SUFVQSxTQUFBLEVBQWdCLEVBVmhCO0lBV0EsS0FBQSxFQUFnQixFQVhoQjtJQVlBLE1BQUEsRUFBZ0IsRUFaaEI7SUFhQSxTQUFBLEVBQWdCLEtBYmhCO0lBY0EsV0FB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O0FBQUEsYUFDUyxNQURUO0FBQUEsYUFDZSxJQURmO21CQUM0QixLQUFBLENBQU0sTUFBQSxDQUFPLEtBQVAsRUFBYyxDQUFDLENBQWYsQ0FBTjtBQUQ1QixhQUVTLE9BRlQ7QUFBQSxhQUVnQixNQUZoQjttQkFFNEIsS0FBQSxDQUFNLE1BQUEsQ0FBTyxLQUFQLEVBQWUsQ0FBZixDQUFOO0FBRjVCO0FBRFk7O0FBS2hCLElBQUksQ0FBQyxFQUFMLENBQVEsYUFBUixFQUFzQixhQUF0Qjs7QUFVQSxJQUFBLEdBQVksU0FBQTtXQUFHLGFBQWEsQ0FBQyxhQUFkLENBQUEsQ0FBNkIsQ0FBQyxJQUE5QixDQUFtQyxTQUFDLENBQUQsRUFBRyxDQUFIO2VBQVMsQ0FBQyxDQUFDLEVBQUYsR0FBTyxDQUFDLENBQUM7SUFBbEIsQ0FBbkM7QUFBSDs7QUFDWixTQUFBLEdBQVksU0FBQTtXQUFHLGFBQWEsQ0FBQyxnQkFBZCxDQUFBO0FBQUg7O0FBQ1osT0FBQSxHQUFZLFNBQUE7V0FBRyxJQUFBLENBQUEsQ0FBTSxDQUFDLE1BQVAsQ0FBYyxTQUFDLENBQUQ7ZUFBTyxDQUFBLEtBQUs7SUFBWixDQUFkO0FBQUg7O0FBQ1osU0FBQSxHQUFZLFNBQUMsRUFBRDtXQUFRLGFBQWEsQ0FBQyxNQUFkLENBQXFCLEVBQXJCO0FBQVI7O0FBRVosTUFBQSxHQUFTLFNBQUMsS0FBRCxFQUFRLEtBQVI7QUFDTCxRQUFBO0lBQUEsRUFBQSxHQUFLLElBQUEsQ0FBQTtJQUNMLENBQUEsR0FBSSxhQUFhLENBQUMsTUFBZCxDQUFxQixLQUFyQjtJQUNKLEVBQUEsR0FBSyxFQUFFLENBQUMsT0FBSCxDQUFXLENBQVg7V0FDTCxFQUFHLENBQUEsQ0FBQyxFQUFFLENBQUMsTUFBSCxHQUFVLEVBQVYsR0FBYSxLQUFkLENBQUEsR0FBcUIsRUFBRSxDQUFDLE1BQXhCO0FBSkUiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgIDAwMCAgIDAwMFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwXG4wMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDBcbjAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwXG4jIyNcblxueyBwb3N0LCBwcmVmcywgc2xhc2gsIGNsYW1wLCBrbG9nLCBhcHAgfSA9IHJlcXVpcmUgJ2t4aydcblxuQm91bmRzICAgPSByZXF1aXJlICcuL2JvdW5kcydcbmVsZWN0cm9uID0gcmVxdWlyZSAnZWxlY3Ryb24nXG5Ccm93c2VyV2luZG93ID0gZWxlY3Ryb24uQnJvd3NlcldpbmRvd1xuXG5rYWNoZWxTaXplID0gMTYwXG5tYWluV2luID0gbnVsbFxuXG53aW5FdmVudHMgPSAod2luKSAtPlxuICAgIHdpbi5vbiAnZm9jdXMnICBvbldpbkZvY3VzXG4gICAgd2luLm9uICdibHVyJyAgIG9uV2luQmx1clxuICAgIHdpbi5zZXRIYXNTaGFkb3cgZmFsc2VcbiAgICBcbnNob3J0Y3V0ID0gc2xhc2gud2luKCkgYW5kICdjdHJsK2FsdCtrJyBvciAnY29tbWFuZCthbHQraydcblxuS2FjaGVsQXBwID0gbmV3IGFwcFxuICAgIGRpcjogICAgICAgICAgICBfX2Rpcm5hbWVcbiAgICBwa2c6ICAgICAgICAgICAgcmVxdWlyZSAnLi4vcGFja2FnZS5qc29uJ1xuICAgIHNob3J0Y3V0OiAgICAgICBzaG9ydGN1dFxuICAgIGluZGV4OiAgICAgICAgICAnbWFpbndpbi5odG1sJ1xuICAgIGljb246ICAgICAgICAgICAnLi4vaW1nL2FwcC5pY28nXG4gICAgdHJheTogICAgICAgICAgICcuLi9pbWcvbWVudS5wbmcnXG4gICAgYWJvdXQ6ICAgICAgICAgICcuLi9pbWcvYWJvdXQucG5nJ1xuICAgIG1pbldpZHRoOiAgICAgICA1MFxuICAgIG1pbkhlaWdodDogICAgICA1MFxuICAgIG1heFdpZHRoOiAgICAgICA1MFxuICAgIG1heEhlaWdodDogICAgICA1MFxuICAgIHdpZHRoOiAgICAgICAgICA1MFxuICAgIGhlaWdodDogICAgICAgICA1MFxuICAgIHJlc2l6YWJsZTogICAgICBmYWxzZSAjdHJ1ZVxuICAgIG1heGltaXphYmxlOiAgICBmYWxzZVxuICAgIHNhdmVCb3VuZHM6ICAgICBmYWxzZVxuICAgIG9uV2luUmVhZHk6ICAgICAod2luKSAtPlxuICAgICAgICBtYWluV2luID0gd2luXG4gICAgICAgIHdpbkV2ZW50cyB3aW5cbiAgICAgICAgbG9hZEthY2hlbG4oKVxuXG5sb2FkS2FjaGVsbiA9IC0+XG4gICAgXG4gICAgZm9yIGthY2hlbElkLGthY2hlbERhdGEgb2YgcHJlZnMuZ2V0ICdrYWNoZWxuJyB7fVxuICAgICAgICBpZiBrYWNoZWxJZCAhPSAnYXBwbCdcbiAgICAgICAgICAgIG9uTmV3S2FjaGVsIGthY2hlbERhdGFcblxuIyAwMDAgICAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuIyAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMCAgICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgIFxuXG5vbk5ld0thY2hlbCA9IChodG1sOidkZWZhdWx0JywgZGF0YTopIC0+XG5cbiAgICB3aW4gPSBuZXcgZWxlY3Ryb24uQnJvd3NlcldpbmRvd1xuICAgICAgICBcbiAgICAgICAgbW92YWJsZTogICAgICAgICB0cnVlXG4gICAgICAgIHRyYW5zcGFyZW50OiAgICAgdHJ1ZVxuICAgICAgICBhdXRvSGlkZU1lbnVCYXI6IHRydWVcbiAgICAgICAgZnJhbWU6ICAgICAgICAgICBmYWxzZVxuICAgICAgICByZXNpemFibGU6ICAgICAgIGZhbHNlXG4gICAgICAgIG1heGltaXphYmxlOiAgICAgZmFsc2VcbiAgICAgICAgbWluaW1pemFibGU6ICAgICBmYWxzZVxuICAgICAgICBmdWxsc2NyZWVuOiAgICAgIGZhbHNlXG4gICAgICAgIHNob3c6ICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgdHJhbnNwYXJlbnQ6ICAgICBmYWxzZVxuICAgICAgICBmdWxsc2NyZWVuZW5hYmxlOiBmYWxzZVxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjMTgxODE4J1xuICAgICAgICB3aWR0aDogICAgICAgICAgIGthY2hlbFNpemVcbiAgICAgICAgaGVpZ2h0OiAgICAgICAgICBrYWNoZWxTaXplXG4gICAgICAgIHdlYlByZWZlcmVuY2VzOlxuICAgICAgICAgICAgbm9kZUludGVncmF0aW9uOiB0cnVlXG4gICAgXG4gICAgd2luLmxvYWRVUkwgXCJmaWxlOi8vI3tfX2Rpcm5hbWV9Ly4uL2pzLyN7aHRtbH0uaHRtbFwiXG4gICAgXG4gICAgd2luLndlYkNvbnRlbnRzLm9uICdkb20tcmVhZHknIChldmVudCkgLT5cbiAgICAgICAgcG9zdC50b1dpbiB3aW4uaWQsICdpbml0RGF0YScgZGF0YSBpZiBkYXRhP1xuICAgICAgICB3aW4uc2hvdygpXG4gICAgICAgIFxuICAgIHdpbkV2ZW50cyB3aW5cbiAgICB3aW5cbiAgICAgICAgXG5wb3N0Lm9uICduZXdLYWNoZWwnIG9uTmV3S2FjaGVsXG5cbiMgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgXG4jIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgXG5cbm9uQXJyYW5nZSA9IC0+XG4gICAgXG4gICAgc25hcCA9IGthY2hlbFNpemUvMlxuICAgIFxuICAgIGZvciB3IGluIGthY2hlbG4oKVxuICAgICAgICBcbiAgICAgICAgYiA9IHcuZ2V0Qm91bmRzKClcbiAgICAgICAgYiA9IEJvdW5kcy5vblNjcmVlbiBiXG4gICAgICAgIGIgPSBCb3VuZHMub25HcmlkIGJcbiAgICAgICAgXG4gICAgICAgIHcuc2V0Qm91bmRzIGJcbiAgICAgICAgXG4gICAgZm9yIHcgaW4ga2FjaGVsbigpXG4gICAgICAgIHBvc3QudG9XaW4gdy5pZCwgJ3NhdmVCb3VuZHMnXG5cbnBvc3Qub24gJ2FycmFuZ2UnIG9uQXJyYW5nZVxuXG4jICAwMDAwMDAwICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICBcbiMgMDAwICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgIFxuIyAwMDAwMDAwICAgMDAwICAgIDAwMCAgICAwMDAwMDAwICAgXG4jICAgICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgICBcbiMgMDAwMDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuXG5vbkthY2hlbFNpemUgPSAoYWN0aW9uKSAtPlxuICAgIFxuICAgIHN3aXRjaCBhY3Rpb25cbiAgICAgICAgd2hlbiAnaW5jcmVhc2UnIHRoZW4ga2FjaGVsU2l6ZSArPSAzMlxuICAgICAgICB3aGVuICdkZWNyZWFzZScgdGhlbiBrYWNoZWxTaXplIC09IDMyXG4gICAgICAgIHdoZW4gJ3Jlc2V0JyAgICB0aGVuIGthY2hlbFNpemUgPSAxMjhcbiAgICAgICAgXG4gICAga2FjaGVsU2l6ZSA9IGNsYW1wIDY0IDE2MCBrYWNoZWxTaXplXG4gICBcbiAgICAjIGtsb2cgJ2thY2hlbFNpemUnIGthY2hlbFNpemVcbiAgICBcbiAgICBmb3IgdyBpbiBrYWNoZWxuKClcbiAgICAgICAgYiA9IHcuZ2V0Qm91bmRzKClcbiAgICAgICAgYi53aWR0aCAgPSBrYWNoZWxTaXplXG4gICAgICAgIGIuaGVpZ2h0ID0ga2FjaGVsU2l6ZVxuICAgICAgICB3LnNldEJvdW5kcyBiXG4gICAgICAgIFxuICAgIG9uQXJyYW5nZSgpXG5cbnBvc3Qub24gJ2thY2hlbFNpemUnIG9uS2FjaGVsU2l6ZVxuXG4jIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAwMDAwMDAwICAwMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgICBcbiMgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDBcblxucmFpc2VkICA9IGZhbHNlXG5yYWlzaW5nID0gZmFsc2VcblxucmFpc2UgPSAod2luKSAtPlxuICAgIHdpbi5zaG93SW5hY3RpdmUoKVxuICAgIHdpbi5mb2N1cygpXG4gICAgXG5oaWRlID0gKHdpbikgLT5cbiAgICB3aW4uaGlkZSgpXG5cbm9uV2luQmx1ciA9IChldmVudCkgLT4gXG4gICAgaWYgZXZlbnQuc2VuZGVyID09IG1haW5XaW4gXG4gICAgICAgIHJhaXNlZCA9IGZhbHNlXG5cbm9uV2luRm9jdXMgPSAoZXZlbnQpIC0+IFxuICAgIGlmIGV2ZW50LnNlbmRlciA9PSBtYWluV2luXG4gICAgICAgIGlmIG5vdCByYWlzZWQgYW5kIG5vdCByYWlzaW5nXG4gICAgICAgICAgICBvblJhaXNlS2FjaGVsbigpXG4gICAgICAgIGVsc2UgaWYgcmFpc2luZ1xuICAgICAgICAgICAgcmFpc2VkID0gdHJ1ZVxuICAgICAgICAgICAgcmFpc2luZyA9IGZhbHNlXG4gICAgXG5vbkhpZGVLYWNoZWxuID0gLT5cbiAgICBcbiAgICBmb3Igd2luIGluIGthY2hlbG4oKVxuICAgICAgICBoaWRlIHdpblxuICAgIHJhaXNlZCA9IGZhbHNlXG5cbm9uUmFpc2VLYWNoZWxuID0gLT5cbiAgICBcbiAgICBpZiByYWlzZWRcbiAgICAgICAgb25IaWRlS2FjaGVsbigpXG4gICAgICAgIHJldHVyblxuICAgIHJhaXNpbmcgPSB0cnVlXG4gICAgZm9yIHdpbiBpbiBrYWNoZWxuKClcbiAgICAgICAgcmFpc2Ugd2luXG4gICAgcmFpc2VkID0gdHJ1ZVxuICAgIHJhaXNlIG1haW5XaW5cblxucG9zdC5vbiAncmFpc2VLYWNoZWxuJyBvblJhaXNlS2FjaGVsbiAgICAgICAgXG5cbnBvc3Qub24gJ3F1aXQnIEthY2hlbEFwcC5xdWl0QXBwXG5cbiMgMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgXG4jIDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuIyAwMDAgICAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG5cbm9uRm9jdXNLYWNoZWwgPSAod2luSWQsIGRpcmVjdGlvbikgLT5cbiAgICBzd2l0Y2ggZGlyZWN0aW9uXG4gICAgICAgIHdoZW4gJ2xlZnQnJ3VwJyAgICB0aGVuIHJhaXNlIHJlbFdpbiB3aW5JZCwgLTFcbiAgICAgICAgd2hlbiAncmlnaHQnJ2Rvd24nIHRoZW4gcmFpc2UgcmVsV2luIHdpbklkLCAgMVxuXG5wb3N0Lm9uICdmb2N1c0thY2hlbCcgb25Gb2N1c0thY2hlbFxuICAgICAgICBcbiMga2FjaGVsQ2xvc2VkID0gKGV2ZW50KSAtPiAjIGxvZyAna2FjaGVsQ2xvc2VkJ1xuICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgXG4jIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICBcbiMgMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwICAgICAgIDAwMCAgXG4jIDAwICAgICAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICBcblxud2lucyAgICAgID0gLT4gQnJvd3NlcldpbmRvdy5nZXRBbGxXaW5kb3dzKCkuc29ydCAoYSxiKSAtPiBhLmlkIC0gYi5pZFxuYWN0aXZlV2luID0gLT4gQnJvd3NlcldpbmRvdy5nZXRGb2N1c2VkV2luZG93KClcbmthY2hlbG4gICA9IC0+IHdpbnMoKS5maWx0ZXIgKHcpIC0+IHcgIT0gbWFpbldpblxud2luV2l0aElkID0gKGlkKSAtPiBCcm93c2VyV2luZG93LmZyb21JZCBpZFxuICAgIFxucmVsV2luID0gKHdpbklkLCBkZWx0YSkgLT5cbiAgICB3bCA9IHdpbnMoKVxuICAgIHcgPSBCcm93c2VyV2luZG93LmZyb21JZCB3aW5JZFxuICAgIHdpID0gd2wuaW5kZXhPZiB3XG4gICAgd2xbKHdsLmxlbmd0aCt3aStkZWx0YSkld2wubGVuZ3RoXVxuIl19
//# sourceURL=../coffee/main.coffee