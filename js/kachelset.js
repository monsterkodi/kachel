// koffee 1.4.0

/*
000   000   0000000    0000000  000   000  00000000  000       0000000  00000000  000000000
000  000   000   000  000       000   000  000       000      000       000          000   
0000000    000000000  000       000000000  0000000   000      0000000   0000000      000   
000  000   000   000  000       000   000  000       000           000  000          000   
000   000  000   000   0000000  000   000  00000000  0000000  0000000   00000000     000
 */
var Bounds, KachelSet, electron, empty, klog, post, prefs, ref, slash, valid,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    indexOf = [].indexOf;

ref = require('kxk'), post = ref.post, slash = ref.slash, prefs = ref.prefs, empty = ref.empty, valid = ref.valid, klog = ref.klog;

Bounds = require('./bounds');

electron = require('electron');

KachelSet = (function() {
    function KachelSet(mainId) {
        this.onKachelLoad = bind(this.onKachelLoad, this);
        this.didLoad = bind(this.didLoad, this);
        this.onStoreSet = bind(this.onStoreSet, this);
        this.onRestoreSet = bind(this.onRestoreSet, this);
        this.onToggleSet = bind(this.onToggleSet, this);
        this.onNewSet = bind(this.onNewSet, this);
        this.onKachelFocus = bind(this.onKachelFocus, this);
        this.onKachelClose = bind(this.onKachelClose, this);
        this.onNewKachel = bind(this.onNewKachel, this);
        var obj;
        this.switching = false;
        this.focusKachel = null;
        this.hoverKachel = null;
        this.dict = (
            obj = {},
            obj["" + mainId] = 'main',
            obj
        );
        this.wids = {
            main: mainId
        };
        this.set = [];
        this.sid = '';
        post.on('kachelLoad', this.onKachelLoad);
        post.on('toggleSet', this.onToggleSet);
        post.on('restoreSet', this.onRestoreSet);
        post.on('storeSet', this.onStoreSet);
        post.on('newSet', this.onNewSet);
        post.on('kachelFocus', this.onKachelFocus);
        post.on('newKachel', this.onNewKachel);
    }

    KachelSet.prototype.onNewKachel = function(kachelId) {
        var kachelSize, type, win;
        if (kachelId === 'main') {
            return;
        }
        if (this.wids[kachelId]) {
            win = this.win(kachelId);
            if (kachelId === 'default') {
                win.close();
                return;
            }
            win.showInactive();
            if (indexOf.call(this.set, kachelId) < 0) {
                this.set.push(kachelId);
                prefs.set("kacheln" + this.sid, this.set);
                prefs.save();
            }
            return;
        }
        kachelSize = 2;
        type = kachelId;
        if (kachelId.startsWith('start')) {
            type = 'start';
            kachelSize = 2;
        } else if (kachelId.endsWith('.app') || kachelId.endsWith('.exe')) {
            if (slash.base(kachelId) === 'konrad') {
                type = 'konrad';
                kachelSize = 4;
            } else {
                type = 'appl';
                kachelSize = 2;
            }
        } else if (kachelId.startsWith('/') || kachelId[1] === ':') {
            type = 'folder';
            kachelSize = 2;
        }
        switch (type) {
            case 'saver':
                kachelSize = 0;
                break;
            case 'sysdish':
            case 'sysinfo':
            case 'clock':
            case 'default':
                kachelSize = 2;
        }
        win = new electron.BrowserWindow({
            movable: true,
            transparent: true,
            autoHideMenuBar: true,
            acceptFirstMouse: true,
            hasShadow: false,
            frame: false,
            resizable: false,
            maximizable: false,
            minimizable: false,
            fullscreen: false,
            show: false,
            fullscreenenable: false,
            backgroundColor: '#181818',
            width: Bounds.kachelSizes[kachelSize],
            height: Bounds.kachelSizes[kachelSize],
            webPreferences: {
                nodeIntegration: true
            }
        });
        win.loadURL(KachelSet.html(type), {
            baseURLForDataURL: "file://" + __dirname + "/../js/index.html"
        });
        win.kachelId = kachelId;
        win.webContents.on('dom-ready', (function(id) {
            return function(event) {
                var wid;
                wid = event.sender.id;
                post.toWin(wid, 'initKachel', id);
                electron.BrowserWindow.fromId(wid).show();
                return Bounds.update();
            };
        })(kachelId));
        win.on('close', this.onKachelClose);
        win.setHasShadow(false);
        return win;
    };

    KachelSet.prototype.onKachelClose = function(event) {
        var kachel;
        kachel = event.sender;
        if (this.hoverKachel === kachel.id) {
            this.hoverKachel = null;
        }
        Bounds.remove(kachel);
        this.remove(kachel);
        return setTimeout((function() {
            return post.emit('bounds', 'dirty');
        }), 200);
    };

    KachelSet.prototype.onKachelFocus = function(winId) {
        if (this.dict[winId] !== 'main') {
            return this.focusKachel = electron.BrowserWindow.fromId(winId);
        }
    };

    KachelSet.prototype.onNewSet = function() {
        var sets;
        sets = prefs.get('sets', ['']);
        sets.push("" + sets.length);
        prefs.set('sets', sets);
        return this.load(sets.slice(-1)[0]);
    };

    KachelSet.prototype.onToggleSet = function() {
        var index, sets;
        if (this.switching) {
            return;
        }
        sets = prefs.get('sets', ['']);
        index = Math.max(0, sets.indexOf(this.sid));
        if (index >= sets.length - 1) {
            index = -1;
        }
        return this.load(sets[index + 1]);
    };

    KachelSet.prototype.onRestoreSet = function() {
        return this.load(this.sid, '_save');
    };

    KachelSet.prototype.onStoreSet = function() {
        prefs.set("kacheln" + this.sid + "_save", this.set);
        return prefs.save();
    };

    KachelSet.prototype.load = function(newSid, postfix) {
        var i, j, k, kachelId, l, len, len1, len2, len3, newSet, oldKacheln, ref1, ref2, showIds, updateIds;
        if (postfix == null) {
            postfix = '';
        }
        if (this.switching) {
            return;
        }
        this.switching = true;
        if (newSid != null) {
            newSid;
        } else {
            newSid = prefs.get('set', '');
        }
        if (empty(postfix)) {
            oldKacheln = prefs.get("kacheln" + this.sid, []);
        }
        this.kachelIds = [];
        updateIds = ['main'];
        showIds = [];
        newSet = prefs.get("kacheln" + newSid + postfix, []);
        ref1 = newSet != null ? newSet : [];
        for (i = 0, len = ref1.length; i < len; i++) {
            kachelId = ref1[i];
            if (kachelId !== 'main') {
                if (this.set.indexOf(kachelId) >= 0) {
                    updateIds.push(kachelId);
                    this.set.splice(this.set.indexOf(kachelId), 1);
                } else {
                    showIds.push(kachelId);
                    if (!this.wids[kachelId]) {
                        this.kachelIds.push(kachelId);
                    }
                }
            }
        }
        if (this.set.length) {
            ref2 = this.set.slice();
            for (j = 0, len1 = ref2.length; j < len1; j++) {
                kachelId = ref2[j];
                if (kachelId !== 'main' && kachelId !== 'null' && kachelId !== null) {
                    if (this.wids[kachelId]) {
                        this.win(kachelId).hide();
                    } else {
                        klog('no wid for', kachelId);
                    }
                }
            }
        }
        if (empty(postfix)) {
            prefs.set("kacheln" + this.sid, oldKacheln);
        }
        this.sid = newSid;
        prefs.set('set', this.sid);
        this.set = newSet;
        if (valid(postfix)) {
            prefs.set("kacheln" + newSid, this.set);
        }
        for (k = 0, len2 = updateIds.length; k < len2; k++) {
            kachelId = updateIds[k];
            post.emit('updateBounds', kachelId);
        }
        for (l = 0, len3 = showIds.length; l < len3; l++) {
            kachelId = showIds[l];
            this.onNewKachel(kachelId);
        }
        if (this.kachelIds.length === 0) {
            return this.didLoad();
        }
    };

    KachelSet.prototype.didLoad = function() {
        this.switching = false;
        this.win('main').focus();
        this.focusKachel = this.win('main');
        return post.emit('setLoaded');
    };

    KachelSet.prototype.onKachelLoad = function(wid, kachelId) {
        var index;
        if (indexOf.call(this.set, kachelId) < 0) {
            this.set.push(kachelId);
            prefs.set("kacheln" + this.sid, this.set);
            prefs.save();
        }
        this.dict[wid] = kachelId;
        this.wids[kachelId] = wid;
        if (this.kachelIds) {
            index = this.kachelIds.indexOf(kachelId);
            if (index >= 0) {
                this.kachelIds.splice(index, 1);
                if (this.kachelIds.length === 0) {
                    return this.didLoad();
                }
            } else if (kachelId !== 'default') {
                return klog('unknown kachel?', kachelId);
            }
        }
    };

    KachelSet.prototype.remove = function(kachel) {
        var kachelId;
        if (this.focusKachel === kachel) {
            this.focusKachel = null;
        }
        if (kachelId = this.dict[kachel.id]) {
            if (this.set.indexOf(kachelId) >= 0) {
                this.set.splice(this.set.indexOf(kachelId), 1);
            }
            delete this.wids[kachelId];
            delete this.dict[kachel.id];
            return prefs.set("kacheln" + this.sid, this.set);
        }
    };

    KachelSet.prototype.win = function(kachelId) {
        return electron.BrowserWindow.fromId(this.wids[kachelId]);
    };

    KachelSet.html = function(type) {
        var html;
        html = "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * 'unsafe-inline' 'unsafe-eval'\">\n    <link rel=\"stylesheet\" href=\"./css/style.css\" type=\"text/css\">\n    <link rel=\"stylesheet\" href=\"./css/dark.css\" type=\"text/css\" id=\"style-link\">\n  </head>\n  <body>\n    <div id=\"main\" tabindex=\"0\"></div>\n  </body>\n  <script>\n    Kachel = require(\"./" + type + ".js\");\n    new Kachel({});\n  </script>\n</html>";
        return "data:text/html;charset=utf-8," + encodeURI(html);
    };

    return KachelSet;

})();

module.exports = KachelSet;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2FjaGVsc2V0LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSx3RUFBQTtJQUFBOzs7QUFRQSxNQUE2QyxPQUFBLENBQVEsS0FBUixDQUE3QyxFQUFFLGVBQUYsRUFBUSxpQkFBUixFQUFlLGlCQUFmLEVBQXNCLGlCQUF0QixFQUE2QixpQkFBN0IsRUFBb0M7O0FBRXBDLE1BQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBRUw7SUFFQyxtQkFBQyxNQUFEOzs7Ozs7Ozs7O0FBRUMsWUFBQTtRQUFBLElBQUMsQ0FBQSxTQUFELEdBQWU7UUFFZixJQUFDLENBQUEsV0FBRCxHQUFlO1FBQ2YsSUFBQyxDQUFBLFdBQUQsR0FBZTtRQUVmLElBQUMsQ0FBQSxJQUFELEdBQVM7a0JBQUEsRUFBQTtnQkFBQSxFQUFBLEdBQUcsVUFBVSxNQUFiOzs7UUFDVCxJQUFDLENBQUEsSUFBRCxHQUFTO1lBQUEsSUFBQSxFQUFLLE1BQUw7O1FBQ1QsSUFBQyxDQUFBLEdBQUQsR0FBUztRQUNULElBQUMsQ0FBQSxHQUFELEdBQVM7UUFFVCxJQUFJLENBQUMsRUFBTCxDQUFRLFlBQVIsRUFBc0IsSUFBQyxDQUFBLFlBQXZCO1FBQ0EsSUFBSSxDQUFDLEVBQUwsQ0FBUSxXQUFSLEVBQXNCLElBQUMsQ0FBQSxXQUF2QjtRQUNBLElBQUksQ0FBQyxFQUFMLENBQVEsWUFBUixFQUFzQixJQUFDLENBQUEsWUFBdkI7UUFDQSxJQUFJLENBQUMsRUFBTCxDQUFRLFVBQVIsRUFBc0IsSUFBQyxDQUFBLFVBQXZCO1FBQ0EsSUFBSSxDQUFDLEVBQUwsQ0FBUSxRQUFSLEVBQXNCLElBQUMsQ0FBQSxRQUF2QjtRQUNBLElBQUksQ0FBQyxFQUFMLENBQVEsYUFBUixFQUFzQixJQUFDLENBQUEsYUFBdkI7UUFDQSxJQUFJLENBQUMsRUFBTCxDQUFRLFdB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QUFBLEdBQUssU0FBQyxRQUFEO2VBRUQsUUFBUSxDQUFDLGFBQWEsQ0FBQyxNQUF2QixDQUE4QixJQUFDLENBQUEsSUFBSyxDQUFBLFFBQUEsQ0FBcEM7SUFGQzs7SUFVTCxTQUFDLENBQUEsSUFBRCxHQUFPLFNBQUMsSUFBRDtBQUVILFlBQUE7UUFBQSxJQUFBLEdBQU8sZ2RBQUEsR0FhdUIsSUFidkIsR0FhNEI7ZUFNbkMsK0JBQUEsR0FBa0MsU0FBQSxDQUFVLElBQVY7SUFyQi9COzs7Ozs7QUF1QlgsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDBcbjAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICBcbjAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICBcbjAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICBcbiMjI1xuXG57IHBvc3QsIHNsYXNoLCBwcmVmcywgZW1wdHksIHZhbGlkLCBrbG9nIH0gPSByZXF1aXJlICdreGsnXG5cbkJvdW5kcyAgID0gcmVxdWlyZSAnLi9ib3VuZHMnXG5lbGVjdHJvbiA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xuXG5jbGFzcyBLYWNoZWxTZXRcblxuICAgIEA6IChtYWluSWQpIC0+XG4gICAgICAgIFxuICAgICAgICBAc3dpdGNoaW5nICAgPSBmYWxzZVxuICAgICAgICBcbiAgICAgICAgQGZvY3VzS2FjaGVsID0gbnVsbFxuICAgICAgICBAaG92ZXJLYWNoZWwgPSBudWxsXG4gICAgICAgIFxuICAgICAgICBAZGljdCAgPSBcIiN7bWFpbklkfVwiOiAnbWFpbidcbiAgICAgICAgQHdpZHMgID0gbWFpbjptYWluSWRcbiAgICAgICAgQHNldCAgID0gW11cbiAgICAgICAgQHNpZCAgID0gJydcbiAgICAgICAgXG4gICAgICAgIHBvc3Qub24gJ2thY2hlbExvYWQnICBAb25LYWNoZWxMb2FkXG4gICAgICAgIHBvc3Qub24gJ3RvZ2dsZVNldCcgICBAb25Ub2dnbGVTZXRcbiAgICAgICAgcG9zdC5vbiAncmVzdG9yZVNldCcgIEBvblJlc3RvcmVTZXRcbiAgICAgICAgcG9zdC5vbiAnc3RvcmVTZXQnICAgIEBvblN0b3JlU2V0XG4gICAgICAgIHBvc3Qub24gJ25ld1NldCcgICAgICBAb25OZXdTZXRcbiAgICAgICAgcG9zdC5vbiAna2FjaGVsRm9jdXMnIEBvbkthY2hlbEZvY3VzXG4gICAgICAgIHBvc3Qub24gJ25ld0thY2hlbCcgICBAb25OZXdLYWNoZWxcbiAgICAgICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwMCAgMDAwICAwMDAgICAgICAgMDAwIDAgMDAwICAgICAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMCAgICAgIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAgICAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAgICAgIDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgIFxuXG4gICAgb25OZXdLYWNoZWw6IChrYWNoZWxJZCkgPT5cblxuICAgICAgICByZXR1cm4gaWYga2FjaGVsSWQgPT0gJ21haW4nXG4gICAgICAgIFxuICAgICAgICBpZiBAd2lkc1trYWNoZWxJZF1cbiAgICAgICAgICAgIHdpbiA9IEB3aW4ga2FjaGVsSWRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYga2FjaGVsSWQgPT0gJ2RlZmF1bHQnXG4gICAgICAgICAgICAgICAgd2luLmNsb3NlKClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgd2luLnNob3dJbmFjdGl2ZSgpXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIGthY2hlbElkIG5vdCBpbiBAc2V0XG4gICAgICAgICAgICAgICAgQHNldC5wdXNoIGthY2hlbElkIFxuICAgICAgICAgICAgICAgIHByZWZzLnNldCBcImthY2hlbG4je0BzaWR9XCIgQHNldFxuICAgICAgICAgICAgICAgIHByZWZzLnNhdmUoKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgXG4gICAgICAgIGthY2hlbFNpemUgPSAyXG4gICAgXG4gICAgICAgIHR5cGUgPSBrYWNoZWxJZFxuICAgICAgICBpZiBrYWNoZWxJZC5zdGFydHNXaXRoICdzdGFydCdcbiAgICAgICAgICAgIHR5cGUgPSAnc3RhcnQnXG4gICAgICAgICAgICBrYWNoZWxTaXplID0gMlxuICAgICAgICBlbHNlIGlmIGthY2hlbElkLmVuZHNXaXRoKCcuYXBwJykgb3Iga2FjaGVsSWQuZW5kc1dpdGgoJy5leGUnKVxuICAgICAgICAgICAgaWYgc2xhc2guYmFzZShrYWNoZWxJZCkgPT0gJ2tvbnJhZCdcbiAgICAgICAgICAgICAgICB0eXBlID0gJ2tvbnJhZCdcbiAgICAgICAgICAgICAgICBrYWNoZWxTaXplID0gNFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHR5cGUgPSAnYXBwbCdcbiAgICAgICAgICAgICAgICBrYWNoZWxTaXplID0gMlxuICAgICAgICBlbHNlIGlmIGthY2hlbElkLnN0YXJ0c1dpdGgoJy8nKSBvciBrYWNoZWxJZFsxXSA9PSAnOidcbiAgICAgICAgICAgIHR5cGUgPSAnZm9sZGVyJ1xuICAgICAgICAgICAga2FjaGVsU2l6ZSA9IDJcbiAgICAgICAgICAgIFxuICAgICAgICBzd2l0Y2ggdHlwZVxuICAgICAgICAgICAgd2hlbiAnc2F2ZXInIHRoZW4ga2FjaGVsU2l6ZSA9IDBcbiAgICAgICAgICAgIHdoZW4gJ3N5c2Rpc2gnICdzeXNpbmZvJyAnY2xvY2snICdkZWZhdWx0JyB0aGVuIGthY2hlbFNpemUgPSAyXG4gICAgICAgICAgICBcbiAgICAgICAgd2luID0gbmV3IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3dcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbW92YWJsZTogICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICB0cmFuc3BhcmVudDogICAgICAgIHRydWVcbiAgICAgICAgICAgIGF1dG9IaWRlTWVudUJhcjogICAgdHJ1ZVxuICAgICAgICAgICAgYWNjZXB0Rmlyc3RNb3VzZTogICB0cnVlXG4gICAgICAgICAgICBoYXNTaGFkb3c6ICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICBmcmFtZTogICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICByZXNpemFibGU6ICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICBtYXhpbWl6YWJsZTogICAgICAgIGZhbHNlXG4gICAgICAgICAgICBtaW5pbWl6YWJsZTogICAgICAgIGZhbHNlXG4gICAgICAgICAgICBmdWxsc2NyZWVuOiAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICBzaG93OiAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICBmdWxsc2NyZWVuZW5hYmxlOiAgIGZhbHNlXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICAgICcjMTgxODE4J1xuICAgICAgICAgICAgd2lkdGg6ICAgICAgICAgICAgICBCb3VuZHMua2FjaGVsU2l6ZXNba2FjaGVsU2l6ZV1cbiAgICAgICAgICAgIGhlaWdodDogICAgICAgICAgICAgQm91bmRzLmthY2hlbFNpemVzW2thY2hlbFNpemVdXG4gICAgICAgICAgICB3ZWJQcmVmZXJlbmNlczogXG4gICAgICAgICAgICAgICAgbm9kZUludGVncmF0aW9uOiB0cnVlXG4gICAgICAgICAgICBcbiAgICAgICAgd2luLmxvYWRVUkwgS2FjaGVsU2V0Lmh0bWwodHlwZSksIGJhc2VVUkxGb3JEYXRhVVJMOlwiZmlsZTovLyN7X19kaXJuYW1lfS8uLi9qcy9pbmRleC5odG1sXCJcbiAgICAgICAgXG4gICAgICAgIHdpbi5rYWNoZWxJZCA9IGthY2hlbElkXG4gICAgICAgIFxuICAgICAgICB3aW4ud2ViQ29udGVudHMub24gJ2RvbS1yZWFkeScgKChpZCkgLT4gKGV2ZW50KSAtPlxuICAgICAgICAgICAgd2lkID0gZXZlbnQuc2VuZGVyLmlkXG4gICAgICAgICAgICBwb3N0LnRvV2luIHdpZCwgJ2luaXRLYWNoZWwnIGlkXG4gICAgICAgICAgICBlbGVjdHJvbi5Ccm93c2VyV2luZG93LmZyb21JZCh3aWQpLnNob3coKVxuICAgICAgICAgICAgQm91bmRzLnVwZGF0ZSgpXG4gICAgICAgICAgICApKGthY2hlbElkKVxuICAgICAgICAgICAgICBcbiAgICAgICAgd2luLm9uICdjbG9zZScgQG9uS2FjaGVsQ2xvc2VcbiAgICAgICAgd2luLnNldEhhc1NoYWRvdyBmYWxzZSAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgd2luXG4gICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgb25LYWNoZWxDbG9zZTogKGV2ZW50KSA9PlxuICAgICAgICAgICAgXG4gICAgICAgIGthY2hlbCA9IGV2ZW50LnNlbmRlclxuICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiBAaG92ZXJLYWNoZWwgPT0ga2FjaGVsLmlkXG4gICAgICAgICAgICBAaG92ZXJLYWNoZWwgPSBudWxsXG4gICAgICAgICAgICBcbiAgICAgICAgQm91bmRzLnJlbW92ZSBrYWNoZWxcbiAgICAgICAgQHJlbW92ZSBrYWNoZWwgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIHNldFRpbWVvdXQgKC0+IHBvc3QuZW1pdCAnYm91bmRzJyAnZGlydHknKSwgMjAwXG4gICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuICAgICMgMDAwICAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgIFxuICAgIG9uS2FjaGVsRm9jdXM6ICh3aW5JZCkgPT5cbiAgICBcbiAgICAgICAgIyBrbG9nICdvbiBmb2N1cycgQGRpY3Rbd2luSWRdXG4gICAgICAgIGlmIEBkaWN0W3dpbklkXSAhPSAnbWFpbidcbiAgICAgICAgICAgIEBmb2N1c0thY2hlbCA9IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3cuZnJvbUlkIHdpbklkXG5cbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgMCAwMDAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMCAgICAgMDAgIFxuICAgIFxuICAgIG9uTmV3U2V0OiA9PlxuICAgICAgICBcbiAgICAgICAgc2V0cyA9IHByZWZzLmdldCAnc2V0cycgWycnXVxuICAgICAgICBzZXRzLnB1c2ggXCIje3NldHMubGVuZ3RofVwiXG4gICAgICAgIHByZWZzLnNldCAnc2V0cycgc2V0c1xuICAgICAgICBAbG9hZCBzZXRzWy0xXVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMDAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgICAwMDAgICAgICAwMDAgICAgICAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgIDAwMDAwMDAgICBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgIFxuICAgICMgICAgMDAwICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgXG4gICAgb25Ub2dnbGVTZXQ6ID0+XG5cbiAgICAgICAgcmV0dXJuIGlmIEBzd2l0Y2hpbmdcbiAgICAgICAgXG4gICAgICAgIHNldHMgPSBwcmVmcy5nZXQgJ3NldHMnIFsnJ11cbiAgICAgICAgaW5kZXggPSBNYXRoLm1heCAwLCBzZXRzLmluZGV4T2YoQHNpZClcbiAgICAgICAgXG4gICAgICAgIGlmIGluZGV4ID49IHNldHMubGVuZ3RoLTEgdGhlbiBpbmRleCA9IC0xXG4gICAgICAgIEBsb2FkIHNldHNbaW5kZXgrMV1cbiAgICAgICAgXG4gICAgb25SZXN0b3JlU2V0OiA9PlxuXG4gICAgICAgIEBsb2FkIEBzaWQsICdfc2F2ZSdcblxuICAgIG9uU3RvcmVTZXQ6ID0+XG5cbiAgICAgICAgcHJlZnMuc2V0IFwia2FjaGVsbiN7QHNpZH1fc2F2ZVwiIEBzZXQgXG4gICAgICAgIHByZWZzLnNhdmUoKVxuICAgICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgIFxuICAgICMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgXG4gICAgXG4gICAgbG9hZDogKG5ld1NpZCwgcG9zdGZpeD0nJykgLT5cbiAgICAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBAc3dpdGNoaW5nXG4gICAgICAgICAgICBcbiAgICAgICAgQHN3aXRjaGluZyA9IHRydWVcbiAgICAgICAgXG4gICAgICAgIG5ld1NpZCA/PSBwcmVmcy5nZXQgJ3NldCcgJydcbiAgICAgICAgXG4gICAgICAgIGlmIGVtcHR5IHBvc3RmaXhcbiAgICAgICAgICAgIG9sZEthY2hlbG4gPSBwcmVmcy5nZXQgXCJrYWNoZWxuI3tAc2lkfVwiIFtdXG5cbiAgICAgICAgQGthY2hlbElkcyA9IFtdXG4gICAgICAgIHVwZGF0ZUlkcyA9IFsnbWFpbiddXG4gICAgICAgIHNob3dJZHMgPSBbXVxuICAgICAgICBuZXdTZXQgPSBwcmVmcy5nZXQgXCJrYWNoZWxuI3tuZXdTaWR9I3twb3N0Zml4fVwiIFtdXG5cbiAgICAgICAgZm9yIGthY2hlbElkIGluIG5ld1NldCA/IFtdXG4gICAgICAgICAgICBpZiBrYWNoZWxJZCAhPSAnbWFpbidcbiAgICAgICAgICAgICAgICBpZiBAc2V0LmluZGV4T2Yoa2FjaGVsSWQpID49IDBcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlSWRzLnB1c2gga2FjaGVsSWRcbiAgICAgICAgICAgICAgICAgICAgQHNldC5zcGxpY2UgQHNldC5pbmRleE9mKGthY2hlbElkKSwgMVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgc2hvd0lkcy5wdXNoIGthY2hlbElkXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBAd2lkc1trYWNoZWxJZF1cbiAgICAgICAgICAgICAgICAgICAgICAgIEBrYWNoZWxJZHMucHVzaCBrYWNoZWxJZFxuXG4gICAgICAgIGlmIEBzZXQubGVuZ3RoXG4gICAgICAgICAgICBmb3Iga2FjaGVsSWQgaW4gQHNldC5zbGljZSgpXG4gICAgICAgICAgICAgICAgaWYga2FjaGVsSWQgbm90IGluIFsnbWFpbicgJ251bGwnIG51bGxdXG4gICAgICAgICAgICAgICAgICAgIGlmIEB3aWRzW2thY2hlbElkXVxuICAgICAgICAgICAgICAgICAgICAgICAgQHdpbihrYWNoZWxJZCkuaGlkZSgpXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGtsb2cgJ25vIHdpZCBmb3InIGthY2hlbElkXG4gICAgICAgIFxuICAgICAgICBpZiBlbXB0eSBwb3N0Zml4XG4gICAgICAgICAgICBwcmVmcy5zZXQgXCJrYWNoZWxuI3tAc2lkfVwiIG9sZEthY2hlbG5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIEBzaWQgPSBuZXdTaWRcbiAgICAgICAgcHJlZnMuc2V0ICdzZXQnIEBzaWRcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIEBzZXQgPSBuZXdTZXRcbiAgICAgICAgXG4gICAgICAgIGlmIHZhbGlkIHBvc3RmaXhcbiAgICAgICAgICAgIHByZWZzLnNldCBcImthY2hlbG4je25ld1NpZH1cIiBAc2V0XG4gICAgICAgIFxuICAgICAgICBmb3Iga2FjaGVsSWQgaW4gdXBkYXRlSWRzXG4gICAgICAgICAgICBwb3N0LmVtaXQgJ3VwZGF0ZUJvdW5kcycga2FjaGVsSWRcblxuICAgICAgICBmb3Iga2FjaGVsSWQgaW4gc2hvd0lkc1xuICAgICAgICAgICAgQG9uTmV3S2FjaGVsIGthY2hlbElkXG4gICAgICAgICAgICBcbiAgICAgICAgaWYgQGthY2hlbElkcy5sZW5ndGggPT0gMFxuICAgICAgICAgICAgQGRpZExvYWQoKVxuICAgICAgICAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMCAgMDAwMDAwMCAgICAgICAgICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgICAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAgMDAwICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgIFxuICAgIFxuICAgIGRpZExvYWQ6ID0+XG4gICAgICAgIFxuICAgICAgICBAc3dpdGNoaW5nID0gZmFsc2VcbiAgICAgICAgQHdpbignbWFpbicpLmZvY3VzKClcbiAgICAgICAgQGZvY3VzS2FjaGVsID0gQHdpbignbWFpbicpXG4gICAgICAgIHBvc3QuZW1pdCAnc2V0TG9hZGVkJ1xuICAgICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgICAgICAgICAgICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAgICAgICAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgICAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICBcbiAgICBcbiAgICBvbkthY2hlbExvYWQ6ICh3aWQsIGthY2hlbElkKSA9PlxuICAgICAgICAgICAgXG4gICAgICAgICMga2xvZyAnb25Mb2FkJyBAc2lkLCBAc2V0Lmxlbmd0aCwga2FjaGVsSWRcbiAgICAgICAgXG4gICAgICAgIGlmIGthY2hlbElkIG5vdCBpbiBAc2V0XG4gICAgICAgICAgICBAc2V0LnB1c2gga2FjaGVsSWQgXG4gICAgICAgICAgICBwcmVmcy5zZXQgXCJrYWNoZWxuI3tAc2lkfVwiIEBzZXRcbiAgICAgICAgICAgIHByZWZzLnNhdmUoKVxuICAgICAgICBcbiAgICAgICAgQGRpY3Rbd2lkXSA9IGthY2hlbElkXG4gICAgICAgIEB3aWRzW2thY2hlbElkXSA9IHdpZFxuICAgICAgICBcbiAgICAgICAgaWYgQGthY2hlbElkc1xuICAgICAgICAgICAgaW5kZXggPSBAa2FjaGVsSWRzLmluZGV4T2Yga2FjaGVsSWRcbiAgICAgICAgICAgIGlmIGluZGV4ID49IDBcbiAgICAgICAgICAgICAgICBAa2FjaGVsSWRzLnNwbGljZSBpbmRleCwgMVxuICAgICAgICAgICAgICAgIGlmIEBrYWNoZWxJZHMubGVuZ3RoID09IDAgdGhlbiBAZGlkTG9hZCgpXG4gICAgICAgICAgICBlbHNlIGlmIGthY2hlbElkICE9ICdkZWZhdWx0J1xuICAgICAgICAgICAgICAgIGtsb2cgJ3Vua25vd24ga2FjaGVsPycga2FjaGVsSWRcblxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMCAgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAgMDAwICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwIDAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgICAgICAwICAgICAgMDAwMDAwMDAgIFxuICAgIFxuICAgIHJlbW92ZTogKGthY2hlbCkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBmb2N1c0thY2hlbCA9PSBrYWNoZWxcbiAgICAgICAgICAgIEBmb2N1c0thY2hlbCA9IG51bGxcbiAgICAgICAgXG4gICAgICAgIGlmIGthY2hlbElkID0gQGRpY3Rba2FjaGVsLmlkXVxuICAgICAgICAgICAgaWYgQHNldC5pbmRleE9mKGthY2hlbElkKSA+PSAwXG4gICAgICAgICAgICAgICAgQHNldC5zcGxpY2UgQHNldC5pbmRleE9mKGthY2hlbElkKSwgMVxuICAgICAgICAgICAgZGVsZXRlIEB3aWRzW2thY2hlbElkXVxuICAgICAgICAgICAgZGVsZXRlIEBkaWN0W2thY2hlbC5pZF1cbiAgICAgICAgICAgICMga2xvZyBcInByZWZzIHJlbW92ZSBmcm9tICN7QHNpZH1cIiBrYWNoZWxJZFxuICAgICAgICAgICAgcHJlZnMuc2V0IFwia2FjaGVsbiN7QHNpZH1cIiBAc2V0XG4gICAgICAgICAgICAgICAgXG4gICAgd2luOiAoa2FjaGVsSWQpIC0+XG4gICAgICAgICAgICBcbiAgICAgICAgZWxlY3Ryb24uQnJvd3NlcldpbmRvdy5mcm9tSWQgQHdpZHNba2FjaGVsSWRdXG4gICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwICAgICAwMCAgMDAwICAgICAgXG4gICAgIyAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAwIDAwMCAgMDAwICAgICAgXG4gICAgIyAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAwMDAwICBcbiAgICBcbiAgICBAaHRtbDogKHR5cGUpIC0+XG4gICAgICAgIFxuICAgICAgICBodG1sID0gXCJcIlwiXG4gICAgICAgICAgICA8IURPQ1RZUEUgaHRtbD5cbiAgICAgICAgICAgIDxodG1sIGxhbmc9XCJlblwiPlxuICAgICAgICAgICAgICA8aGVhZD5cbiAgICAgICAgICAgICAgICA8bWV0YSBjaGFyc2V0PVwidXRmLThcIj5cbiAgICAgICAgICAgICAgICA8bWV0YSBodHRwLWVxdWl2PVwiQ29udGVudC1TZWN1cml0eS1Qb2xpY3lcIiBjb250ZW50PVwiZGVmYXVsdC1zcmMgKiAndW5zYWZlLWlubGluZScgJ3Vuc2FmZS1ldmFsJ1wiPlxuICAgICAgICAgICAgICAgIDxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiLi9jc3Mvc3R5bGUuY3NzXCIgdHlwZT1cInRleHQvY3NzXCI+XG4gICAgICAgICAgICAgICAgPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCIuL2Nzcy9kYXJrLmNzc1wiIHR5cGU9XCJ0ZXh0L2Nzc1wiIGlkPVwic3R5bGUtbGlua1wiPlxuICAgICAgICAgICAgICA8L2hlYWQ+XG4gICAgICAgICAgICAgIDxib2R5PlxuICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJtYWluXCIgdGFiaW5kZXg9XCIwXCI+PC9kaXY+XG4gICAgICAgICAgICAgIDwvYm9keT5cbiAgICAgICAgICAgICAgPHNjcmlwdD5cbiAgICAgICAgICAgICAgICBLYWNoZWwgPSByZXF1aXJlKFwiLi8je3R5cGV9LmpzXCIpO1xuICAgICAgICAgICAgICAgIG5ldyBLYWNoZWwoe30pO1xuICAgICAgICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgICAgIDwvaHRtbD5cbiAgICAgICAgXCJcIlwiXG4gICAgICAgIFxuICAgICAgICBcImRhdGE6dGV4dC9odG1sO2NoYXJzZXQ9dXRmLTgsXCIgKyBlbmNvZGVVUkkgaHRtbFxuICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gS2FjaGVsU2V0XG4iXX0=
//# sourceURL=../coffee/kachelset.coffee