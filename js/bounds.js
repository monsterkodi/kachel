// koffee 1.3.0

/*
0000000     0000000   000   000  000   000  0000000     0000000
000   000  000   000  000   000  0000  000  000   000  000     
0000000    000   000  000   000  000 0 000  000   000  0000000 
000   000  000   000  000   000  000  0000  000   000       000
0000000     0000000    0000000   000   000  0000000    0000000
 */
var Bounds, clamp, electron, klog, kpos, os, post, ref, wxw;

ref = require('kxk'), post = ref.post, clamp = ref.clamp, klog = ref.klog, kpos = ref.kpos, os = ref.os;

if (os.platform() === 'win32') {
    wxw = require('wxw');
}

electron = require('electron');

Bounds = (function() {
    function Bounds() {}

    Bounds.infos = null;

    Bounds.screenWidth = 0;

    Bounds.screenHeight = 0;

    Bounds.screenTop = 0;

    Bounds.setBounds = function(kachel, b) {
        klog('setBounds', b);
        kachel.setBounds(b);
        post.toWin(kachel.id, 'saveBounds');
        return post.emit('bounds', kachel, b);
    };

    Bounds.init = function() {
        Bounds.updateScreenSize();
        return Bounds.getInfos();
    };

    Bounds.updateScreenSize = function() {
        var sp, ss, vs;
        if (os.platform() === 'win32') {
            ss = wxw('screen', 'user');
            sp = {
                x: ss.width,
                y: ss.height
            };
            vs = kpos(electron.screen.screenToDipPoint(sp)).rounded();
            this.screenWidth = vs.x;
            this.screenHeight = vs.y;
            return this.screenTop = 0;
        } else {
            this.screenWidth = electron.screen.getPrimaryDisplay().workAreaSize.width;
            this.screenHeight = electron.screen.getPrimaryDisplay().workAreaSize.height;
            return this.screenTop = electron.screen.getPrimaryDisplay().workArea.y;
        }
    };

    Bounds.getInfos = function(kacheln) {
        var infos, maxX, maxY, minX, minY;
        if (kacheln != null) {
            kacheln;
        } else {
            kacheln = electron.BrowserWindow.getAllWindows();
        }
        minX = minY = 9999;
        maxX = maxY = 0;
        infos = kacheln.map((function(_this) {
            return function(k) {
                var b;
                b = _this.validBounds(k);
                minX = Math.min(minX, b.x);
                minY = Math.min(minY, b.y);
                maxX = Math.max(maxX, b.x + b.width);
                maxY = Math.max(maxY, b.y + b.height);
                return {
                    kachel: k,
                    bounds: b
                };
            };
        })(this));
        infos.sort((function(_this) {
            return function(a, b) {
                return _this.borderDist(a.bounds) - _this.borderDist(b.bounds);
            };
        })(this));
        infos.kachelBounds = {
            x: minX,
            y: minY,
            width: maxX - minX,
            height: maxY - minY
        };
        this.infos = infos;
        return this.infos;
    };

    Bounds.validBounds = function(kachel) {
        return this.onScreen(kachel.getBounds());
    };

    Bounds.onScreen = function(b) {
        b.x = clamp(0, this.screenWidth - b.width, b.x);
        b.y = clamp(0, this.screenHeight - b.height, b.y);
        if (b.x + b.width > this.screenWidth - b.width) {
            b.x = this.screenWidth - b.width;
        }
        if (b.y + b.height > this.screenTop + this.screenHeight - b.height) {
            b.y = this.screenTop + this.screenHeight - b.height;
        }
        if (b.x < b.width) {
            b.x = 0;
        }
        if (b.y - this.screenTop < b.height) {
            b.y = this.screenTop;
        }
        return b;
    };

    Bounds.isOnScreen = function(b) {
        if (b.y < 0 || b.x < 0) {
            return false;
        }
        if (b.x + b.width > this.screenWidth) {
            return false;
        }
        if (b.y + b.height > this.screenTop + this.screenHeight) {
            return false;
        }
        return true;
    };

    Bounds.overlap = function(a, b) {
        if (!a || !b) {
            return false;
        }
        return !(a.x > b.x + b.width - 1 || b.x > a.x + a.width - 1 || a.y > b.y + b.height - 1 || b.y > a.y + a.height - 1);
    };

    Bounds.overlapInfo = function(b) {
        var i, info, len, ref1;
        ref1 = this.infos;
        for (i = 0, len = ref1.length; i < len; i++) {
            info = ref1[i];
            if (this.overlap(info.bounds, b)) {
                return info;
            }
        }
    };

    Bounds.borderDist = function(b) {
        var dx, dy;
        dx = b.x < this.screenWidth / 2 ? b.x : this.screenWidth - (b.x + b.width);
        dy = b.y < this.screenHeight / 2 ? b.y : this.screenHeight - (b.y + b.height);
        return Math.min(dx, dy);
    };

    Bounds.posInBounds = function(p, b) {
        return p.x >= b.x && p.x <= b.x + b.width && p.y >= b.y && p.y <= b.y + b.height;
    };

    Bounds.kachelAtPos = function(p) {
        var i, k, len, ref1;
        ref1 = this.infos;
        for (i = 0, len = ref1.length; i < len; i++) {
            k = ref1[i];
            if (this.posInBounds(p, k.bounds)) {
                return k;
            }
        }
    };

    Bounds.gapRight = function(a, b) {
        return b.x - (a.x + a.width);
    };

    Bounds.gapLeft = function(a, b) {
        return a.x - (b.x + b.width);
    };

    Bounds.gapUp = function(a, b) {
        return a.y - (b.y + b.height);
    };

    Bounds.gapDown = function(a, b) {
        return b.y - (a.y + a.height);
    };

    Bounds.isCloseNeighbor = function(bounds, info, dir) {
        var ref1, ref2, ref3, ref4;
        switch (dir) {
            case 'right':
                return (0 <= (ref1 = this.gapRight(bounds, info.bounds)) && ref1 < bounds.width);
            case 'left':
                return (0 <= (ref2 = this.gapLeft(bounds, info.bounds)) && ref2 < bounds.width);
            case 'down':
                return (0 <= (ref3 = this.gapDown(bounds, info.bounds)) && ref3 < bounds.height);
            case 'up':
                return (0 <= (ref4 = this.gapUp(bounds, info.bounds)) && ref4 < bounds.height);
        }
    };

    Bounds.closeNeighbor = function(kachel, dir) {
        var i, info, infos, kb, len;
        kb = kachel.getBounds();
        infos = Array.from(this.infos);
        infos.sort(function(a, b) {
            switch (dir) {
                case 'left':
                case 'right':
                    return Math.abs(a.bounds.y - kb.y) - Math.abs(b.bounds.y - kb.y);
                case 'up':
                case 'down':
                    return Math.abs(a.bounds.x - kb.x) - Math.abs(b.bounds.x - kb.x);
            }
        });
        for (i = 0, len = infos.length; i < len; i++) {
            info = infos[i];
            if (info.kachel === kachel) {
                continue;
            }
            if (this.isCloseNeighbor(kb, info, dir)) {
                return info;
            }
        }
    };

    Bounds.nextNeighbor = function(kachel, dir) {
        var kb, neighbor;
        if (neighbor = this.closeNeighbor(kachel, dir)) {
            kb = kachel.getBounds();
            switch (dir) {
                case 'left':
                case 'right':
                    if (neighbor.bounds.y === kb.y) {
                        return neighbor;
                    }
                    break;
                case 'up':
                case 'down':
                    if (neighbor.bounds.x === kb.x) {
                        return neighbor;
                    }
            }
        }
    };

    Bounds.snap = function(kachel, b) {
        var horz, i, info, len, n, ref1, vert;
        if (b != null) {
            b;
        } else {
            b = kachel.getBounds();
        }
        klog('snap', kachel.id, b);
        horz = false;
        vert = false;
        if (b.x < 0 || b.x < 72) {
            horz = true;
            b.x = 0;
        } else if (b.x + b.width > this.screenWidth || b.x + b.width > this.screenWidth - 72) {
            horz = true;
            b.x = this.screenWidth - b.width;
        }
        if (b.y < 0 || b.y < 72) {
            vert = true;
            b.y = 0;
        } else if (b.y + b.height > this.screenTop + this.screenHeight || b.y + b.height > this.screenTop + this.screenHeight - 72) {
            vert = true;
            b.y = this.screenTop + this.screenHeight - b.height;
        }
        this.getInfos();
        ref1 = this.infos;
        for (i = 0, len = ref1.length; i < len; i++) {
            info = ref1[i];
            if (info.kachel === kachel) {
                continue;
            }
            if (this.overlap(b, info.bounds)) {
                b.y = info.bounds.y + info.bounds.height;
            }
        }
        if (!vert) {
            if (n = this.closeNeighbor(kachel, 'up')) {
                b.y = n.bounds.y + n.bounds.height;
            } else if (n = this.closeNeighbor(kachel, 'down')) {
                b.y = n.bounds.y - b.height;
            }
        }
        if (!horz) {
            if (n = this.closeNeighbor(kachel, 'right')) {
                b.x = n.bounds.x - b.width;
            } else if (n = this.closeNeighbor(kachel, 'left')) {
                b.x = n.bounds.x + n.bounds.width;
            }
        }
        klog('snap', kachel.id, b);
        return b;
    };

    return Bounds;

})();

module.exports = Bounds;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm91bmRzLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUFrQyxPQUFBLENBQVEsS0FBUixDQUFsQyxFQUFFLGVBQUYsRUFBUSxpQkFBUixFQUFlLGVBQWYsRUFBcUIsZUFBckIsRUFBMkI7O0FBRTNCLElBQUcsRUFBRSxDQUFDLFFBQUgsQ0FBQSxDQUFBLEtBQWUsT0FBbEI7SUFBK0IsR0FBQSxHQUFNLE9BQUEsQ0FBUSxLQUFSLEVBQXJDOzs7QUFDQSxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBRUw7OztJQUVGLE1BQUMsQ0FBQSxLQUFELEdBQVE7O0lBRVIsTUFBQyxDQUFBLFdBQUQsR0FBZTs7SUFDZixNQUFDLENBQUEsWUFBRCxHQUFlOztJQUNmLE1BQUMsQ0FBQSxTQUFELEdBQWU7O0lBRWYsTUFBQyxDQUFBLFNBQUQsR0FBWSxTQUFDLE1BQUQsRUFBUyxDQUFUO1FBRVIsSUFBQSxDQUFLLFdBQUwsRUFBaUIsQ0FBakI7UUFDQSxNQUFNLENBQUMsU0FBUCxDQUFpQixDQUFqQjtRQUNBLElBQUksQ0FBQyxLQUFMLENBQVcsTUFBTSxDQUFDLEVBQWxCLEVBQXNCLFlBQXRCO2VBQ0EsSUFBSSxDQUFDLElBQUwsQ0FBVSxRQUFWLEVBQW1CLE1BQW5CLEVBQTJCLENBQTNCO0lBTFE7O0lBT1osTUFBQyxDQUFBLElBQUQsR0FBTyxTQUFBO1FBRUgsTUFBTSxDQUFDLGdCQUFQLENBQUE7ZUFDQSxNQUFNLENBQUMsUUFBUCxDQUFBO0lBSEc7O0lBS1AsTUFBQyxDQUFBLGdCQUFELEdBQW1CLFNBQUE7QUFFZixZQUFBO1FBQUEsSUFBRyxFQUFFLENBQUMsUUFBSCxDQUFBLENBQUEsS0FBaUIsT0FBcEI7WUFDSSxFQUFBLEdBQUssR0FBQSxDQUFJLFFBQUosRUFBYSxNQUFiO1lBQ0wsRUFBQSxHQUFLO2dCQUFBLENBQUEsRUFBRSxFQUFFLENBQUMs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NkNYLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAwMDAwICAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgIDAwMDAwMDBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIFxuMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgICAgICAwMDBcbjAwMDAwMDAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwIFxuIyMjXG5cbnsgcG9zdCwgY2xhbXAsIGtsb2csIGtwb3MsIG9zIH0gPSByZXF1aXJlICdreGsnXG5cbmlmIG9zLnBsYXRmb3JtKCk9PSd3aW4zMicgdGhlbiB3eHcgPSByZXF1aXJlICd3eHcnXG5lbGVjdHJvbiA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xuXG5jbGFzcyBCb3VuZHNcblxuICAgIEBpbmZvczogbnVsbFxuICAgIFxuICAgIEBzY3JlZW5XaWR0aDogIDBcbiAgICBAc2NyZWVuSGVpZ2h0OiAwXG4gICAgQHNjcmVlblRvcDogICAgMFxuICAgIFxuICAgIEBzZXRCb3VuZHM6IChrYWNoZWwsIGIpIC0+XG4gICAgICAgIFxuICAgICAgICBrbG9nICdzZXRCb3VuZHMnIGJcbiAgICAgICAga2FjaGVsLnNldEJvdW5kcyBiXG4gICAgICAgIHBvc3QudG9XaW4ga2FjaGVsLmlkLCAnc2F2ZUJvdW5kcydcbiAgICAgICAgcG9zdC5lbWl0ICdib3VuZHMnIGthY2hlbCwgYlxuXG4gICAgQGluaXQ6IC0+XG4gICAgICAgIFxuICAgICAgICBCb3VuZHMudXBkYXRlU2NyZWVuU2l6ZSgpXG4gICAgICAgIEJvdW5kcy5nZXRJbmZvcygpXG4gICAgICAgIFxuICAgIEB1cGRhdGVTY3JlZW5TaXplOiAtPlxuICAgICAgICBcbiAgICAgICAgaWYgb3MucGxhdGZvcm0oKSA9PSAnd2luMzInICAgICAgICAgICAgXG4gICAgICAgICAgICBzcyA9IHd4dyAnc2NyZWVuJyAndXNlcidcbiAgICAgICAgICAgIHNwID0geDpzcy53aWR0aCwgeTpzcy5oZWlnaHRcbiAgICAgICAgICAgIHZzID0ga3BvcyhlbGVjdHJvbi5zY3JlZW4uc2NyZWVuVG9EaXBQb2ludCBzcCkucm91bmRlZCgpIFxuICAgICAgICAgICAgQHNjcmVlbldpZHRoICA9IHZzLnhcbiAgICAgICAgICAgIEBzY3JlZW5IZWlnaHQgPSB2cy55XG4gICAgICAgICAgICBAc2NyZWVuVG9wICAgID0gMFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAc2NyZWVuV2lkdGggID0gZWxlY3Ryb24uc2NyZWVuLmdldFByaW1hcnlEaXNwbGF5KCkud29ya0FyZWFTaXplLndpZHRoXG4gICAgICAgICAgICBAc2NyZWVuSGVpZ2h0ID0gZWxlY3Ryb24uc2NyZWVuLmdldFByaW1hcnlEaXNwbGF5KCkud29ya0FyZWFTaXplLmhlaWdodFxuICAgICAgICAgICAgQHNjcmVlblRvcCAgICA9IGVsZWN0cm9uLnNjcmVlbi5nZXRQcmltYXJ5RGlzcGxheSgpLndvcmtBcmVhLnlcbiAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgIFxuICAgIEBnZXRJbmZvczogKGthY2hlbG4pIC0+XG4gICAgICAgIFxuICAgICAgICBrYWNoZWxuID89IGVsZWN0cm9uLkJyb3dzZXJXaW5kb3cuZ2V0QWxsV2luZG93cygpXG4gICAgICAgIFxuICAgICAgICBtaW5YID0gbWluWSA9IDk5OTlcbiAgICAgICAgbWF4WCA9IG1heFkgPSAwXG4gICAgICAgIFxuICAgICAgICBpbmZvcyA9IGthY2hlbG4ubWFwIChrKSA9PlxuICAgICAgICAgICAgXG4gICAgICAgICAgICBiID0gQHZhbGlkQm91bmRzIGtcbiAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbiBtaW5YLCBiLnhcbiAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbiBtaW5ZLCBiLnlcbiAgICAgICAgICAgIG1heFggPSBNYXRoLm1heCBtYXhYLCBiLngrYi53aWR0aFxuICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4IG1heFksIGIueStiLmhlaWdodFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBrYWNoZWw6IGtcbiAgICAgICAgICAgIGJvdW5kczogYlxuICAgICAgICAgICAgXG4gICAgICAgIGluZm9zLnNvcnQgKGEsYikgPT4gQGJvcmRlckRpc3QoYS5ib3VuZHMpIC0gQGJvcmRlckRpc3QoYi5ib3VuZHMpXG5cbiAgICAgICAgaW5mb3Mua2FjaGVsQm91bmRzID0gXG4gICAgICAgICAgICB4OiAgICAgIG1pblhcbiAgICAgICAgICAgIHk6ICAgICAgbWluWVxuICAgICAgICAgICAgd2lkdGg6ICBtYXhYLW1pblhcbiAgICAgICAgICAgIGhlaWdodDogbWF4WS1taW5ZXG4gICAgICAgICAgICBcbiAgICAgICAgQGluZm9zID0gaW5mb3NcbiAgICAgICAgQGluZm9zXG4gICAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwMCAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAwIDAwMCAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgIDAwMDAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICBcbiAgICBcbiAgICBAdmFsaWRCb3VuZHM6IChrYWNoZWwpIC0+IEBvblNjcmVlbiBrYWNoZWwuZ2V0Qm91bmRzKClcbiAgICAgICAgXG4gICAgQG9uU2NyZWVuOiAoYikgLT5cbiAgICAgICAgXG4gICAgICAgIGIueCA9IGNsYW1wIDAsIEBzY3JlZW5XaWR0aCAgLSBiLndpZHRoLCAgYi54XG4gICAgICAgIGIueSA9IGNsYW1wIDAsIEBzY3JlZW5IZWlnaHQgLSBiLmhlaWdodCwgYi55XG4gICAgICAgIFxuICAgICAgICBpZiBiLnggKyBiLndpZHRoICA+IEBzY3JlZW5XaWR0aCAtIGIud2lkdGggIHRoZW4gYi54ID0gQHNjcmVlbldpZHRoLWIud2lkdGhcbiAgICAgICAgaWYgYi55ICsgYi5oZWlnaHQgPiBAc2NyZWVuVG9wK0BzY3JlZW5IZWlnaHQgLSBiLmhlaWdodCB0aGVuIGIueSA9IEBzY3JlZW5Ub3ArQHNjcmVlbkhlaWdodC1iLmhlaWdodFxuICAgICAgICBpZiBiLnggPCBiLndpZHRoICB0aGVuIGIueCA9IDBcbiAgICAgICAgaWYgYi55IC0gQHNjcmVlblRvcCA8IGIuaGVpZ2h0IHRoZW4gYi55ID0gQHNjcmVlblRvcFxuICAgICAgICBiXG4gICAgICAgIFxuICAgIEBpc09uU2NyZWVuOiAoYikgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIGIueSA8IDAgb3IgYi54IDwgMCB0aGVuIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiBiLnggKyBiLndpZHRoICA+IEBzY3JlZW5XaWR0aCB0aGVuIHJldHVybiBmYWxzZVxuICAgICAgICBpZiBiLnkgKyBiLmhlaWdodCA+IEBzY3JlZW5Ub3ArQHNjcmVlbkhlaWdodCB0aGVuIHJldHVybiBmYWxzZVxuICAgICAgICB0cnVlXG4gICAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgICAwMDAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICBcbiAgICAjICAwMDAwMDAwICAgICAgIDAgICAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4gICAgXG4gICAgQG92ZXJsYXA6IChhLGIpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBub3QgYSBvciBub3QgYlxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIG5vdCAoYS54ID4gYi54K2Iud2lkdGgtMSAgb3JcbiAgICAgICAgICAgICBiLnggPiBhLngrYS53aWR0aC0xICBvclxuICAgICAgICAgICAgIGEueSA+IGIueStiLmhlaWdodC0xIG9yXG4gICAgICAgICAgICAgYi55ID4gYS55K2EuaGVpZ2h0LTEpXG4gICAgICAgICAgICAgXG4gICAgQG92ZXJsYXBJbmZvOiAoYikgLT5cbiAgICAgICAgXG4gICAgICAgIGZvciBpbmZvIGluIEBpbmZvc1xuICAgICAgICAgICAgaWYgQG92ZXJsYXAgaW5mby5ib3VuZHMsIGJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5mb1xuICAgICAgICAgICAgIFxuICAgIEBib3JkZXJEaXN0OiAoYikgLT5cbiAgICAgICAgXG4gICAgICAgIGR4ID0gaWYgYi54IDwgQHNjcmVlbldpZHRoLzIgdGhlbiBiLnggZWxzZSBAc2NyZWVuV2lkdGggLSAoYi54ICsgYi53aWR0aClcbiAgICAgICAgZHkgPSBpZiBiLnkgPCBAc2NyZWVuSGVpZ2h0LzIgdGhlbiBiLnkgZWxzZSBAc2NyZWVuSGVpZ2h0IC0gKGIueSArIGIuaGVpZ2h0KVxuICAgICAgICBNYXRoLm1pbiBkeCwgZHlcbiAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgMCAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDAgICAgICAgMDAwICBcbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgXG4gICAgXG4gICAgQHBvc0luQm91bmRzOiAocCwgYikgLT5cbiAgICAgICAgXG4gICAgICAgIHAueCA+PSBiLnggYW5kIHAueCA8PSBiLngrYi53aWR0aCBhbmQgcC55ID49IGIueSBhbmQgcC55IDw9IGIueStiLmhlaWdodFxuICAgICAgICBcbiAgICBAa2FjaGVsQXRQb3M6IChwKSAtPlxuICAgICAgICBcbiAgICAgICAgZm9yIGsgaW4gQGluZm9zXG4gICAgICAgICAgICByZXR1cm4gayBpZiBAcG9zSW5Cb3VuZHMgcCwgay5ib3VuZHNcbiAgICAgICAgICAgIFxuICAgIEBnYXBSaWdodDogKGEsIGIpIC0+IGIueCAtIChhLnggKyBhLndpZHRoKVxuICAgIEBnYXBMZWZ0OiAgKGEsIGIpIC0+IGEueCAtIChiLnggKyBiLndpZHRoKVxuICAgIEBnYXBVcDogICAgKGEsIGIpIC0+IGEueSAtIChiLnkgKyBiLmhlaWdodClcbiAgICBAZ2FwRG93bjogIChhLCBiKSAtPiBiLnkgLSAoYS55ICsgYS5oZWlnaHQpXG4gICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4gICAgIyAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgICAwMDAwMDAwICAgMDAwICAgMDAwICBcbiAgICBcbiAgICBAaXNDbG9zZU5laWdoYm9yOiAoYm91bmRzLCBpbmZvLCBkaXIpIC0+XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggZGlyXG4gICAgICAgICAgICB3aGVuICdyaWdodCcgdGhlbiByZXR1cm4gMCA8PSBAZ2FwUmlnaHQoYm91bmRzLCBpbmZvLmJvdW5kcykgPCBib3VuZHMud2lkdGhcbiAgICAgICAgICAgIHdoZW4gJ2xlZnQnICB0aGVuIHJldHVybiAwIDw9IEBnYXBMZWZ0KCBib3VuZHMsIGluZm8uYm91bmRzKSA8IGJvdW5kcy53aWR0aFxuICAgICAgICAgICAgd2hlbiAnZG93bicgIHRoZW4gcmV0dXJuIDAgPD0gQGdhcERvd24oIGJvdW5kcywgaW5mby5ib3VuZHMpIDwgYm91bmRzLmhlaWdodFxuICAgICAgICAgICAgd2hlbiAndXAnICAgIHRoZW4gcmV0dXJuIDAgPD0gQGdhcFVwKCAgIGJvdW5kcywgaW5mby5ib3VuZHMpIDwgYm91bmRzLmhlaWdodFxuICAgICAgICBcbiAgICBAY2xvc2VOZWlnaGJvcjogKGthY2hlbCwgZGlyKSAtPlxuICAgICAgICBcbiAgICAgICAga2IgPSBrYWNoZWwuZ2V0Qm91bmRzKClcbiAgICAgICAgXG4gICAgICAgIGluZm9zID0gQXJyYXkuZnJvbSBAaW5mb3MgIyB0byBwcmV2ZW50IGNoYW5nZSBkZXRlY3Rpb24gZnJvbSBmYWlsaW5nXG4gICAgICAgIFxuICAgICAgICBpbmZvcy5zb3J0IChhLGIpIC0+IFxuICAgICAgICAgICAgc3dpdGNoIGRpclxuICAgICAgICAgICAgICAgIHdoZW4gJ2xlZnQnJ3JpZ2h0JyB0aGVuIE1hdGguYWJzKGEuYm91bmRzLnkgLSBrYi55KSAtIE1hdGguYWJzKGIuYm91bmRzLnkgLSBrYi55KVxuICAgICAgICAgICAgICAgIHdoZW4gJ3VwJydkb3duJyAgICB0aGVuIE1hdGguYWJzKGEuYm91bmRzLnggLSBrYi54KSAtIE1hdGguYWJzKGIuYm91bmRzLnggLSBrYi54KVxuICAgICAgICBcbiAgICAgICAgZm9yIGluZm8gaW4gaW5mb3NcbiAgICAgICAgICAgIGNvbnRpbnVlIGlmIGluZm8ua2FjaGVsID09IGthY2hlbFxuICAgICAgICAgICAgaWYgQGlzQ2xvc2VOZWlnaGJvciBrYiwgaW5mbywgZGlyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZm8gXG5cbiAgICBAbmV4dE5laWdoYm9yOiAoa2FjaGVsLCBkaXIpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBuZWlnaGJvciA9IEBjbG9zZU5laWdoYm9yIGthY2hlbCwgZGlyXG4gICAgICAgICAgICBrYiA9IGthY2hlbC5nZXRCb3VuZHMoKVxuICAgICAgICAgICAgc3dpdGNoIGRpclxuICAgICAgICAgICAgICAgIHdoZW4gJ2xlZnQnJ3JpZ2h0JyB0aGVuIHJldHVybiBuZWlnaGJvciBpZiBuZWlnaGJvci5ib3VuZHMueSA9PSBrYi55ICAgIFxuICAgICAgICAgICAgICAgIHdoZW4gJ3VwJydkb3duJyAgICB0aGVuIHJldHVybiBuZWlnaGJvciBpZiBuZWlnaGJvci5ib3VuZHMueCA9PSBrYi54ICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMCAwIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIFxuICAgICMgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIFxuICAgICMgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIFxuICAgIFxuICAgIEBzbmFwOiAoa2FjaGVsLCBiKSAtPlxuICAgICAgICAgICBcbiAgICAgICAgYiA/PSBrYWNoZWwuZ2V0Qm91bmRzKClcbiAgICAgICAgXG4gICAgICAgIGtsb2cgJ3NuYXAnIGthY2hlbC5pZCwgYlxuICAgICAgICBcbiAgICAgICAgaG9yeiA9IGZhbHNlXG4gICAgICAgIHZlcnQgPSBmYWxzZVxuICAgICAgICBcbiAgICAgICAgaWYgYi54IDwgMCBvciBiLnggPCA3MlxuICAgICAgICAgICAgaG9yeiA9IHRydWVcbiAgICAgICAgICAgIGIueCA9IDBcbiAgICAgICAgZWxzZSBpZiBiLnggKyBiLndpZHRoID4gQHNjcmVlbldpZHRoIG9yIGIueCArIGIud2lkdGggPiBAc2NyZWVuV2lkdGggLSA3MlxuICAgICAgICAgICAgaG9yeiA9IHRydWVcbiAgICAgICAgICAgIGIueCA9IEBzY3JlZW5XaWR0aCAtIGIud2lkdGhcblxuICAgICAgICBpZiBiLnkgPCAwIG9yIGIueSA8IDcyXG4gICAgICAgICAgICB2ZXJ0ID0gdHJ1ZVxuICAgICAgICAgICAgYi55ID0gMFxuICAgICAgICBlbHNlIGlmIGIueSArIGIuaGVpZ2h0ID4gQHNjcmVlblRvcCtAc2NyZWVuSGVpZ2h0IG9yIGIueSArIGIuaGVpZ2h0ID4gQHNjcmVlblRvcCtAc2NyZWVuSGVpZ2h0IC0gNzJcbiAgICAgICAgICAgIHZlcnQgPSB0cnVlXG4gICAgICAgICAgICBiLnkgPSBAc2NyZWVuVG9wK0BzY3JlZW5IZWlnaHQgLSBiLmhlaWdodFxuICAgICAgICBcbiAgICAgICAgQGdldEluZm9zKClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIGZvciBpbmZvIGluIEBpbmZvc1xuICAgICAgICAgICAgY29udGludWUgaWYgaW5mby5rYWNoZWwgPT0ga2FjaGVsXG4gICAgICAgICAgICBpZiBAb3ZlcmxhcCBiLCBpbmZvLmJvdW5kc1xuICAgICAgICAgICAgICAgIGIueSA9IGluZm8uYm91bmRzLnkgKyBpbmZvLmJvdW5kcy5oZWlnaHRcbiAgICAgICAgXG4gICAgICAgIGlmIG5vdCB2ZXJ0XG4gICAgICAgICAgICBpZiBuID0gQGNsb3NlTmVpZ2hib3Iga2FjaGVsLCAndXAnXG4gICAgICAgICAgICAgICAgYi55ID0gbi5ib3VuZHMueSArIG4uYm91bmRzLmhlaWdodFxuICAgICAgICAgICAgZWxzZSBpZiBuID0gQGNsb3NlTmVpZ2hib3Iga2FjaGVsLCAnZG93bidcbiAgICAgICAgICAgICAgICBiLnkgPSBuLmJvdW5kcy55IC0gYi5oZWlnaHRcblxuICAgICAgICBpZiBub3QgaG9yelxuICAgICAgICAgICAgaWYgbiA9IEBjbG9zZU5laWdoYm9yIGthY2hlbCwgJ3JpZ2h0J1xuICAgICAgICAgICAgICAgIGIueCA9IG4uYm91bmRzLnggLSBiLndpZHRoXG4gICAgICAgICAgICBlbHNlIGlmIG4gPSBAY2xvc2VOZWlnaGJvciBrYWNoZWwsICdsZWZ0J1xuICAgICAgICAgICAgICAgIGIueCA9IG4uYm91bmRzLnggKyBuLmJvdW5kcy53aWR0aFxuICAgICAgICAgICAgICAgIFxuICAgICAgICBrbG9nICdzbmFwJyBrYWNoZWwuaWQsIGJcbiAgICAgICAgYlxuICAgICAgICAgICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBCb3VuZHNcbiJdfQ==
//# sourceURL=../coffee/bounds.coffee